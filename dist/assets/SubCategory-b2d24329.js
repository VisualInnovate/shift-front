import{_ as A,p as O,l as T,u as E,r as u,c as $,q as M,x as R,d as q,e as n,h as i,g as s,t as f,j as m,i as y,w as B,n as b,f as L,y as G,F as H,m as J,b as K}from"./index-4d1925b8.js";import{p as Q,S as U,A as W,c as X,P as Y}from"./ProductOffers-5aaaaca4.js";import{N as Z}from"./navigation-a7938374.js";import{C as ee}from"./CustomTaps-871c65b9.js";import{d as C}from"./banner-addtion-e4104052.js";const ae={class:"mx-auto bg-gradient-to mt-16 max-w-7xl"},te={key:0,class:"flex flex-col items-center justify-center py-16 rounded-xl animate-pulse"},se={key:1,class:"text-center py-16 text-red-600"},ne={class:"text-lg font-semibold"},oe={key:2},le={class:"text-center mb-2"},re={class:"text-4xl sm:text-4xl font-extrabold text-gray-800 tracking-tight animate-fade-in"},ie={key:0},de=["src","alt"],ue={class:"font-sans mt-4 mb-1 text-gray-800 font-semibold text-sm sm:text-base md:text-lg"},ce={class:"relative overflow-hidden rounded-2xl shadow-lg animate-banner-slide"},me=["src","alt"],_e={class:"relative overflow-hidden rounded-2xl shadow-lg animate-banner-slide"},ge=["src","alt"],pe={__name:"SubCategory",setup(ve){const x=O(),I=T(),{t:_,locale:g}=E(),p=u(localStorage.getItem("defaultStoreId")),o=u({}),v=u([]),h=u({title:"",products:[]}),w=u(!1),d=u(null),k=$(()=>{var a;return((a=o.value.media)==null?void 0:a.find(t=>t.name==="banner_one_image"))||null}),P=$(()=>{var a;return((a=o.value.media)==null?void 0:a.find(t=>t.name==="banner_two_image"))||null}),c=a=>g.value==="ar"?a.name_ar||a.name_en:a.name_en||a.name_ar,j=a=>g.value==="ar"?"منتجات "+(a.name_ar||a.name_en):"Products "+(a.name_en||a.name_ar),D=a=>a.has_subcategories?{name:"subcategory",params:{id:a.id}}:{name:"produts_category",params:{id:a.id}},N=a=>{if(a.media_links.type===1){const t=a.media_links.id;I.push({name:"media-products",params:{id:t}})}else I.push({name:"media-category",params:{id:o.value.id}})},F=async()=>{var a;try{const l=(await K.get(`/api/home/products-by-category/${x.params.id}/${p.value}`)).data.data;o.value={id:l.category.id,name_ar:l.category.name_ar,name_en:l.category.name_en,media:(a=l.category.media)!=null&&a.length?l.category.media:[{url:C,name:"default"}]},v.value=l.sub_categories.map(e=>{var r;return{id:e.id,has_subcategories:e.has_subcategories,name_ar:e.name_ar||e.name_en,name_en:e.name_en||e.name_ar,media:(r=e.media)!=null&&r.length?e.media:[{url:C,name:"default"}]}}),h.value={title:j(o.value),products:(l.products.data||[]).map(e=>{var r,V;return{id:e.id,sub_name:g.value==="ar"?e.sub_name_ar||e.sub_name_en||"":e.sub_name_en||e.sub_name_ar||"",name:g.value==="ar"?e.name_ar||e.name_en:e.name_en||e.name_ar,tax:e.tax||0,total_discounts_value:e.total_discounts_value,is_free_shipping:e.is_free_shipping,total_rating:e.total_rating,price:parseFloat(e.base_price||0).toFixed(2),img:((V=(r=e.media)==null?void 0:r.find(z=>z.name==="product_main_image"))==null?void 0:V.url)||e.key_default_image||C}})}}catch(t){console.error("Error fetching category data:",t),d.value=_("category.errorLoading")||"Failed to load category data."}},S=async()=>{w.value=!0,d.value=null,await F(),w.value=!1};return M(()=>{x.params.id&&p.value?S():d.value=_("category.missingParams")||"Missing category or store ID."}),R(()=>x.params.id,a=>{a&&p.value?S():(!a||!p.value)&&(d.value=_("category.missingParams")||"Missing category or store ID.")}),(a,t)=>{const l=q("router-link");return n(),i("div",ae,[w.value?(n(),i("div",te,t[2]||(t[2]=[s("img",{src:G,alt:"Loading Logo",class:"w-32 h-32 object-contain animate-bounce","aria-label":"Loading animation"},null,-1)]))):d.value?(n(),i("div",se,[s("p",ne,f(d.value),1),s("button",{onClick:S,class:"mt-4 bg-indigo-600 text-white px-4 py-2 rounded"},f(m(_)("category.retry")),1)])):(n(),i("div",oe,[s("div",le,[s("h1",re,f(c(o.value)),1)]),v.value.length>=1?(n(),i("div",ie,[t[4]||(t[4]=s("h2",{class:"font-bold font-sans text-gray-800 text-2xl sm:text-3xl lg:text-4xl mb-4 animate-slide-up"},null,-1)),y(m(X),{modules:[m(W),m(Z)],"slides-per-view":3,"space-between":20,loop:v.value.length>3,autoplay:{delay:3e3,disableOnInteraction:!1},speed:1e3,"grab-cursor":!0,navigation:!1,class:"mt-6",breakpoints:{320:{slidesPerView:2,spaceBetween:4},640:{slidesPerView:2,spaceBetween:12},768:{slidesPerView:2,spaceBetween:16},1024:{slidesPerView:5.5,spaceBetween:10}}},{default:B(()=>[(n(!0),i(H,null,J(v.value,e=>(n(),L(m(U),{key:e.id,class:"group flex flex-col items-center cursor-pointer transition-all duration-300 hover:-translate-y-2"},{default:B(()=>[y(l,{to:D(e),class:"w-full overflow-hidden rounded-xl shadow-md relative"},{default:B(()=>{var r;return[s("img",{src:(r=e.media[0])==null?void 0:r.url,alt:`${c(e)} image`,class:"w-full h-full object-contain transition-transform duration-500 group-hover:scale-110",loading:"lazy"},null,8,de),t[3]||(t[3]=s("div",{class:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-10 transition-all duration-300"},null,-1))]}),_:2,__:[3]},1032,["to"]),s("h3",ue,f(c(e)),1)]),_:2},1024))),128))]),_:1},8,["modules","loop"])])):b("",!0),k.value?(n(),i("div",{key:1,class:"mb-3 md:my-8 cursor-pointer",onClick:t[0]||(t[0]=e=>N(k.value))},[s("div",ce,[s("img",{src:k.value.url,alt:`${c(o.value)} banner one`,class:"w-full sm:h-70 md:h-76 object-contain transition-transform duration-700 hover:scale-105",loading:"lazy"},null,8,me),t[5]||(t[5]=s("div",{class:"absolute inset-0 bg-gradient-to-t from-black/50 to-transparent flex items-end justify-center p-6"},null,-1))])])):b("",!0),s("section",null,[h.value.products.length?(n(),L(Q,{key:0,products:h.value,title:j(o.value)},null,8,["products","title"])):b("",!0),y(Y)]),P.value?(n(),i("div",{key:2,class:"my-8 cursor-pointer",onClick:t[1]||(t[1]=e=>N(P.value))},[s("div",_e,[s("img",{src:P.value.url,alt:`${c(o.value)} banner two`,class:"w-full sm:h-70 md:h-76 object-contain transition-transform duration-700 hover:scale-105",loading:"lazy"},null,8,ge),t[6]||(t[6]=s("div",{class:"absolute inset-0 bg-gradient-to-b from-transparent to-black/50 flex items-center justify-center p-6"},null,-1))])])):b("",!0)])),y(ee)])}}},we=A(pe,[["__scopeId","data-v-ed7e1bad"]]);export{we as default};
