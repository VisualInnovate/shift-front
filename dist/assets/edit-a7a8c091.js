import{_ as X,p as Y,l as Z,a as ee,u as ae,r as n,c as w,x as te,a1 as se,B as le,e as S,h as L,g as o,t as p,j as r,v as b,i as m,A as y,G as oe,V as C,U as j,W as q,k as re,b as g}from"./index-2602fe15.js";const ne=["dir"],de={key:0,class:"flex justify-center items-center h-64"},ue={key:1},ie={class:"text-3xl font-bold text-center mb-8 text-gray-800"},ce={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},me={class:"space-y-2"},ve={for:"belongs_to",class:"block text-sm font-medium text-gray-700"},pe={class:"space-y-2"},_e={for:"model_id",class:"block text-sm font-medium text-gray-700"},be={class:"space-y-2"},ye={for:"row_type",class:"block text-sm font-medium text-gray-700"},ge={class:"space-y-2"},fe={for:"name_en",class:"block text-sm font-medium text-gray-700"},xe={class:"space-y-2"},he={for:"name_ar",class:"block text-sm font-medium text-gray-700"},we={class:"pt-4 flex justify-center space-x-4"},ke={__name:"edit",setup(Ve){const E=Y(),D=Z(),v=ee(),{t}=ae(),a=n({id:null,belongs_to:null,model_id:null,name_en:"",name_ar:"",row_type:null}),I=n([{label:"Store",value:"store"},{label:"Category",value:"category"},{label:"Market",value:"market"}]),N=n([{label:"Single Row",value:1},{label:"Double Rows",value:2}]),f=n([]),x=n([]),h=n([]),k=n(""),V=n(""),T=n(""),u=n(null),B=w(()=>localStorage.getItem("appLang")||"en"),O=w(()=>B.value==="en"?"name_en":"name_ar"),Q=w(()=>B.value==="ar"),c=n(!1),_=n(!0),F=(s,e)=>{let i;return function(...l){clearTimeout(i),i=setTimeout(()=>s.apply(this,l),e)}},M=async()=>{try{const s=await g.get("/api/store",{params:{search:k.value||void 0}});f.value=s.data.data.data||s.data.data||[],u.value&&a.value.belongs_to==="store"&&!f.value.some(e=>e.id===u.value.id)&&f.value.push(u.value)}catch{v.add({severity:"error",summary:t("error"),detail:t("error.storeLoad"),life:3e3})}},U=async()=>{try{const s=await g.get("/api/category",{params:{search:V.value||void 0}});x.value=s.data.data.data||s.data.data||[],u.value&&a.value.belongs_to==="category"&&!x.value.some(e=>e.id===u.value.id)&&x.value.push(u.value)}catch{v.add({severity:"error",summary:t("error"),detail:t("error.categoryLoad"),life:3e3})}},$=async()=>{try{const s=await g.get("/api/market",{params:{search:T.value||void 0}});h.value=s.data.data.data||s.data.data||[],u.value&&a.value.belongs_to==="market"&&!h.value.some(e=>e.id===u.value.id)&&h.value.push(u.value)}catch{v.add({severity:"error",summary:t("error"),detail:t("error.marketLoad"),life:3e3})}},A=F(M,300),P=F(U,300),z=F($,300),G=s=>{const e=s.value;a.value.belongs_to==="store"?(k.value=e,A()):a.value.belongs_to==="category"?(V.value=e,P()):a.value.belongs_to==="market"&&(T.value=e,z())},W=async s=>{var e,i,l;try{const d=(await g.get(`/api/custom-tabs/${s}`)).data.data;a.value={id:d.id,belongs_to:d.belongs_to,model_id:((e=d.model)==null?void 0:e.id)||null,name_en:d.name_en||"",name_ar:d.name_ar||"",row_type:d.row_type},d.model&&d.belongs_to&&(u.value={id:d.model.id,name_en:d.model.name_en,name_ar:d.model.name_ar}),await Promise.all([M(),U(),$()])}catch(R){v.add({severity:"error",summary:t("error"),detail:((l=(i=R.response)==null?void 0:i.data)==null?void 0:l.message)||t("error.fetchCustomTab"),life:3e3}),D.push({name:"custom-tabs"})}finally{_.value=!1}},H=()=>{a.value.model_id=null,k.value="",V.value="",T.value=""},J=w(()=>{switch(a.value.belongs_to){case"store":return f.value;case"category":return x.value;case"market":return h.value;default:return[]}}),K=async()=>{var e,i;if(["belongs_to","model_id","name_en","name_ar","row_type"].some(l=>!a.value[l]&&a.value[l]!==0)){v.add({severity:"error",summary:t("error"),detail:t("validation.requiredFields"),life:3e3});return}c.value=!0;try{await g.put(`/api/custom-tabs/${a.value.id}`,a.value),v.add({severity:"success",summary:t("success"),detail:t("customTabs.updateSuccess"),life:3e3})}catch(l){v.add({severity:"error",summary:t("error"),detail:((i=(e=l.response)==null?void 0:e.data)==null?void 0:i.message)||t("error.updateError"),life:3e3})}finally{c.value=!1}};return te(()=>E.params.id,s=>{s&&(_.value=!0,W(s))},{immediate:!0}),(s,e)=>{const i=se("can");return le((S(),L("div",{class:"max-w-5xl mx-auto p-6 bg-white rounded-xl shadow-lg",dir:Q.value?"rtl":"ltr"},[_.value?(S(),L("div",de,e[6]||(e[6]=[o("i",{class:"pi pi-spin pi-spinner text-4xl text-gray-500"},null,-1)]))):(S(),L("div",ue,[o("h1",ie,p(r(t)("customTabs.updateTitle")),1),o("form",{onSubmit:oe(K,["prevent"]),class:"space-y-6"},[o("div",ce,[o("div",me,[o("label",ve,[b(p(r(t)("customTabs.belongsTo"))+" ",1),e[7]||(e[7]=o("span",{class:"text-red-500"},"*",-1))]),m(r(C),{id:"belongs_to",modelValue:a.value.belongs_to,"onUpdate:modelValue":e[0]||(e[0]=l=>a.value.belongs_to=l),options:I.value,optionLabel:"label",optionValue:"value",class:y(["w-full",{"p-invalid":!a.value.belongs_to}]),onChange:H,disabled:c.value},null,8,["modelValue","options","class","disabled"])]),o("div",pe,[o("label",_e,[b(p(r(t)("customTabs.modelId"))+" ",1),e[8]||(e[8]=o("span",{class:"text-red-500"},"*",-1))]),m(r(C),{id:"model_id",modelValue:a.value.model_id,"onUpdate:modelValue":e[1]||(e[1]=l=>a.value.model_id=l),options:J.value,optionLabel:O.value,optionValue:"id",class:y(["w-full",{"p-invalid":!a.value.model_id&&a.value.model_id!==0}]),disabled:!a.value.belongs_to||c.value,filter:"",filterPlaceholder:"Search",onFilter:G},null,8,["modelValue","options","optionLabel","class","disabled"])]),o("div",be,[o("label",ye,[b(p(r(t)("customTabs.rowType"))+" ",1),e[9]||(e[9]=o("span",{class:"text-red-500"},"*",-1))]),m(r(C),{id:"row_type",modelValue:a.value.row_type,"onUpdate:modelValue":e[2]||(e[2]=l=>a.value.row_type=l),options:N.value,optionLabel:"label",optionValue:"value",class:y(["w-full",{"p-invalid":!a.value.row_type&&a.value.row_type!==0}]),disabled:c.value},null,8,["modelValue","options","class","disabled"])]),o("div",ge,[o("label",fe,[b(p(r(t)("customTabs.nameEn"))+" ",1),e[10]||(e[10]=o("span",{class:"text-red-500"},"*",-1))]),m(r(j),{id:"name_en",modelValue:a.value.name_en,"onUpdate:modelValue":e[3]||(e[3]=l=>a.value.name_en=l),class:y(["w-full",{"p-invalid":!a.value.name_en}]),disabled:c.value},null,8,["modelValue","class","disabled"])]),o("div",xe,[o("label",he,[b(p(r(t)("customTabs.nameAr"))+" ",1),e[11]||(e[11]=o("span",{class:"text-red-500"},"*",-1))]),m(r(j),{id:"name_ar",modelValue:a.value.name_ar,"onUpdate:modelValue":e[4]||(e[4]=l=>a.value.name_ar=l),dir:"rtl",class:y(["w-full",{"p-invalid":!a.value.name_ar}]),disabled:c.value},null,8,["modelValue","class","disabled"])])]),o("div",we,[m(r(q),{type:"button",label:r(t)("customTabs.cancelButton"),icon:"pi pi-times",onClick:e[5]||(e[5]=l=>r(D).push({name:"custom-tabs"})),class:"p-button-outlined p-button-secondary text-sm mx-2",disabled:c.value||_.value},null,8,["label","disabled"]),m(r(q),{type:"submit",label:r(t)("customTabs.updateButton"),icon:"pi pi-check",loading:c.value,class:"p-button-success text-sm mx-2",disabled:_.value},null,8,["label","loading","disabled"])])],32)])),m(r(re))],8,ne)),[[i,"update custom tabs"]])}}},Fe=X(ke,[["__scopeId","data-v-68d2f512"]]);export{Fe as default};
