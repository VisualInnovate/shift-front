import{_ as Te,l as Ie,a as Ne,u as ze,r as i,x as ue,o as Me,a1 as pe,e as f,h as x,g as d,i as s,w as c,j as e,t as u,F as ve,m as Oe,b as _,U as qe,V as q,W as p,B,a3 as Ae,k as Qe,a4 as g,v as D,ad as We,ae as me,f as be,s as _e,n as R,a5 as Ge,A as Ke,T as A,af as K}from"./index-d0993f26.js";const He={class:"grid"},Je={class:"col-12"},Xe={class:"card p-4 shadow-2 border-round"},Ye={class:"text-2xl font-bold"},Ze={class:"flex gap-2 align-items-center"},et={class:"p-input-icon-left"},tt={class:"flex flex-wrap gap-2 align-items-center mt-2"},at={class:"card shadow-1 surface-0"},lt={class:"flex justify-content-center align-items-center"},ot={class:"flex justify-content-center align-items-center"},st={class:"text-center py-4"},it={class:"text-xl"},rt={class:"p-paginator p-component p-unselectable-text p-paginator-bottom"},dt={class:"p-paginator-left-content"},nt={class:"p-paginator-current"},ct={class:"p-paginator-right-content"},ut=["disabled"],pt=["disabled"],vt=["onClick"],mt={key:1,class:"p-paginator-dots"},bt=["disabled"],_t=["disabled"],ft={class:"flex align-items-center justify-content-center"},gt={class:"flex flex-column gap-3"},ht={key:0,class:"mt-2"},yt={class:"font-semibold"},xt={class:"flex flex-column gap-3"},kt={key:0,class:"mt-4"},wt={class:"font-semibold"},Ct={class:"flex flex-column gap-3"},St={__name:"index",setup(Ut){const H=Ie(),n=Ne(),{t}=ze(),j=i(!0),J=i([]),V=i(!1),X=i(null);i(null),i({});const k=i("");i(null);const w=i(!1),T=i(!1),m=i(null),C=i(!1),Y=i([]),Z=i([]),ee=i([]),S=i(null),U=i(null),$=i(null),te=i(""),ae=i(""),I=i(localStorage.getItem("appLang")||"en"),F=i(!1),E=i(null),Q=i(!1),N=i({}),z=i({}),h=i(1),le=i(0),L=i(10),M=i(0),fe=i(""),ge=i(""),oe=i(""),se=i(""),ie=i(0),re=i(0),de=i([]),W=async()=>{try{const o=await _.get("/api/category",{params:{search:te.value||void 0}}),l=I.value;Y.value=o.data.data.data.map(r=>({label:l==="en"?r.name_en:r.name_ar,value:r.id}))}catch{n.add({severity:"error",summary:t("error"),detail:t("category.loadError"),life:3e3})}},ne=async()=>{try{const o=await _.get("/api/store"),l=I.value;Z.value=o.data.data.data.map(r=>({label:l==="en"?r.name_en:r.name_ar,value:r.id}))}catch{n.add({severity:"error",summary:t("error"),detail:t("store.loadError"),life:3e3})}},G=async()=>{try{const o=await _.get("/api/market",{params:{search:ae.value||void 0}}),l=I.value;ee.value=o.data.data.data.map(r=>({label:l==="en"?r.name_en:r.name_ar,value:r.id}))}catch{n.add({severity:"error",summary:t("error"),detail:t("market.loadError"),life:3e3})}},y=()=>{j.value=!0,_.get("/api/product",{params:{page:h.value,limit:L.value,search:k.value||void 0,category_id:S.value||void 0,store_id:U.value||void 0,market_id:$.value||void 0}}).then(o=>{J.value=o.data.data.data,le.value=o.data.data.total,M.value=o.data.data.last_page,fe.value=o.data.data.first_page_url,ge.value=o.data.data.last_page_url,oe.value=o.data.data.next_page_url,se.value=o.data.data.prev_page_url,ie.value=o.data.data.from,re.value=o.data.data.to,de.value=o.data.data.links,j.value=!1}).catch(o=>{n.add({severity:"error",summary:t("error"),detail:t("product.loadError"),life:3e3}),j.value=!1,console.error("Error fetching products:",o)})};ue([k,L,S,U,$],()=>{h.value=1,y()}),ue(I,()=>{W(),ne(),G()});const he=o=>{te.value=o.value,W()},ye=o=>{ae.value=o.value,G()},P=o=>{o>=1&&o<=M.value&&(h.value=o,y())},xe=o=>{L.value=o.value,h.value=1,y()},ke=o=>{X.value=o,V.value=!0},we=()=>{_.delete(`/api/product/${X.value}`).then(()=>{n.add({severity:"success",summary:t("success"),detail:t("product.deleteSuccess"),life:3e3}),y(),V.value=!1}).catch(()=>{n.add({severity:"error",summary:t("error"),detail:t("product.deleteError"),life:3e3})})},Ce=()=>{const l=`/api/export/products?${new URLSearchParams({search:k.value||"",category_id:S.value||"",store_id:U.value||"",market_id:$.value||""}).toString()}`;_.get(l,{responseType:"blob"}).then(r=>{const v=new Blob([r.data],{type:"text/csv"}),a=document.createElement("a");a.href=URL.createObjectURL(v),a.download="products_export.csv",a.click(),n.add({severity:"success",summary:t("success"),detail:t("product.exportSuccess"),life:3e3})}).catch(()=>{n.add({severity:"error",summary:t("error"),detail:t("product.exportError"),life:3e3})})},Se=()=>{const l=`/api/export/variants?${new URLSearchParams({search:k.value||"",category_id:S.value||"",store_id:U.value||"",market_id:$.value||""}).toString()}`;_.get(l,{responseType:"blob"}).then(r=>{const v=new Blob([r.data],{type:"text/csv"}),a=document.createElement("a");a.href=URL.createObjectURL(v),a.download="products_variants_export.csv",a.click(),n.add({severity:"success",summary:t("success"),detail:t("product.exportSuccess"),life:3e3})}).catch(()=>{n.add({severity:"error",summary:t("error"),detail:t("product.exportError"),life:3e3})})},Ue=()=>{const o=`store_id,category_id,market_id,name_en,name_ar,sku,brand_id,sub_name_en,sub_name_ar,description_en,description_ar,base_price,cost_price,tax
1,1,1,Demo Product,منتج تجريبي,SKU001,1,Sub Demo,تجريبي فرعي,Description,وصف,15.50,10.00,0.05`,l=new Blob([o],{type:"text/csv"}),r=document.createElement("a");r.href=URL.createObjectURL(l),r.download="product_import_example.csv",r.click()},$e=()=>{const o=[{product_id:84,variant_id:9,price:2},{product_id:1650,variant_id:10,price:0},{product_id:22516,variant_id:11,price:.03},{product_id:22516,variant_id:12,price:.33},{product_id:37864,variant_id:19,price:10},{product_id:37864,variant_id:20,price:9},{product_id:37864,variant_id:21,price:10},{product_id:37864,variant_id:22,price:9},{product_id:55,variant_id:25,price:.77}],r=[["product_id","variant_id","price"].join(","),...o.map(O=>`${O.product_id},${O.variant_id},${O.price}`)].join(`
`),v=new Blob(["\uFEFF"+r],{type:"text/csv;charset=utf-8;"}),a=URL.createObjectURL(v),b=document.createElement("a");b.href=a,b.setAttribute("download","products_template.csv"),b.style.visibility="hidden",document.body.appendChild(b),b.click(),document.body.removeChild(b)},Ve=()=>{const o=`id,price,cost_price
1,16.00,10.50
2,23.50,15.00`,l=new Blob([o],{type:"text/csv"}),r=document.createElement("a");r.href=URL.createObjectURL(l),r.download="product_price_update_example.csv",r.click()},ce=o=>{m.value=o.files[0]},Fe=o=>{E.value=o.files[0]},Ee=()=>{if(!m.value)return n.add({severity:"error",detail:t("validation.fileRequired"),life:3e3});C.value=!0;const o=new FormData;o.append("file",m.value),_.post("/api/import/products",o).then(()=>{n.add({severity:"success",detail:t("product.importSuccess"),life:3e3}),y(),w.value=!1,m.value=null}).catch(()=>n.add({severity:"error",detail:t("product.importError"),life:3e3})).finally(()=>C.value=!1)},Le=()=>{if(!m.value)return n.add({severity:"error",detail:t("validation.fileRequired"),life:3e3});C.value=!0;const o=new FormData;o.append("file",m.value),_.post("/api/product/update/variants/prices",o).then(()=>{n.add({severity:"success",detail:t("product.importSuccess"),life:3e3}),y(),w.value=!1,m.value=null}).catch(()=>n.add({severity:"error",detail:t("product.importError"),life:3e3})).finally(()=>C.value=!1)},Pe=()=>{if(!E.value)return n.add({severity:"error",detail:t("validation.fileRequired"),life:3e3});Q.value=!0;const o=new FormData;o.append("file",E.value),_.post("/api/product/update/prices",o).then(()=>{n.add({severity:"success",detail:t("product.priceUpdateSuccess"),life:3e3}),y(),F.value=!1,E.value=null}).catch(()=>n.add({severity:"error",detail:t("product.priceUpdateError"),life:3e3})).finally(()=>Q.value=!1)},Be=async o=>{const l=o.id,r=o.is_free_shipping,v=r===1?0:1;N.value[l]=!0;try{await _.post(`/api/product/is/free/shipping/${l}`,{is_free_shipping:v}),o.is_free_shipping=v,n.add({severity:"success",detail:t(v===1?"product.freeShippingEnabled":"product.freeShippingDisabled"),life:3e3})}catch{o.is_free_shipping=r,n.add({severity:"error",detail:t("product.freeShippingUpdateError"),life:3e3})}finally{N.value[l]=!1}},De=async o=>{const l=o.id,r=o.is_best_seller?1:0,v=r===1?0:1;z.value[l]=!0;try{await _.get(`/api/product/update/best-sellers/${l}`),o.is_best_seller=v===1,n.add({severity:"success",summary:t("success"),detail:v===1?"Product marked as Best Seller":"Product removed from Best Sellers",life:3e3})}catch(a){o.is_best_seller=r===1,n.add({severity:"error",summary:t("error"),detail:"Failed to update Best Seller status",life:3e3}),console.error("Error updating best seller:",a)}finally{z.value[l]=!1}},Re=()=>H.push({name:"product-create"}),je=o=>H.push({name:"product-update",params:{id:o}});return Me(()=>{Promise.all([W(),ne(),G(),y()])}),(o,l)=>{const r=pe("can"),v=pe("tooltip");return f(),x("div",He,[d("div",Je,[d("div",Xe,[s(e(Ae),{class:"mb-4"},{start:c(()=>[d("h2",Ye,u(e(t)("product.managementTitle")),1)]),end:c(()=>[d("div",null,[d("div",Ze,[d("span",et,[l[20]||(l[20]=d("i",{class:"pi pi-search"},null,-1)),s(e(qe),{modelValue:k.value,"onUpdate:modelValue":l[0]||(l[0]=a=>k.value=a),placeholder:e(t)("product.search")},null,8,["modelValue","placeholder"])]),s(e(q),{modelValue:S.value,"onUpdate:modelValue":l[1]||(l[1]=a=>S.value=a),options:Y.value,optionLabel:"label",optionValue:"value",placeholder:e(t)("product.categoryFilter"),class:"w-12rem",showClear:!0,filter:"",onFilter:he},null,8,["modelValue","options","placeholder"]),s(e(q),{modelValue:U.value,"onUpdate:modelValue":l[2]||(l[2]=a=>U.value=a),options:Z.value,optionLabel:"label",optionValue:"value",placeholder:e(t)("product.storeFilter"),class:"w-12rem",showClear:!0},null,8,["modelValue","options","placeholder"]),s(e(q),{modelValue:$.value,"onUpdate:modelValue":l[3]||(l[3]=a=>$.value=a),options:ee.value,optionLabel:"label",optionValue:"value",placeholder:e(t)("product.marketFilter"),class:"w-12rem",showClear:!0,filter:"",onFilter:ye},null,8,["modelValue","options","placeholder"])]),d("div",tt,[s(e(p),{label:e(t)("product.updatePrice"),icon:"pi pi-dollar",class:"p-button-warning p-button-outlined",onClick:l[4]||(l[4]=a=>F.value=!0)},null,8,["label"]),s(e(p),{label:e(t)("product.import"),icon:"pi pi-download",onClick:l[5]||(l[5]=a=>w.value=!0)},null,8,["label"]),s(e(p),{label:e(t)("product.export"),icon:"pi pi-upload",onClick:Ce},null,8,["label"]),B(s(e(p),{label:e(t)("product.new"),icon:"pi pi-plus",class:"p-button-success",onClick:Re},null,8,["label"]),[[r,"create products"]]),s(e(p),{label:e(t)("product.import_product_characteristics"),icon:"pi pi-download",onClick:l[6]||(l[6]=a=>T.value=!0)},null,8,["label"]),s(e(p),{label:e(t)("product.export_prices_features"),icon:"pi pi-upload",onClick:Se},null,8,["label"])])])]),_:1}),s(e(Qe)),d("div",at,[s(e(Ge),{value:J.value,loading:j.value,"data-key":"id","responsive-layout":"scroll",stripedRows:"",showGridlines:"",class:"p-datatable-sm"},{empty:c(()=>[d("div",st,[d("p",it,u(e(t)("product.noData")),1)])]),default:c(()=>[s(e(g),{field:"id",header:e(t)("id"),sortable:!0,"header-style":"width:6%;"},{body:c(a=>[D(u(a.data.id),1)]),_:1},8,["header"]),s(e(g),{field:"name_ar",header:e(t)("product.nameAr"),sortable:!0},{body:c(a=>[D(u(a.data.name_ar),1)]),_:1},8,["header"]),s(e(g),{field:"name_en",header:e(t)("product.nameEn"),sortable:!0},{body:c(a=>[D(u(a.data.name_en),1)]),_:1},8,["header"]),s(e(g),{field:"base_price",header:e(t)("product.basePrice")},{body:c(a=>[D(u(a.data.base_price),1)]),_:1},8,["header"]),s(e(g),{header:e(t)("product.Price after discount")},{body:c(a=>[D(u(a.data.base_price-a.data.total_discounts_value),1)]),_:1},8,["header"]),s(e(g),{field:"is_displayed",header:e(t)("product.isDisplayed")},{body:c(a=>[s(e(We),{value:a.data.is_displayed?e(t)("yes"):e(t)("no"),severity:a.data.is_displayed?"success":"info"},null,8,["value","severity"])]),_:1},8,["header"]),s(e(g),{header:e(t)("product.freeShipping")},{body:c(a=>[d("div",lt,[B(s(e(me),{"model-value":a.data.is_free_shipping===1,disabled:N.value[a.data.id],"onUpdate:modelValue":b=>Be(a.data)},null,8,["model-value","disabled","onUpdate:modelValue"]),[[v,a.data.is_free_shipping===1?e(t)("product.freeShipping"):e(t)("product.notFreeShipping"),void 0,{top:!0}]]),N.value[a.data.id]?(f(),be(e(_e),{key:0,style:{width:"20px",height:"20px"},class:"ml-2",strokeWidth:"5"})):R("",!0)])]),_:1},8,["header"]),s(e(g),{header:e(t)("product.bestSeller")||"Best Seller"},{body:c(a=>[d("div",ot,[B(s(e(me),{"model-value":a.data.is_best_seller,disabled:z.value[a.data.id],"onUpdate:modelValue":b=>De(a.data)},null,8,["model-value","disabled","onUpdate:modelValue"]),[[v,a.data.is_best_seller?"Best Seller":"Not Best Seller",void 0,{top:!0}]]),z.value[a.data.id]?(f(),be(e(_e),{key:0,style:{width:"20px",height:"20px"},class:"ml-2",strokeWidth:"5"})):R("",!0)])]),_:1},8,["header"]),s(e(g),{header:e(t)("actions")},{body:c(a=>[B(s(e(p),{icon:"pi pi-pencil",class:"p-detail",onClick:b=>je(a.data.id)},null,8,["onClick"]),[[r,"edit products"],[v,e(t)("edit"),void 0,{top:!0}]]),B(s(e(p),{icon:"pi pi-trash mx-2",class:"p-delete",onClick:b=>ke(a.data.id)},null,8,["onClick"]),[[r,"delete products"],[v,e(t)("delete"),void 0,{top:!0}]])]),_:1},8,["header"])]),_:1},8,["value","loading"]),d("div",rt,[d("div",dt,[d("span",nt,u(e(t)("show"))+" "+u(ie.value)+" "+u(e(t)("to"))+" "+u(re.value)+" "+u(e(t)("from"))+" "+u(le.value),1)]),d("div",ct,[d("button",{class:"p-paginator-first p-link",disabled:h.value===1,onClick:l[7]||(l[7]=a=>P(1))},l[21]||(l[21]=[d("span",{class:"pi pi-angle-double-left"},null,-1)]),8,ut),d("button",{class:"p-paginator-prev p-link",disabled:!se.value,onClick:l[8]||(l[8]=a=>P(h.value-1))},l[22]||(l[22]=[d("span",{class:"pi pi-angle-left"},null,-1)]),8,pt),(f(!0),x(ve,null,Oe(de.value,(a,b)=>(f(),x(ve,{key:b},[a.label&&!isNaN(parseInt(a.label))?(f(),x("button",{key:0,class:Ke(["p-paginator-page p-link",{"p-highlight":a.active}]),onClick:O=>P(parseInt(a.label))},u(a.label),11,vt)):a.label==="..."?(f(),x("span",mt,"...")):R("",!0)],64))),128)),d("button",{class:"p-paginator-next p-link",disabled:!oe.value,onClick:l[9]||(l[9]=a=>P(h.value+1))},l[23]||(l[23]=[d("span",{class:"pi pi-angle-right"},null,-1)]),8,bt),d("button",{class:"p-paginator-last p-link",disabled:h.value===M.value,onClick:l[10]||(l[10]=a=>P(M.value))},l[24]||(l[24]=[d("span",{class:"pi pi-angle-double-right"},null,-1)]),8,_t),s(e(q),{modelValue:L.value,"onUpdate:modelValue":l[11]||(l[11]=a=>L.value=a),options:[5,10,20,30],onChange:xe,class:"ml-2",style:{width:"80px"}},null,8,["modelValue"])])])]),s(e(A),{visible:V.value,"onUpdate:visible":l[13]||(l[13]=a=>V.value=a),style:{width:"450px"},header:e(t)("product.deleteConfirmTitle"),modal:!0},{footer:c(()=>[s(e(p),{label:e(t)("no"),icon:"pi pi-times",class:"p-button-text",onClick:l[12]||(l[12]=a=>V.value=!1)},null,8,["label"]),s(e(p),{label:e(t)("yes"),icon:"pi pi-check",class:"p-button-text p-button-danger",onClick:we},null,8,["label"])]),default:c(()=>[d("div",ft,[l[25]||(l[25]=d("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem",color:"var(--red-500)"}},null,-1)),d("span",null,u(e(t)("product.deleteConfirmMessage")),1)])]),_:1},8,["visible","header"]),s(e(A),{visible:w.value,"onUpdate:visible":l[15]||(l[15]=a=>w.value=a),style:{width:"450px"},header:e(t)("product.importTitle"),modal:!0},{footer:c(()=>[s(e(p),{label:e(t)("cancel"),icon:"pi pi-times",class:"p-button-text",onClick:l[14]||(l[14]=a=>w.value=!1)},null,8,["label"]),s(e(p),{label:e(t)("product.importButton"),icon:"pi pi-check",loading:C.value,disabled:!m.value,onClick:Ee},null,8,["label","loading","disabled"])]),default:c(()=>[d("div",gt,[s(e(p),{label:e(t)("product.downloadExample"),icon:"pi pi-download",class:"p-button-outlined",onClick:Ue},null,8,["label"]),s(e(K),{mode:"basic","custom-upload":!0,onSelect:ce,maxFileSize:1e7,chooseLabel:"Select File"}),m.value?(f(),x("div",ht,[d("p",yt,u(e(t)("selectedFile"))+": "+u(m.value.name),1)])):R("",!0)])]),_:1},8,["visible","header"]),s(e(A),{visible:T.value,"onUpdate:visible":l[17]||(l[17]=a=>T.value=a),style:{width:"450px"},header:e(t)("product.import_product_characteristics"),modal:!0},{footer:c(()=>[s(e(p),{label:e(t)("cancel"),icon:"pi pi-times",class:"p-button-text",onClick:l[16]||(l[16]=a=>{T.value=!1,m.value=null})},null,8,["label"]),s(e(p),{label:e(t)("product.importButton"),icon:"pi pi-check",loading:C.value,disabled:!m.value,onClick:Le},null,8,["label","loading","disabled"])]),default:c(()=>[d("div",xt,[s(e(p),{label:e(t)("product.downloadExample"),icon:"pi pi-download",class:"p-button-outlined",onClick:$e},null,8,["label"]),s(e(K),{mode:"basic","custom-upload":!0,onSelect:ce,maxFileSize:1e7,chooseLabel:"Select File"})]),m.value?(f(),x("div",kt,[d("p",wt,u(e(t)("selectedFile"))+": "+u(m.value.name),1)])):R("",!0)]),_:1},8,["visible","header"]),s(e(A),{visible:F.value,"onUpdate:visible":l[19]||(l[19]=a=>F.value=a),style:{width:"450px"},header:e(t)("product.updatePriceTitle"),modal:!0},{footer:c(()=>[s(e(p),{label:e(t)("cancel"),icon:"pi pi-times",class:"p-button-text",onClick:l[18]||(l[18]=a=>F.value=!1)},null,8,["label"]),s(e(p),{label:e(t)("product.updatePriceButton"),icon:"pi pi-check",loading:Q.value,disabled:!E.value,onClick:Pe},null,8,["label","loading","disabled"])]),default:c(()=>[d("div",Ct,[s(e(p),{label:e(t)("product.downloadPriceExample"),icon:"pi pi-download",class:"p-button-outlined p-button-warning",onClick:Ve},null,8,["label"]),s(e(K),{mode:"basic","custom-upload":!0,onSelect:Fe,maxFileSize:1e7,chooseLabel:"Select Price File"})])]),_:1},8,["visible","header"])])])])}}},Vt=Te(St,[["__scopeId","data-v-9a0e3ec6"]]);export{Vt as default};
