import{_ as De,u as Fe,G as Le,j as Re,r as i,q as se,o as Be,a0 as ie,a as b,c as x,f as n,h as s,w as d,e,y as w,b as ne,t as c,F as de,d as Te,i as m,T as je,U as I,V as p,a2 as Ie,Q as Ne,H as ce,p as F,a3 as h,a5 as Ae,ad as Me,g as Q,a4 as ze,x as Oe,S as q,ae as ue}from"./index-22d4798b.js";const Qe={class:"grid"},qe={class:"col-12"},Ge={class:"card p-4 shadow-2 border-round"},Ke={class:"text-2xl font-bold"},We={class:"flex gap-2 align-items-center"},He={class:"p-input-icon-left"},Je={class:"card shadow-1 surface-0"},Xe={class:"flex justify-content-center align-items-center"},Ye={class:"text-center py-4"},Ze={class:"text-xl"},et={class:"flex justify-content-center align-items-center py-4"},tt={class:"p-paginator p-component p-unselectable-text p-paginator-bottom"},at={class:"p-paginator-left-content"},lt={class:"p-paginator-current"},ot={class:"p-paginator-right-content"},rt=["disabled"],st=["disabled"],it=["onClick"],nt={key:1,class:"p-paginator-dots"},dt=["disabled"],ct=["disabled"],ut={class:"flex align-items-center justify-content-center"},pt={class:"flex flex-column gap-3"},vt={key:0,class:"mt-2"},mt={class:"font-semibold"},ft={class:"flex flex-column gap-3"},bt={__name:"index",setup(ht){const G=Fe(),u=Le(),{t}=Re(),L=i(!0),K=i([]),k=i(!1),W=i(null),pe=i(null),ve=i({}),C=i("");i(null);const S=i(!1),g=i(null),N=i(!1),H=i([]),J=i([]),X=i([]),$=i(null),U=i(null),E=i(null),Y=i(""),Z=i(""),R=i(localStorage.getItem("appLang")||"en"),V=i(!1),P=i(null),A=i(!1),B=i({}),f=i(1),M=i(0),_=i(10),T=i(0),me=i(""),fe=i(""),ee=i(""),te=i(""),ae=i(0),le=i(0),oe=i([]),z=async()=>{try{const l=await m.get("/api/category",{params:{search:Y.value||void 0}}),a=R.value;H.value=l.data.data.data.map(r=>({label:a==="en"?`${r.name_en} `:`${r.name_ar} `,value:r.id}))}catch(l){u.add({severity:"error",summary:t("error"),detail:t("category.loadError"),life:3e3}),console.error("Error fetching categories:",l)}},re=async()=>{try{const l=await m.get("/api/store"),a=R.value;J.value=l.data.data.data.map(r=>({label:a==="en"?`${r.name_en} `:`${r.name_ar} `,value:r.id}))}catch(l){u.add({severity:"error",summary:t("error"),detail:t("store.loadError"),life:3e3}),console.error("Error fetching stores:",l)}},O=async()=>{try{const l=await m.get("/api/market",{params:{search:Z.value||void 0}}),a=R.value;X.value=l.data.data.data.map(r=>({label:a==="en"?`${r.name_en} `:`${r.name_ar} `,value:r.id}))}catch(l){u.add({severity:"error",summary:t("error"),detail:t("market.loadError"),life:3e3}),console.error("Error fetching markets:",l)}},y=()=>{L.value=!0,m.get("/api/product",{params:{page:f.value,limit:_.value,search:C.value||void 0,category_id:$.value||void 0,store_id:U.value||void 0,market_id:E.value||void 0}}).then(l=>{K.value=l.data.data.data,M.value=l.data.data.total,T.value=l.data.data.last_page,me.value=l.data.data.first_page_url,fe.value=l.data.data.last_page_url,ee.value=l.data.data.next_page_url,te.value=l.data.data.prev_page_url,ae.value=l.data.data.from,le.value=l.data.data.to,oe.value=l.data.data.links,L.value=!1}).catch(l=>{u.add({severity:"error",summary:t("error"),detail:t("product.loadError"),life:3e3}),L.value=!1,console.error("Error fetching products:",l)})};se([C,_,$,U,E],()=>{f.value=1,y()}),se(R,()=>{z(),re(),O()});const be=l=>{Y.value=l.value,z()},he=l=>{Z.value=l.value,O()},D=l=>{l>=1&&l<=T.value&&(f.value=l,y())},ge=l=>{_.value=l.value,f.value=1,y()},ye=l=>{W.value=l,k.value=!0},_e=()=>{m.delete(`/api/product/${W.value}`).then(()=>{u.add({severity:"success",summary:t("success"),detail:t("product.deleteSuccess"),life:3e3}),y(),k.value=!1}).catch(l=>{u.add({severity:"error",summary:t("error"),detail:t("product.deleteError"),life:3e3}),console.error("Error deleting product:",l)})},xe=()=>{const a=`/api/export/products?${new URLSearchParams({search:C.value||"",category_id:$.value||"",store_id:U.value||"",market_id:E.value||""}).toString()}`;m.get(a,{responseType:"blob"}).then(r=>{const v=new Blob([r.data],{type:"text/csv"}),o=document.createElement("a");o.href=URL.createObjectURL(v),o.download="products_export.csv",o.click(),URL.revokeObjectURL(o.href),u.add({severity:"success",summary:t("success"),detail:t("product.exportSuccess"),life:3e3})}).catch(r=>{u.add({severity:"error",summary:t("error"),detail:t("product.exportError"),life:3e3}),console.error("Error exporting products:",r)})},we=()=>{const l=`store_id,category_id,market_id,name_en,name_ar,sku,brand_id,sub_name_en,sub_name_ar,description_en,description_ar,base_price,cost_price,tax
1,1,1,Demo Product 1,منتج تجريبي 1,SKU001,1,Sub Demo 1,تجريبي فرعي 1,Description of Demo Product 1,وصف المنتج التجريبي 1,15.50,10.00,0.05
2,2,2,Demo Product 2,منتج تجريبي 2,SKU002,2,Sub Demo 2,تجريبي فرعي 2,Description of Demo Product 2,وصف المنتج التجريبي 2,22.00,15.00,0.05`,a=new Blob([l],{type:"text/xlsx;charset=utf-8;"}),r=document.createElement("a");if(r.download!==void 0){const v=URL.createObjectURL(a);r.setAttribute("href",v),r.setAttribute("download","product_import_example.xlsx"),r.style.visibility="hidden",document.body.appendChild(r),r.click(),document.body.removeChild(r)}},ke=()=>{const l=`id,price,cost_price
1,16.00,10.50
2,23.50,15.00`,a=new Blob([l],{type:"text/csv;charset=utf-8;"}),r=document.createElement("a");if(r.download!==void 0){const v=URL.createObjectURL(a);r.setAttribute("href",v),r.setAttribute("download","product_price_update_example.csv"),r.style.visibility="hidden",document.body.appendChild(r),r.click(),document.body.removeChild(r)}},Ce=l=>{g.value=l.files[0]},Se=l=>{P.value=l.files[0]},$e=()=>{if(!g.value){u.add({severity:"error",summary:t("error"),detail:t("validation.fileRequired"),life:3e3});return}N.value=!0;const l=new FormData;l.append("file",g.value),m.post("/api/import/products",l).then(()=>{u.add({severity:"success",summary:t("success"),detail:t("product.importSuccess"),life:3e3}),y(),S.value=!1,g.value=null}).catch(a=>{u.add({severity:"error",summary:t("error"),detail:t("product.importError"),life:3e3}),console.error("Error importing products:",a)}).finally(()=>{N.value=!1})},Ue=()=>{if(!P.value){u.add({severity:"error",summary:t("error"),detail:t("validation.fileRequired"),life:3e3});return}A.value=!0;const l=new FormData;l.append("file",P.value),m.post("/api/product/update/prices",l).then(()=>{u.add({severity:"success",summary:t("success"),detail:t("product.priceUpdateSuccess"),life:3e3}),y(),V.value=!1,P.value=null}).catch(a=>{u.add({severity:"error",summary:t("error"),detail:t("product.priceUpdateError"),life:3e3}),console.error("Error updating prices:",a)}).finally(()=>{A.value=!1})},Ee=async l=>{const a=l.id,r=l.is_free_shipping,v=r===1?0:1;B.value[a]=!0;try{await m.post(`/api/product/is/free/shipping/${a}`,{is_free_shipping:v}),l.is_free_shipping=v,u.add({severity:"success",summary:t("success"),detail:t(v===1?"product.freeShippingEnabled":"product.freeShippingDisabled"),life:3e3})}catch(o){l.is_free_shipping=r,u.add({severity:"error",summary:t("error"),detail:t("product.freeShippingUpdateError"),life:3e3}),console.error("Error updating free shipping:",o)}finally{B.value[a]=!1}},Ve=()=>{G.push({name:"product-create"})},Pe=l=>{G.push({name:"product-update",params:{id:l}})};return Be(()=>{Promise.all([z(),re(),O(),y()])}),(l,a)=>{const r=ie("can"),v=ie("tooltip");return b(),x("div",Qe,[n("div",qe,[n("div",Ge,[s(e(Ie),{class:"mb-4"},{start:d(()=>[n("h2",Ke,c(e(t)("product.managementTitle")),1)]),end:d(()=>[n("div",We,[n("span",He,[a[17]||(a[17]=n("i",{class:"pi pi-search"},null,-1)),s(e(je),{modelValue:C.value,"onUpdate:modelValue":a[0]||(a[0]=o=>C.value=o),placeholder:e(t)("product.search")},null,8,["modelValue","placeholder"])]),s(e(I),{modelValue:$.value,"onUpdate:modelValue":a[1]||(a[1]=o=>$.value=o),options:H.value,optionLabel:"label",optionValue:"value",placeholder:e(t)("product.categoryFilter"),class:"w-12rem",showClear:!0,filter:"",filterPlaceholder:"Search categories",onFilter:be},null,8,["modelValue","options","placeholder"]),s(e(I),{modelValue:U.value,"onUpdate:modelValue":a[2]||(a[2]=o=>U.value=o),options:J.value,optionLabel:"label",optionValue:"value",placeholder:e(t)("product.storeFilter"),class:"w-12rem",showClear:!0},null,8,["modelValue","options","placeholder"]),s(e(I),{modelValue:E.value,"onUpdate:modelValue":a[3]||(a[3]=o=>E.value=o),options:X.value,optionLabel:"label",optionValue:"value",placeholder:e(t)("product.marketFilter"),class:"w-12rem",showClear:!0,filter:"",filterPlaceholder:"Search markets",onFilter:he},null,8,["modelValue","options","placeholder"]),s(e(p),{label:e(t)("product.updatePrice"),icon:"pi pi-dollar",class:"p-button-warning p-button-outlined",onClick:a[4]||(a[4]=o=>V.value=!0)},null,8,["label"]),s(e(p),{label:e(t)("product.import"),icon:"pi pi-download",class:"p-import",onClick:a[5]||(a[5]=o=>S.value=!0)},null,8,["label"]),w(s(e(p),{label:e(t)("product.export"),icon:"pi pi-upload",class:"p-export",onClick:xe},null,8,["label"]),[[r,"list products"]]),w(s(e(p),{label:e(t)("product.new"),icon:"pi pi-plus",class:"p-button-success",onClick:Ve},null,8,["label"]),[[r,"create products"]])])]),_:1}),s(e(Ne)),n("div",Je,[w((b(),ne(e(ze),{ref_key:"dt",ref:pe,value:K.value,loading:L.value,"data-key":"id",paginator:!1,rows:_.value,filters:ve.value,totalRecords:M.value,"responsive-layout":"scroll",stripedRows:"",showGridlines:"",class:"p-datatable-sm"},{empty:d(()=>[n("div",Ye,[a[18]||(a[18]=n("i",{class:"pi pi-exclamation-circle text-2xl mb-2"},null,-1)),n("p",Ze,c(e(t)("product.noData")),1)])]),loading:d(()=>[n("div",et,[s(e(ce),{style:{width:"50px",height:"50px"},strokeWidth:"4"})])]),default:d(()=>[s(e(h),{field:"id",header:e(t)("id"),sortable:!0,"header-style":"width:6%; min-width:4rem;"},{body:d(o=>[F(c(o.data.id),1)]),_:1},8,["header"]),s(e(h),{field:"name_ar",header:e(t)("product.nameAr"),sortable:!0,"header-style":"width:14%; min-width:13rem;"},{body:d(o=>[F(c(o.data.name_ar),1)]),_:1},8,["header"]),s(e(h),{field:"name_en",header:e(t)("product.nameEn"),sortable:!0,"header-style":"width:14%; min-width:13rem;"},{body:d(o=>[F(c(o.data.name_en),1)]),_:1},8,["header"]),s(e(h),{field:"base_price",header:e(t)("product.basePrice"),sortable:!0,"header-style":"width:8%; min-width:8rem;"},{body:d(o=>[F(c(o.data.base_price),1)]),_:1},8,["header"]),s(e(h),{field:"total_discounts_value",header:e(t)("product.Price after discount"),sortable:!0,"header-style":"width:10%; min-width:10rem;"},{body:d(o=>[F(c(o.data.base_price-o.data.total_discounts_value),1)]),_:1},8,["header"]),s(e(h),{field:"is_displayed",header:e(t)("product.isDisplayed"),sortable:!0,"header-style":"width:7%; min-width:7rem;"},{body:d(o=>[s(e(Ae),{value:o.data.is_displayed?e(t)("yes"):e(t)("no"),severity:o.data.is_displayed?"success":"info"},null,8,["value","severity"])]),_:1},8,["header"]),s(e(h),{header:e(t)("product.freeShipping"),"header-style":"width:10%; min-width:8rem;"},{body:d(o=>[n("div",Xe,[w(s(e(Me),{"model-value":o.data.is_free_shipping===1,disabled:B.value[o.data.id],"onUpdate:modelValue":j=>Ee(o.data)},null,8,["model-value","disabled","onUpdate:modelValue"]),[[v,o.data.is_free_shipping===1?e(t)("product.freeShipping"):e(t)("product.notFreeShipping"),void 0,{top:!0}]]),B.value[o.data.id]?(b(),ne(e(ce),{key:0,style:{width:"20px",height:"20px"},class:"ml-2",strokeWidth:"5"})):Q("",!0)])]),_:1},8,["header"]),s(e(h),{header:e(t)("actions"),"header-style":"width:14rem"},{body:d(o=>[w(s(e(p),{icon:"pi pi-pencil",class:"p-detail",onClick:j=>Pe(o.data.id)},null,8,["onClick"]),[[r,"edit products"],[v,e(t)("edit"),void 0,{top:!0}]]),w(s(e(p),{icon:"pi pi-trash mx-2",class:"p-delete",onClick:j=>ye(o.data.id)},null,8,["onClick"]),[[r,"delete products"],[v,e(t)("delete"),void 0,{top:!0}]])]),_:1},8,["header"])]),_:1},8,["value","loading","rows","filters","totalRecords"])),[[r,"list products"]]),n("div",tt,[n("div",at,[n("span",lt,c(e(t)("show"))+" "+c(ae.value)+" "+c(e(t)("to"))+" "+c(le.value)+" "+c(e(t)("from"))+" "+c(M.value),1)]),n("div",ot,[n("button",{class:"p-paginator-first p-paginator-element p-link",disabled:f.value===1,onClick:a[6]||(a[6]=o=>D(1))},a[19]||(a[19]=[n("span",{class:"p-paginator-icon pi pi-angle-double-left"},null,-1)]),8,rt),n("button",{class:"p-paginator-prev p-paginator-element p-link",disabled:!te.value,onClick:a[7]||(a[7]=o=>D(f.value-1))},a[20]||(a[20]=[n("span",{class:"p-paginator-icon pi pi-angle-left"},null,-1)]),8,st),(b(!0),x(de,null,Te(oe.value,(o,j)=>(b(),x(de,{key:j},[o.label&&!isNaN(parseInt(o.label))?(b(),x("button",{key:0,class:Oe(["p-paginator-page p-paginator-element p-link",{"p-highlight":o.active}]),onClick:gt=>D(parseInt(o.label))},c(o.label),11,it)):o.label==="..."?(b(),x("span",nt,"...")):Q("",!0)],64))),128)),n("button",{class:"p-paginator-next p-paginator-element p-link",disabled:!ee.value,onClick:a[8]||(a[8]=o=>D(f.value+1))},a[21]||(a[21]=[n("span",{class:"p-paginator-icon pi pi-angle-right"},null,-1)]),8,dt),n("button",{class:"p-paginator-last p-paginator-element p-link",disabled:f.value===T.value,onClick:a[9]||(a[9]=o=>D(T.value))},a[22]||(a[22]=[n("span",{class:"p-paginator-icon pi pi-angle-double-right"},null,-1)]),8,ct),s(e(I),{modelValue:_.value,"onUpdate:modelValue":a[10]||(a[10]=o=>_.value=o),options:[5,10,20,30],onChange:ge,class:"ml-2",style:{width:"80px"}},null,8,["modelValue"])])])]),s(e(q),{visible:k.value,"onUpdate:visible":a[12]||(a[12]=o=>k.value=o),style:{width:"450px"},header:e(t)("product.deleteConfirmTitle"),modal:!0},{footer:d(()=>[s(e(p),{label:e(t)("no"),icon:"pi pi-times",class:"p-button-text",onClick:a[11]||(a[11]=o=>k.value=!1)},null,8,["label"]),s(e(p),{label:e(t)("yes"),icon:"pi pi-check",class:"p-button-text p-button-danger",onClick:_e},null,8,["label"])]),default:d(()=>[n("div",ut,[a[23]||(a[23]=n("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem",color:"var(--red-500)"}},null,-1)),n("span",null,c(e(t)("product.deleteConfirmMessage")),1)])]),_:1},8,["visible","header"]),s(e(q),{visible:S.value,"onUpdate:visible":a[14]||(a[14]=o=>S.value=o),style:{width:"450px"},header:e(t)("product.importTitle"),modal:!0},{footer:d(()=>[s(e(p),{label:e(t)("cancel"),icon:"pi pi-times",class:"p-button-text",onClick:a[13]||(a[13]=o=>S.value=!1)},null,8,["label"]),s(e(p),{label:e(t)("product.importButton"),icon:"pi pi-check",loading:N.value,disabled:!g.value,onClick:$e},null,8,["label","loading","disabled"])]),default:d(()=>[n("div",pt,[s(e(p),{label:e(t)("product.downloadExample"),icon:"pi pi-download",class:"p-button-outlined",onClick:we},null,8,["label"]),s(e(ue),{mode:"basic","custom-upload":!0,onSelect:Ce,maxFileSize:1e7,chooseLabel:"Select File"}),g.value?(b(),x("div",vt,[n("p",mt,c(e(t)("selectedFile"))+": "+c(g.value.name),1)])):Q("",!0)])]),_:1},8,["visible","header"]),s(e(q),{visible:V.value,"onUpdate:visible":a[16]||(a[16]=o=>V.value=o),style:{width:"450px"},header:e(t)("product.updatePriceTitle"),modal:!0},{footer:d(()=>[s(e(p),{label:e(t)("cancel"),icon:"pi pi-times",class:"p-button-text",onClick:a[15]||(a[15]=o=>V.value=!1)},null,8,["label"]),s(e(p),{label:e(t)("product.updatePriceButton"),icon:"pi pi-check",loading:A.value,disabled:!P.value,onClick:Ue},null,8,["label","loading","disabled"])]),default:d(()=>[n("div",ft,[s(e(p),{label:e(t)("product.downloadPriceExample"),icon:"pi pi-download",class:"p-button-outlined p-button-warning",onClick:ke},null,8,["label"]),s(e(ue),{mode:"basic","custom-upload":!0,onSelect:Se,maxFileSize:1e7,chooseLabel:"Select Price File"})])]),_:1},8,["visible","header"])])])])}}},_t=De(bt,[["__scopeId","data-v-459baf43"]]);export{_t as default};
