import{_ as ie,b as de,u as re,c as ce,r as n,y as ue,z as pe,o as ve,q as p,a1 as L,e as g,f as C,g as s,h as i,w as c,B as w,v as _e,t as r,i as l,F as q,m as me,a2 as ge,p as G,k as D,n as be,l as fe}from"./index-ce71ecef.js";const he={class:"grid"},xe={class:"col-12"},ye={class:"card p-4 shadow-2 border-round"},ke={class:"text-2xl font-bold"},Ce={class:"flex gap-2"},we={class:"p-input-icon-left"},De={class:"card shadow-1 surface-0"},Te={class:"text-center py-4"},Ve={class:"text-xl"},Ne={class:"flex justify-content-center align-items-center py-4"},Pe={class:"p-paginator p-component p-unselectable-text p-paginator-bottom"},$e={class:"p-paginator-left-content"},Be={class:"p-paginator-current"},Se={class:"p-paginator-right-content"},Ue=["disabled"],Ie=["disabled"],Me=["onClick"],Re={key:1,class:"p-paginator-dots"},Ee=["disabled"],Fe=["disabled"],ze={class:"flex align-items-center justify-content-center"},je={__name:"index",setup(Ae){const B=de(),{t:a}=re(),P=ce(),T=n(!0),S=n(""),U=n(null),b=n(!1);n(null);const I=n(null),M=n({}),V=n(""),v=n(1),$=n(0),f=n(10),N=n(0),O=n(""),Q=n(""),R=n(""),E=n(""),F=n(0),z=n(0),j=n([]),W=()=>{I.value.exportCSV()},H=o=>{S.value=o,b.value=!0},J=()=>{G.delete(`/api/discount/${S.value}`).then(()=>{h(),b.value=!1,P.add({severity:"success",summary:a("success"),detail:a("discount.deleteSuccess"),life:3e3})}).catch(()=>{P.add({severity:"error",summary:a("error"),detail:a("discount.deleteError"),life:3e3})})},K=()=>{M.value={global:{value:null,matchMode:ge.CONTAINS}}};ue(()=>{K()});const h=()=>{T.value=!0,G.get("/api/discount",{params:{page:v.value,limit:f.value,search:V.value}}).then(o=>{U.value=o.data.data.data,$.value=o.data.data.total,N.value=o.data.data.last_page,O.value=o.data.data.first_page_url,Q.value=o.data.data.last_page_url,R.value=o.data.data.next_page_url,E.value=o.data.data.prev_page_url,F.value=o.data.data.from,z.value=o.data.data.to,j.value=o.data.data.links,T.value=!1}).catch(o=>{T.value=!1,P.add({severity:"error",summary:a("error"),detail:a("discount.loadError"),life:3e3}),console.error("Error fetching discounts:",o)})};pe(V,o=>{v.value=1,h()});const x=o=>{o>=1&&o<=N.value&&(v.value=o,h())},X=o=>{f.value=o.value,v.value=1,h()};ve(()=>{h()});const Y=()=>{B.push({name:"discount-create"})},Z=o=>{B.push({name:"discount-update",params:{id:o}})};return(o,t)=>{const ee=p("InputText"),m=p("Button"),te=p("Toolbar"),ae=p("Toast"),_=p("Column"),se=p("ProgressSpinner"),oe=p("DataTable"),le=p("Dropdown"),ne=p("Dialog"),y=L("can"),A=L("tooltip");return g(),C("div",he,[s("div",xe,[s("div",ye,[i(te,{class:"mb-4"},{start:c(()=>[s("h2",ke,r(l(a)("discount.managementTitle")),1)]),end:c(()=>[s("div",Ce,[s("span",we,[t[8]||(t[8]=s("i",{class:"pi pi-search"},null,-1)),i(ee,{modelValue:V.value,"onUpdate:modelValue":t[0]||(t[0]=e=>V.value=e),placeholder:l(a)("discount.search")},null,8,["modelValue","placeholder"])]),w(i(m,{label:l(a)("discount.export"),icon:"pi pi-upload",class:"p-export",onClick:W},null,8,["label"]),[[y,"list discounts"]]),w(i(m,{label:l(a)("discount.new"),icon:"pi pi-plus",class:"p-button-success",onClick:Y},null,8,["label"]),[[y,"create discounts"]])])]),_:1}),i(ae),s("div",De,[w((g(),_e(oe,{ref_key:"dt",ref:I,value:U.value,loading:T.value,"data-key":"id",paginator:!1,rows:f.value,filters:M.value,totalRecords:$.value,"responsive-layout":"scroll",stripedRows:"",showGridlines:"",class:"p-datatable-sm"},{empty:c(()=>[s("div",Te,[t[9]||(t[9]=s("i",{class:"pi pi-exclamation-circle text-2xl mb-2"},null,-1)),s("p",Ve,r(l(a)("discount.noData")),1)])]),loading:c(()=>[s("div",Ne,[i(se,{style:{width:"50px",height:"50px"},strokeWidth:"4"})])]),default:c(()=>[i(_,{"selection-mode":"multiple","header-style":"width: 3rem"}),i(_,{field:"en_name",header:l(a)("product.nameEn"),sortable:!0},{body:c(e=>{var d,u,k;return[D(r(((u=(d=e.data.variants[0])==null?void 0:d.product)==null?void 0:u.name_en)||((k=e.data.products[0])==null?void 0:k.name_en)),1)]}),_:1},8,["header"]),i(_,{field:"name_ar",header:l(a)("product.nameAr"),sortable:!0},{body:c(e=>{var d,u,k;return[D(r(((u=(d=e.data.variants[0])==null?void 0:d.product)==null?void 0:u.name_ar)||((k=e.data.products[0])==null?void 0:k.name_ar)),1)]}),_:1},8,["header"]),i(_,{field:"sku",header:l(a)("product.sku"),sortable:!0},{body:c(e=>{var d;return[D(r((d=e.data.variants[0])==null?void 0:d.sku),1)]}),_:1},8,["header"]),i(_,{field:"price",header:l(a)("product.basePrice"),sortable:!0},{body:c(e=>{var d,u;return[D(r(((d=e.data.variants[0])==null?void 0:d.price)||((u=e.data.products[0])==null?void 0:u.base_price)||e.data.discount_value),1)]}),_:1},8,["header"]),i(_,{field:"expires_at",header:l(a)("discount.expires_at"),sortable:!0},{body:c(e=>[D(r(e.data.expires_at),1)]),_:1},8,["header"]),i(_,{header:l(a)("actions"),headerStyle:"width: 12rem"},{body:c(e=>[w(i(m,{icon:"pi pi-pencil",class:"p-detail",onClick:d=>Z(e.data.id)},null,8,["onClick"]),[[y,"edit discounts"],[A,l(a)("edit"),void 0,{top:!0}]]),w(i(m,{icon:"pi pi-trash",class:"p-delete mx-2",onClick:d=>H(e.data.id)},null,8,["onClick"]),[[y,"delete discounts"],[A,l(a)("delete"),void 0,{top:!0}]])]),_:1},8,["header"])]),_:1},8,["value","loading","rows","filters","totalRecords"])),[[y,"list discounts"]]),s("div",Pe,[s("div",$e,[s("span",Be,r(l(a)("show"))+" "+r(F.value)+" "+r(l(a)("to"))+" "+r(z.value)+" "+r(l(a)("from"))+" "+r($.value),1)]),s("div",Se,[s("button",{class:"p-paginator-first p-paginator-element p-link",disabled:v.value===1,onClick:t[1]||(t[1]=e=>x(1))},t[10]||(t[10]=[s("span",{class:"p-paginator-icon pi pi-angle-double-left"},null,-1)]),8,Ue),s("button",{class:"p-paginator-prev p-paginator-element p-link",disabled:!E.value,onClick:t[2]||(t[2]=e=>x(v.value-1))},t[11]||(t[11]=[s("span",{class:"p-paginator-icon pi pi-angle-left"},null,-1)]),8,Ie),(g(!0),C(q,null,me(j.value,(e,d)=>(g(),C(q,{key:d},[e.label&&!isNaN(e.label)?(g(),C("button",{key:0,class:be(["p-paginator-page p-paginator-element p-link",{"p-highlight":e.active}]),onClick:u=>x(parseInt(e.label))},r(e.label),11,Me)):e.label==="..."?(g(),C("span",Re,"...")):fe("",!0)],64))),128)),s("button",{class:"p-paginator-next p-paginator-element p-link",disabled:!R.value,onClick:t[3]||(t[3]=e=>x(v.value+1))},t[12]||(t[12]=[s("span",{class:"p-paginator-icon pi pi-angle-right"},null,-1)]),8,Ee),s("button",{class:"p-paginator-last p-paginator-element p-link",disabled:v.value===N.value,onClick:t[4]||(t[4]=e=>x(N.value))},t[13]||(t[13]=[s("span",{class:"p-paginator-icon pi pi-angle-double-right"},null,-1)]),8,Fe),i(le,{filter:"",modelValue:f.value,"onUpdate:modelValue":t[5]||(t[5]=e=>f.value=e),options:[5,10,20,30],optionLabel:"",onChange:X,class:"ml-2",style:{width:"80px"}},null,8,["modelValue"])])])]),i(ne,{visible:b.value,"onUpdate:visible":t[7]||(t[7]=e=>b.value=e),style:{width:"450px"},header:l(a)("discount.deleteConfirmTitle"),modal:!0},{footer:c(()=>[i(m,{label:l(a)("no"),icon:"pi pi-times",class:"p-button-text",onClick:t[6]||(t[6]=e=>b.value=!1)},null,8,["label"]),i(m,{label:l(a)("yes"),icon:"pi pi-check",class:"p-button-text p-button-danger",onClick:J},null,8,["label"])]),default:c(()=>[s("div",ze,[t[14]||(t[14]=s("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem",color:"var(--red-500)"}},null,-1)),s("span",null,r(l(a)("discount.deleteConfirmMessage")),1)])]),_:1},8,["visible","header"])])])])}}},qe=ie(je,[["__scopeId","data-v-4b6cd791"]]);export{qe as default};
