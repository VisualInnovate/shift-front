import{_ as pe,l as me,a as ve,u as be,r as o,x as fe,o as ge,a1 as ke,e as _,h as y,g as r,i,w as d,j as e,t as n,F as q,m as he,b as F,U as _e,W as p,a3 as ye,k as xe,s as we,a4 as b,v as k,B as L,a5 as Ce,A as $e,n as G,V as Fe,T,ag as Ue,aj as Q}from"./index-3843758b.js";const De={class:"grid"},Ee={class:"col-12"},Se={class:"card p-4 shadow-2 border-round"},Ve={class:"text-2xl font-bold"},Pe={class:"flex gap-2"},Le={class:"p-input-icon-left"},Re={class:"card shadow-1 surface-0"},Ne={class:"text-center py-4"},Te={class:"text-xl"},Ie={class:"flex justify-content-center align-items-center py-4"},je={class:"p-paginator p-component p-unselectable-text p-paginator-bottom"},Me={class:"p-paginator-left-content"},Ae={class:"p-paginator-current"},Be={class:"p-paginator-right-content"},Oe=["disabled"],ze=["disabled"],We=["onClick","aria-label"],qe={key:1,class:"p-paginator-dots"},Ge=["disabled"],Qe=["disabled"],He={class:"flex align-items-center justify-content-center"},Je={class:"flex flex-column gap-3"},Ke={key:0,class:"mt-2"},Xe={class:"font-semibold"},Ye={class:"gap-3"},Ze={for:"service_fee",class:"my-1"},ea={for:"service_final_price",class:"my-3 mt-4"},aa={__name:"index",setup(ta){const R=me(),m=ve(),{t}=be(),U=o(!0),I=o([]),x=o(!1),j=o(null),H=o(null),J=o({}),D=o("");o(null);const w=o(!1),f=o(null),E=o(!1),C=o(!1),M=o(null),S=o(0),V=o(0),v=o(1),N=o(0),h=o(10),P=o(0),K=o(""),X=o(""),A=o(""),B=o(""),O=o(0),z=o(0),W=o([]),Y=o([{id:"شفت 7",arabic_name:"Shift7",english_name:"الأحذية",Top_Parent:"shift7"}]),Z=s=>{R.push({name:"market-shipping-settings",params:{id:s}})},g=()=>{U.value=!0,F.get("/api/market",{params:{page:v.value,limit:h.value,search:D.value||void 0}}).then(s=>{I.value=s.data.data.data,N.value=s.data.data.total,P.value=s.data.data.last_page,K.value=s.data.data.first_page_url,X.value=s.data.data.last_page_url,A.value=s.data.data.next_page_url,B.value=s.data.data.prev_page_url,O.value=s.data.data.from,z.value=s.data.data.to,W.value=s.data.data.links,v.value=s.data.data.current_page,U.value=!1}).catch(s=>{m.add({severity:"error",summary:t("error"),detail:t("market.loadError"),life:3e3}),U.value=!1,console.error("Error fetching markets:",s)})};fe([D,h],()=>{v.value=1,g()});const $=s=>{s>=1&&s<=P.value&&(v.value=s,g())},ee=s=>{h.value=s.value,v.value=1,g()},ae=s=>{j.value=s,x.value=!0},te=()=>{F.delete(`/api/market/${j.value}`).then(()=>{m.add({severity:"success",summary:t("success"),detail:t("market.deleteSuccess"),life:3e3}),g(),x.value=!1}).catch(s=>{m.add({severity:"error",summary:t("error"),detail:t("market.deleteError"),life:3e3}),console.error("Error deleting market:",s)})},le=()=>{F.get("/api/export/market",{responseType:"blob"}).then(s=>{const l=new Blob([s.data],{type:"text/csv"}),u=window.URL.createObjectURL(l),a=document.createElement("a");a.href=u,a.setAttribute("download","markets_export.csv"),document.body.appendChild(a),a.click(),document.body.removeChild(a),window.URL.revokeObjectURL(u)}).catch(s=>{m.add({severity:"error",summary:t("error"),detail:t("market.exportError"),life:3e3}),console.error("Error exporting markets:",s)})},se=()=>{const s=`id,Arabic Name,English Name,Top Parent / Store
`+Y.value.map(a=>`"${a.id}","${a.arabic_name}","${a.english_name}","${a.Top_Parent}",`).join(`
`),l=new Blob([s],{type:"text/csv;charset=utf-8;"}),u=document.createElement("a");if(u.download!==void 0){const a=URL.createObjectURL(l);u.setAttribute("href",a),u.setAttribute("download","market_import_example.xlsx"),u.style.visibility="hidden",document.body.appendChild(u),u.click(),document.body.removeChild(u),window.URL.revokeObjectURL(a)}},ie=()=>{w.value=!0,f.value=null},re=s=>{f.value=s.files[0]},oe=()=>{if(!f.value){m.add({severity:"warn",summary:t("warning"),detail:t("market.importNoFile"),life:3e3});return}E.value=!0;const s=new FormData;s.append("file",f.value),F.post("/api/import/markets",s).then(()=>{m.add({severity:"success",summary:t("success"),detail:t("market.importSuccess"),life:3e3}),g(),w.value=!1,f.value=null;const l=document.querySelector('.p-fileupload input[type="file"]');l&&(l.value="")}).catch(l=>{m.add({severity:"error",summary:t("error"),detail:t("market.importError"),life:3e3}),console.error("Error importing markets:",l)}).finally(()=>{E.value=!1})},ne=s=>{M.value=s.id,S.value=s.service_fee,V.value=s.service_final_price||0,C.value=!0},de=()=>{F.post(`/api/market/service/fee/${M.value}`,{service_fee:S.value,service_final_price:V.value}).then(()=>{m.add({severity:"success",summary:t("success"),detail:t("market.serviceFeeSuccess"),life:3e3}),C.value=!1,g()}).catch(s=>{m.add({severity:"error",summary:t("error"),detail:t("market.service_feeError"),life:3e3}),console.error("Error adding service fee:",s)})},ce=()=>{R.push({name:"market-create"})},ue=s=>{R.push({name:"market-update",params:{id:s}})};return ge(()=>{g()}),(s,l)=>{const u=ke("tooltip");return _(),y("div",De,[r("div",Ee,[r("div",Se,[i(e(ye),{class:"mb-4"},{start:d(()=>[r("h2",Ve,n(e(t)("market.managementTitle")),1)]),end:d(()=>[r("div",Pe,[r("span",Le,[l[14]||(l[14]=r("i",{class:"pi pi-search"},null,-1)),i(e(_e),{modelValue:D.value,"onUpdate:modelValue":l[0]||(l[0]=a=>D.value=a),placeholder:e(t)("market.search")},null,8,["modelValue","placeholder"])]),i(e(p),{label:e(t)("market.import"),icon:"pi pi-download",class:"exite",onClick:ie,"aria-label":"Import markets"},null,8,["label"]),i(e(p),{label:e(t)("market.export"),icon:"pi pi-upload",class:"exite",onClick:le,"aria-label":"Export markets"},null,8,["label"]),i(e(p),{label:e(t)("market.new"),icon:"pi pi-plus",class:"p-button-success",onClick:ce,"aria-label":"Create new market"},null,8,["label"])])]),_:1}),i(e(xe)),r("div",Re,[i(e(Ce),{ref_key:"dt",ref:H,value:I.value,loading:U.value,"data-key":"id",paginator:!1,rows:h.value,filters:J.value,totalRecords:N.value,"responsive-layout":"scroll",stripedRows:"",showGridlines:"",class:"p-datatable-sm"},{empty:d(()=>[r("div",Ne,[l[15]||(l[15]=r("i",{class:"pi pi-exclamation-circle text-2xl mb-2"},null,-1)),r("p",Te,n(e(t)("market.noData")),1)])]),loading:d(()=>[r("div",Ie,[i(e(we),{style:{width:"50px",height:"50px"},strokeWidth:"4"})])]),default:d(()=>[i(e(b),{"selection-mode":"multiple","header-style":"width: 3rem"}),i(e(b),{field:"id",header:e(t)("id"),sortable:!0,"header-style":"width:5%; min-width:5rem;"},{body:d(a=>[k(n(a.data.id),1)]),_:1},8,["header"]),i(e(b),{field:"name_en",header:e(t)("market.nameEn"),sortable:!0,"header-style":"width:14%; min-width:10rem;"},{body:d(a=>[k(n(a.data.name_en),1)]),_:1},8,["header"]),i(e(b),{field:"name_ar",header:e(t)("market.nameAr"),sortable:!0,"header-style":"width:14%; min-width:10rem;"},{body:d(a=>[k(n(a.data.name_ar),1)]),_:1},8,["header"]),i(e(b),{field:"parent.name_en",header:e(t)("market.parent"),sortable:!0,"header-style":"width:14%; min-width:10rem;"},{body:d(a=>{var c;return[k(n(((c=a.data.parent)==null?void 0:c.name_en)||e(t)("market.noParent")),1)]}),_:1},8,["header"]),i(e(b),{field:"store.name_en",header:e(t)("market.store"),sortable:!0,"header-style":"width:14%; min-width:10rem;"},{body:d(a=>{var c;return[k(n(((c=a.data.store)==null?void 0:c.name_en)||e(t)("market.noStore")),1)]}),_:1},8,["header"]),i(e(b),{field:"store.service_fee",header:e(t)("market.serviceFee"),sortable:!0,"header-style":"width:10%; min-width:10rem;"},{body:d(a=>{var c;return[k(n(((c=a.data)==null?void 0:c.service_fee)||0)+" "+n(s.$t("currencyLabel")),1)]}),_:1},8,["header"]),i(e(b),{field:"store.service_final_price",header:e(t)("market.serviceFinalPrice"),sortable:!0,"header-style":"width:10%; min-width:10rem;"},{body:d(a=>{var c;return[k(n(((c=a.data)==null?void 0:c.service_final_price)||0)+" "+n(s.$t("currencyLabel")),1)]}),_:1},8,["header"]),i(e(b),{header:e(t)("actions"),"header-style":"width:18rem;"},{body:d(a=>[L(i(e(p),{icon:"pi pi-pencil",class:"p-detail",onClick:c=>ue(a.data.id),"aria-label":"Edit market"},null,8,["onClick"]),[[u,e(t)("edit"),void 0,{top:!0}]]),L(i(e(p),{icon:"pi pi-trash",class:"p-delete",onClick:c=>ae(a.data.id),"aria-label":"Delete market"},null,8,["onClick"]),[[u,e(t)("delete"),void 0,{top:!0}]]),L(i(e(p),{icon:"pi pi-money-bill",class:"p-button-info ml-2",onClick:c=>ne(a.data),"aria-label":"Add service fee"},null,8,["onClick"]),[[u,e(t)("market.addServiceFee"),void 0,{top:!0}]]),L(i(e(p),{icon:"pi pi-truck",class:"p-button-warning mx-1",onClick:c=>Z(a.data.id)},null,8,["onClick"]),[[u,e(t)("store.shippingSettings"),void 0,{top:!0}]])]),_:1},8,["header"])]),_:1},8,["value","loading","rows","filters","totalRecords"]),r("div",je,[r("div",Me,[r("span",Ae,n(e(t)("show"))+" "+n(O.value)+" "+n(e(t)("to"))+" "+n(z.value)+" "+n(e(t)("from"))+" "+n(N.value),1)]),r("div",Be,[r("button",{class:"p-paginator-first p-paginator-element p-link",disabled:v.value===1,onClick:l[1]||(l[1]=a=>$(1)),"aria-label":"First page"},l[16]||(l[16]=[r("span",{class:"p-paginator-icon pi pi-angle-double-left"},null,-1)]),8,Oe),r("button",{class:"p-paginator-prev p-paginator-element p-link",disabled:!B.value,onClick:l[2]||(l[2]=a=>$(v.value-1)),"aria-label":"Previous page"},l[17]||(l[17]=[r("span",{class:"p-paginator-icon pi pi-angle-left"},null,-1)]),8,ze),(_(!0),y(q,null,he(W.value,(a,c)=>(_(),y(q,{key:c},[a.label&&!isNaN(parseInt(a.label))?(_(),y("button",{key:0,class:$e(["p-paginator-page p-paginator-element p-link",{"p-highlight":a.active}]),onClick:la=>$(parseInt(a.label)),"aria-label":`Page ${a.label}`},n(a.label),11,We)):a.label==="..."?(_(),y("span",qe,"...")):G("",!0)],64))),128)),r("button",{class:"p-paginator-next p-paginator-element p-link",disabled:!A.value,onClick:l[3]||(l[3]=a=>$(v.value+1)),"aria-label":"Next page"},l[18]||(l[18]=[r("span",{class:"p-paginator-icon pi pi-angle-right"},null,-1)]),8,Ge),r("button",{class:"p-paginator-last p-paginator-element p-link",disabled:v.value===P.value,onClick:l[4]||(l[4]=a=>$(P.value)),"aria-label":"Last page"},l[19]||(l[19]=[r("span",{class:"p-paginator-icon pi pi-angle-double-right"},null,-1)]),8,Qe),i(e(Fe),{modelValue:h.value,"onUpdate:modelValue":l[5]||(l[5]=a=>h.value=a),options:[5,10,20,30],onChange:ee,class:"ml-2",style:{width:"80px"},"aria-label":"Rows per page"},null,8,["modelValue"])])])]),i(e(T),{visible:x.value,"onUpdate:visible":l[7]||(l[7]=a=>x.value=a),style:{width:"450px"},header:e(t)("market.deleteConfirmTitle"),modal:!0},{footer:d(()=>[i(e(p),{label:e(t)("cancel"),icon:"pi pi-times",class:"p-button-text",onClick:l[6]||(l[6]=a=>x.value=!1),"aria-label":"Cancel delete"},null,8,["label"]),i(e(p),{label:e(t)("yes"),icon:"pi pi-check",class:"p-button-text p-button-danger",onClick:te,"aria-label":"Confirm delete"},null,8,["label"])]),default:d(()=>[r("div",He,[l[20]||(l[20]=r("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem",color:"var(--red-500)"}},null,-1)),r("span",null,n(e(t)("market.deleteConfirmMessage")),1)])]),_:1},8,["visible","header"]),i(e(T),{visible:w.value,"onUpdate:visible":l[9]||(l[9]=a=>w.value=a),style:{width:"500px"},header:e(t)("market.importInstructions"),modal:!0},{footer:d(()=>[i(e(p),{label:e(t)("cancel"),icon:"pi pi-times",class:"p-button-text",onClick:l[8]||(l[8]=a=>w.value=!1),"aria-label":"Cancel import"},null,8,["label"]),i(e(p),{label:e(t)("market.import"),icon:"pi pi-check",class:"p-button-success",onClick:oe,disabled:!f.value,loading:E.value,"aria-label":"Import markets"},null,8,["label","disabled","loading"])]),default:d(()=>[r("div",Je,[r("div",null,[i(e(p),{label:e(t)("market.downloadExample"),icon:"pi pi-download",class:"p-button-outlined",onClick:se,"aria-label":"Download example CSV"},null,8,["label"])]),i(e(Ue),{mode:"basic",name:"file",accept:".xlsx,.xls,.csv",maxFileSize:1e7,chooseLabel:e(t)("market.chooseFile"),onSelect:re,auto:!1,disabled:E.value,class:"mb-3"},null,8,["chooseLabel","disabled"]),f.value?(_(),y("div",Ke,[r("p",Xe,n(e(t)("selectedFile"))+": "+n(f.value.name),1)])):G("",!0)])]),_:1},8,["visible","header"]),i(e(T),{visible:C.value,"onUpdate:visible":l[13]||(l[13]=a=>C.value=a),style:{width:"450px"},header:e(t)("market.addServiceFee"),modal:!0},{footer:d(()=>[i(e(p),{label:e(t)("cancel"),icon:"pi pi-times",class:"p-button-text",onClick:l[12]||(l[12]=a=>C.value=!1),"aria-label":"Cancel"},null,8,["label"]),i(e(p),{label:e(t)("save"),icon:"pi pi-check",class:"p-button-success",onClick:de,"aria-label":"Save service fee"},null,8,["label"])]),default:d(()=>[r("div",Ye,[r("p",Ze,n(e(t)("market.serviceFee")),1),i(e(Q),{class:"w-full",id:"service_fee",modelValue:S.value,"onUpdate:modelValue":l[10]||(l[10]=a=>S.value=a),min:0,step:.01,mode:"decimal",minFractionDigits:0,maxFractionDigits:2},null,8,["modelValue"]),r("p",ea,n(e(t)("market.serviceFinalPrice")),1),i(e(Q),{class:"w-full",id:"service_final_price",modelValue:V.value,"onUpdate:modelValue":l[11]||(l[11]=a=>V.value=a),min:0,step:.01,mode:"decimal",minFractionDigits:0,maxFractionDigits:2},null,8,["modelValue"])])]),_:1},8,["visible","header"])])])])}}},ia=pe(aa,[["__scopeId","data-v-6d8f168e"]]);export{ia as default};
