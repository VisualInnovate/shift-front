import{_ as Le,l as Be,a as De,u as Re,r,x as ie,o as Te,a1 as de,e as _,h as y,g as d,i as o,w as n,j as e,t as u,F as ne,m as Ie,b as m,U as Ne,V as j,W as p,B as L,a3 as je,k as Me,a4 as b,v as B,ad as ze,ae as ce,f as ue,s as pe,n as M,a5 as Oe,A as Qe,T as q,af as ve}from"./index-fdf8dab7.js";const We={class:"grid"},qe={class:"col-12"},Ae={class:"card p-4 shadow-2 border-round"},Ge={class:"text-2xl font-bold"},Ke={class:"flex gap-2 align-items-center"},He={class:"p-input-icon-left"},Je={class:"card shadow-1 surface-0"},Xe={class:"flex justify-content-center align-items-center"},Ye={class:"flex justify-content-center align-items-center"},Ze={class:"text-center py-4"},ea={class:"text-xl"},aa={class:"p-paginator p-component p-unselectable-text p-paginator-bottom"},ta={class:"p-paginator-left-content"},la={class:"p-paginator-current"},sa={class:"p-paginator-right-content"},oa=["disabled"],ra=["disabled"],ia=["onClick"],da={key:1,class:"p-paginator-dots"},na=["disabled"],ca=["disabled"],ua={class:"flex align-items-center justify-content-center"},pa={class:"flex flex-column gap-3"},va={key:0,class:"mt-2"},ma={class:"font-semibold"},ba={class:"flex flex-column gap-3"},fa={__name:"index",setup(_a){const A=Be(),c=De(),{t:a}=Re(),D=r(!0),G=r([]),x=r(!1),K=r(null);r(null),r({});const k=r("");r(null);const w=r(!1),g=r(null),z=r(!1),H=r([]),J=r([]),X=r([]),S=r(null),C=r(null),V=r(null),Y=r(""),Z=r(""),R=r(localStorage.getItem("appLang")||"en"),U=r(!1),$=r(null),O=r(!1),T=r({}),I=r({}),f=r(1),ee=r(0),F=r(10),N=r(0),me=r(""),be=r(""),ae=r(""),te=r(""),le=r(0),se=r(0),oe=r([]),Q=async()=>{try{const s=await m.get("/api/category",{params:{search:Y.value||void 0}}),l=R.value;H.value=s.data.data.data.map(i=>({label:l==="en"?i.name_en:i.name_ar,value:i.id}))}catch{c.add({severity:"error",summary:a("error"),detail:a("category.loadError"),life:3e3})}},re=async()=>{try{const s=await m.get("/api/store"),l=R.value;J.value=s.data.data.data.map(i=>({label:l==="en"?i.name_en:i.name_ar,value:i.id}))}catch{c.add({severity:"error",summary:a("error"),detail:a("store.loadError"),life:3e3})}},W=async()=>{try{const s=await m.get("/api/market",{params:{search:Z.value||void 0}}),l=R.value;X.value=s.data.data.data.map(i=>({label:l==="en"?i.name_en:i.name_ar,value:i.id}))}catch{c.add({severity:"error",summary:a("error"),detail:a("market.loadError"),life:3e3})}},h=()=>{D.value=!0,m.get("/api/product",{params:{page:f.value,limit:F.value,search:k.value||void 0,category_id:S.value||void 0,store_id:C.value||void 0,market_id:V.value||void 0}}).then(s=>{G.value=s.data.data.data,ee.value=s.data.data.total,N.value=s.data.data.last_page,me.value=s.data.data.first_page_url,be.value=s.data.data.last_page_url,ae.value=s.data.data.next_page_url,te.value=s.data.data.prev_page_url,le.value=s.data.data.from,se.value=s.data.data.to,oe.value=s.data.data.links,D.value=!1}).catch(s=>{c.add({severity:"error",summary:a("error"),detail:a("product.loadError"),life:3e3}),D.value=!1,console.error("Error fetching products:",s)})};ie([k,F,S,C,V],()=>{f.value=1,h()}),ie(R,()=>{Q(),re(),W()});const fe=s=>{Y.value=s.value,Q()},_e=s=>{Z.value=s.value,W()},E=s=>{s>=1&&s<=N.value&&(f.value=s,h())},ge=s=>{F.value=s.value,f.value=1,h()},he=s=>{K.value=s,x.value=!0},ye=()=>{m.delete(`/api/product/${K.value}`).then(()=>{c.add({severity:"success",summary:a("success"),detail:a("product.deleteSuccess"),life:3e3}),h(),x.value=!1}).catch(()=>{c.add({severity:"error",summary:a("error"),detail:a("product.deleteError"),life:3e3})})},xe=()=>{const l=`/api/export/products?${new URLSearchParams({search:k.value||"",category_id:S.value||"",store_id:C.value||"",market_id:V.value||""}).toString()}`;m.get(l,{responseType:"blob"}).then(i=>{const v=new Blob([i.data],{type:"text/csv"}),t=document.createElement("a");t.href=URL.createObjectURL(v),t.download="products_export.csv",t.click(),c.add({severity:"success",summary:a("success"),detail:a("product.exportSuccess"),life:3e3})}).catch(()=>{c.add({severity:"error",summary:a("error"),detail:a("product.exportError"),life:3e3})})},ke=()=>{const s=`store_id,category_id,market_id,name_en,name_ar,sku,brand_id,sub_name_en,sub_name_ar,description_en,description_ar,base_price,cost_price,tax
1,1,1,Demo Product,منتج تجريبي,SKU001,1,Sub Demo,تجريبي فرعي,Description,وصف,15.50,10.00,0.05`,l=new Blob([s],{type:"text/csv"}),i=document.createElement("a");i.href=URL.createObjectURL(l),i.download="product_import_example.csv",i.click()},we=()=>{const s=`id,price,cost_price
1,16.00,10.50
2,23.50,15.00`,l=new Blob([s],{type:"text/csv"}),i=document.createElement("a");i.href=URL.createObjectURL(l),i.download="product_price_update_example.csv",i.click()},Se=s=>{g.value=s.files[0]},Ce=s=>{$.value=s.files[0]},Ve=()=>{if(!g.value)return c.add({severity:"error",detail:a("validation.fileRequired"),life:3e3});z.value=!0;const s=new FormData;s.append("file",g.value),m.post("/api/import/products",s).then(()=>{c.add({severity:"success",detail:a("product.importSuccess"),life:3e3}),h(),w.value=!1,g.value=null}).catch(()=>c.add({severity:"error",detail:a("product.importError"),life:3e3})).finally(()=>z.value=!1)},Ue=()=>{if(!$.value)return c.add({severity:"error",detail:a("validation.fileRequired"),life:3e3});O.value=!0;const s=new FormData;s.append("file",$.value),m.post("/api/product/update/prices",s).then(()=>{c.add({severity:"success",detail:a("product.priceUpdateSuccess"),life:3e3}),h(),U.value=!1,$.value=null}).catch(()=>c.add({severity:"error",detail:a("product.priceUpdateError"),life:3e3})).finally(()=>O.value=!1)},$e=async s=>{const l=s.id,i=s.is_free_shipping,v=i===1?0:1;T.value[l]=!0;try{await m.post(`/api/product/is/free/shipping/${l}`,{is_free_shipping:v}),s.is_free_shipping=v,c.add({severity:"success",detail:a(v===1?"product.freeShippingEnabled":"product.freeShippingDisabled"),life:3e3})}catch{s.is_free_shipping=i,c.add({severity:"error",detail:a("product.freeShippingUpdateError"),life:3e3})}finally{T.value[l]=!1}},Fe=async s=>{const l=s.id,i=s.is_best_seller?1:0,v=i===1?0:1;I.value[l]=!0;try{await m.get(`/api/product/update/best-sellers/${l}`),s.is_best_seller=v===1,c.add({severity:"success",summary:a("success"),detail:v===1?"Product marked as Best Seller":"Product removed from Best Sellers",life:3e3})}catch(t){s.is_best_seller=i===1,c.add({severity:"error",summary:a("error"),detail:"Failed to update Best Seller status",life:3e3}),console.error("Error updating best seller:",t)}finally{I.value[l]=!1}},Ee=()=>A.push({name:"product-create"}),Pe=s=>A.push({name:"product-update",params:{id:s}});return Te(()=>{Promise.all([Q(),re(),W(),h()])}),(s,l)=>{const i=de("can"),v=de("tooltip");return _(),y("div",We,[d("div",qe,[d("div",Ae,[o(e(je),{class:"mb-4"},{start:n(()=>[d("h2",Ge,u(e(a)("product.managementTitle")),1)]),end:n(()=>[d("div",Ke,[d("span",He,[l[17]||(l[17]=d("i",{class:"pi pi-search"},null,-1)),o(e(Ne),{modelValue:k.value,"onUpdate:modelValue":l[0]||(l[0]=t=>k.value=t),placeholder:e(a)("product.search")},null,8,["modelValue","placeholder"])]),o(e(j),{modelValue:S.value,"onUpdate:modelValue":l[1]||(l[1]=t=>S.value=t),options:H.value,optionLabel:"label",optionValue:"value",placeholder:e(a)("product.categoryFilter"),class:"w-12rem",showClear:!0,filter:"",onFilter:fe},null,8,["modelValue","options","placeholder"]),o(e(j),{modelValue:C.value,"onUpdate:modelValue":l[2]||(l[2]=t=>C.value=t),options:J.value,optionLabel:"label",optionValue:"value",placeholder:e(a)("product.storeFilter"),class:"w-12rem",showClear:!0},null,8,["modelValue","options","placeholder"]),o(e(j),{modelValue:V.value,"onUpdate:modelValue":l[3]||(l[3]=t=>V.value=t),options:X.value,optionLabel:"label",optionValue:"value",placeholder:e(a)("product.marketFilter"),class:"w-12rem",showClear:!0,filter:"",onFilter:_e},null,8,["modelValue","options","placeholder"]),o(e(p),{label:e(a)("product.updatePrice"),icon:"pi pi-dollar",class:"p-button-warning p-button-outlined",onClick:l[4]||(l[4]=t=>U.value=!0)},null,8,["label"]),o(e(p),{label:e(a)("product.import"),icon:"pi pi-download",onClick:l[5]||(l[5]=t=>w.value=!0)},null,8,["label"]),o(e(p),{label:e(a)("product.export"),icon:"pi pi-upload",onClick:xe},null,8,["label"]),L(o(e(p),{label:e(a)("product.new"),icon:"pi pi-plus",class:"p-button-success",onClick:Ee},null,8,["label"]),[[i,"create products"]])])]),_:1}),o(e(Me)),d("div",Je,[o(e(Oe),{value:G.value,loading:D.value,"data-key":"id","responsive-layout":"scroll",stripedRows:"",showGridlines:"",class:"p-datatable-sm"},{empty:n(()=>[d("div",Ze,[d("p",ea,u(e(a)("product.noData")),1)])]),default:n(()=>[o(e(b),{field:"id",header:e(a)("id"),sortable:!0,"header-style":"width:6%;"},{body:n(t=>[B(u(t.data.id),1)]),_:1},8,["header"]),o(e(b),{field:"name_ar",header:e(a)("product.nameAr"),sortable:!0},{body:n(t=>[B(u(t.data.name_ar),1)]),_:1},8,["header"]),o(e(b),{field:"name_en",header:e(a)("product.nameEn"),sortable:!0},{body:n(t=>[B(u(t.data.name_en),1)]),_:1},8,["header"]),o(e(b),{field:"base_price",header:e(a)("product.basePrice")},{body:n(t=>[B(u(t.data.base_price),1)]),_:1},8,["header"]),o(e(b),{header:e(a)("product.Price after discount")},{body:n(t=>[B(u(t.data.base_price-t.data.total_discounts_value),1)]),_:1},8,["header"]),o(e(b),{field:"is_displayed",header:e(a)("product.isDisplayed")},{body:n(t=>[o(e(ze),{value:t.data.is_displayed?e(a)("yes"):e(a)("no"),severity:t.data.is_displayed?"success":"info"},null,8,["value","severity"])]),_:1},8,["header"]),o(e(b),{header:e(a)("product.freeShipping")},{body:n(t=>[d("div",Xe,[L(o(e(ce),{"model-value":t.data.is_free_shipping===1,disabled:T.value[t.data.id],"onUpdate:modelValue":P=>$e(t.data)},null,8,["model-value","disabled","onUpdate:modelValue"]),[[v,t.data.is_free_shipping===1?e(a)("product.freeShipping"):e(a)("product.notFreeShipping"),void 0,{top:!0}]]),T.value[t.data.id]?(_(),ue(e(pe),{key:0,style:{width:"20px",height:"20px"},class:"ml-2",strokeWidth:"5"})):M("",!0)])]),_:1},8,["header"]),o(e(b),{header:e(a)("product.bestSeller")||"Best Seller"},{body:n(t=>[d("div",Ye,[L(o(e(ce),{"model-value":t.data.is_best_seller,disabled:I.value[t.data.id],"onUpdate:modelValue":P=>Fe(t.data)},null,8,["model-value","disabled","onUpdate:modelValue"]),[[v,t.data.is_best_seller?"Best Seller":"Not Best Seller",void 0,{top:!0}]]),I.value[t.data.id]?(_(),ue(e(pe),{key:0,style:{width:"20px",height:"20px"},class:"ml-2",strokeWidth:"5"})):M("",!0)])]),_:1},8,["header"]),o(e(b),{header:e(a)("actions")},{body:n(t=>[L(o(e(p),{icon:"pi pi-pencil",class:"p-detail",onClick:P=>Pe(t.data.id)},null,8,["onClick"]),[[i,"edit products"],[v,e(a)("edit"),void 0,{top:!0}]]),L(o(e(p),{icon:"pi pi-trash mx-2",class:"p-delete",onClick:P=>he(t.data.id)},null,8,["onClick"]),[[i,"delete products"],[v,e(a)("delete"),void 0,{top:!0}]])]),_:1},8,["header"])]),_:1},8,["value","loading"]),d("div",aa,[d("div",ta,[d("span",la,u(e(a)("show"))+" "+u(le.value)+" "+u(e(a)("to"))+" "+u(se.value)+" "+u(e(a)("from"))+" "+u(ee.value),1)]),d("div",sa,[d("button",{class:"p-paginator-first p-link",disabled:f.value===1,onClick:l[6]||(l[6]=t=>E(1))},l[18]||(l[18]=[d("span",{class:"pi pi-angle-double-left"},null,-1)]),8,oa),d("button",{class:"p-paginator-prev p-link",disabled:!te.value,onClick:l[7]||(l[7]=t=>E(f.value-1))},l[19]||(l[19]=[d("span",{class:"pi pi-angle-left"},null,-1)]),8,ra),(_(!0),y(ne,null,Ie(oe.value,(t,P)=>(_(),y(ne,{key:P},[t.label&&!isNaN(parseInt(t.label))?(_(),y("button",{key:0,class:Qe(["p-paginator-page p-link",{"p-highlight":t.active}]),onClick:ga=>E(parseInt(t.label))},u(t.label),11,ia)):t.label==="..."?(_(),y("span",da,"...")):M("",!0)],64))),128)),d("button",{class:"p-paginator-next p-link",disabled:!ae.value,onClick:l[8]||(l[8]=t=>E(f.value+1))},l[20]||(l[20]=[d("span",{class:"pi pi-angle-right"},null,-1)]),8,na),d("button",{class:"p-paginator-last p-link",disabled:f.value===N.value,onClick:l[9]||(l[9]=t=>E(N.value))},l[21]||(l[21]=[d("span",{class:"pi pi-angle-double-right"},null,-1)]),8,ca),o(e(j),{modelValue:F.value,"onUpdate:modelValue":l[10]||(l[10]=t=>F.value=t),options:[5,10,20,30],onChange:ge,class:"ml-2",style:{width:"80px"}},null,8,["modelValue"])])])]),o(e(q),{visible:x.value,"onUpdate:visible":l[12]||(l[12]=t=>x.value=t),style:{width:"450px"},header:e(a)("product.deleteConfirmTitle"),modal:!0},{footer:n(()=>[o(e(p),{label:e(a)("no"),icon:"pi pi-times",class:"p-button-text",onClick:l[11]||(l[11]=t=>x.value=!1)},null,8,["label"]),o(e(p),{label:e(a)("yes"),icon:"pi pi-check",class:"p-button-text p-button-danger",onClick:ye},null,8,["label"])]),default:n(()=>[d("div",ua,[l[22]||(l[22]=d("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem",color:"var(--red-500)"}},null,-1)),d("span",null,u(e(a)("product.deleteConfirmMessage")),1)])]),_:1},8,["visible","header"]),o(e(q),{visible:w.value,"onUpdate:visible":l[14]||(l[14]=t=>w.value=t),style:{width:"450px"},header:e(a)("product.importTitle"),modal:!0},{footer:n(()=>[o(e(p),{label:e(a)("cancel"),icon:"pi pi-times",class:"p-button-text",onClick:l[13]||(l[13]=t=>w.value=!1)},null,8,["label"]),o(e(p),{label:e(a)("product.importButton"),icon:"pi pi-check",loading:z.value,disabled:!g.value,onClick:Ve},null,8,["label","loading","disabled"])]),default:n(()=>[d("div",pa,[o(e(p),{label:e(a)("product.downloadExample"),icon:"pi pi-download",class:"p-button-outlined",onClick:ke},null,8,["label"]),o(e(ve),{mode:"basic","custom-upload":!0,onSelect:Se,maxFileSize:1e7,chooseLabel:"Select File"}),g.value?(_(),y("div",va,[d("p",ma,u(e(a)("selectedFile"))+": "+u(g.value.name),1)])):M("",!0)])]),_:1},8,["visible","header"]),o(e(q),{visible:U.value,"onUpdate:visible":l[16]||(l[16]=t=>U.value=t),style:{width:"450px"},header:e(a)("product.updatePriceTitle"),modal:!0},{footer:n(()=>[o(e(p),{label:e(a)("cancel"),icon:"pi pi-times",class:"p-button-text",onClick:l[15]||(l[15]=t=>U.value=!1)},null,8,["label"]),o(e(p),{label:e(a)("product.updatePriceButton"),icon:"pi pi-check",loading:O.value,disabled:!$.value,onClick:Ue},null,8,["label","loading","disabled"])]),default:n(()=>[d("div",ba,[o(e(p),{label:e(a)("product.downloadPriceExample"),icon:"pi pi-download",class:"p-button-outlined p-button-warning",onClick:we},null,8,["label"]),o(e(ve),{mode:"basic","custom-upload":!0,onSelect:Ce,maxFileSize:1e7,chooseLabel:"Select Price File"})])]),_:1},8,["visible","header"])])])])}}},ya=Le(fa,[["__scopeId","data-v-fe8156ba"]]);export{ya as default};
