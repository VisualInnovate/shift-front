import{_ as le,u as ne,j as ie,G as de,r as l,m as re,q as ce,o as ue,n as u,a0 as z,a as m,c as y,f as a,h as i,w as r,y as k,b as pe,t as d,e as n,F as A,d as ve,a1 as _e,i as G,p as T,x as me,g as ge}from"./index-22d4798b.js";const be={class:"grid"},fe={class:"col-12"},he={class:"card p-4 shadow-2 border-round"},xe={class:"text-2xl font-bold"},ye={class:"flex gap-2"},ke={class:"p-input-icon-left"},Ce={class:"card shadow-1 surface-0"},we={class:"text-center py-4"},De={class:"text-xl"},Te={class:"flex justify-content-center align-items-center py-4"},Pe={class:"p-paginator p-component p-unselectable-text p-paginator-bottom"},Ve={class:"p-paginator-left-content"},Ne={class:"p-paginator-current"},$e={class:"p-paginator-right-content"},Se=["disabled"],Be=["disabled"],Ue=["onClick"],Ie={key:1,class:"p-paginator-dots"},Me=["disabled"],Re=["disabled"],Ee={class:"flex align-items-center justify-content-center"},Fe={__name:"index",setup(je){const N=ne(),{t:o}=ie(),P=de(),C=l(!0),$=l(""),S=l(null),g=l(!1);l(null);const B=l(null),U=l({}),w=l(""),p=l(1),V=l(0),b=l(5),D=l(0),L=l(""),q=l(""),I=l(""),M=l(""),R=l(0),E=l(0),F=l([]),O=()=>{B.value.exportCSV()},Q=s=>{$.value=s,g.value=!0},W=()=>{G.delete(`/api/discount/${$.value}`).then(()=>{f(),g.value=!1,P.add({severity:"success",summary:o("success"),detail:o("discount.deleteSuccess"),life:3e3})}).catch(()=>{P.add({severity:"error",summary:o("error"),detail:o("discount.deleteError"),life:3e3})})},H=()=>{U.value={global:{value:null,matchMode:_e.CONTAINS}}};re(()=>{H()});const f=()=>{C.value=!0,G.get("/api/discount",{params:{page:p.value,limit:b.value,search:w.value}}).then(s=>{S.value=s.data.data.data,V.value=s.data.data.total,D.value=s.data.data.last_page,L.value=s.data.data.first_page_url,q.value=s.data.data.last_page_url,I.value=s.data.data.next_page_url,M.value=s.data.data.prev_page_url,R.value=s.data.data.from,E.value=s.data.data.to,F.value=s.data.data.links,C.value=!1}).catch(s=>{C.value=!1,P.add({severity:"error",summary:o("error"),detail:o("discount.loadError"),life:3e3}),console.error("Error fetching discounts:",s)})};ce(w,s=>{p.value=1,f()});const h=s=>{s>=1&&s<=D.value&&(p.value=s,f())},J=s=>{b.value=s.value,p.value=1,f()};ue(()=>{f()});const K=()=>{N.push({name:"discount-create"})},X=s=>{N.push({name:"discount-update",params:{id:s}})};return(s,e)=>{const Y=u("InputText"),v=u("Button"),Z=u("Toolbar"),ee=u("Toast"),_=u("Column"),te=u("ProgressSpinner"),ae=u("DataTable"),oe=u("Dropdown"),se=u("Dialog"),x=z("can"),j=z("tooltip");return m(),y("div",be,[a("div",fe,[a("div",he,[i(Z,{class:"mb-4"},{start:r(()=>[a("h2",xe,d(n(o)("discount.managementTitle")),1)]),end:r(()=>[a("div",ye,[a("span",ke,[e[8]||(e[8]=a("i",{class:"pi pi-search"},null,-1)),i(Y,{modelValue:w.value,"onUpdate:modelValue":e[0]||(e[0]=t=>w.value=t),placeholder:n(o)("discount.search")},null,8,["modelValue","placeholder"])]),k(i(v,{label:n(o)("discount.export"),icon:"pi pi-upload",class:"p-export",onClick:O},null,8,["label"]),[[x,"list discounts"]]),k(i(v,{label:n(o)("discount.new"),icon:"pi pi-plus",class:"p-button-success",onClick:K},null,8,["label"]),[[x,"create discounts"]])])]),_:1}),i(ee),a("div",Ce,[k((m(),pe(ae,{ref_key:"dt",ref:B,value:S.value,loading:C.value,"data-key":"id",paginator:!1,rows:b.value,filters:U.value,totalRecords:V.value,"responsive-layout":"scroll",stripedRows:"",showGridlines:"",class:"p-datatable-sm"},{empty:r(()=>[a("div",we,[e[9]||(e[9]=a("i",{class:"pi pi-exclamation-circle text-2xl mb-2"},null,-1)),a("p",De,d(n(o)("discount.noData")),1)])]),loading:r(()=>[a("div",Te,[i(te,{style:{width:"50px",height:"50px"},strokeWidth:"4"})])]),default:r(()=>[i(_,{"selection-mode":"multiple","header-style":"width: 3rem"}),i(_,{field:"en_name",header:n(o)("product.nameEn"),sortable:!0},{body:r(t=>{var c;return[T(d((c=t.data.products[0])==null?void 0:c.name_en),1)]}),_:1},8,["header"]),i(_,{field:"name_ar",header:n(o)("product.nameAr"),sortable:!0},{body:r(t=>{var c;return[T(d((c=t.data.products[0])==null?void 0:c.name_ar),1)]}),_:1},8,["header"]),i(_,{field:"discount_value",header:n(o)("product.basePrice"),sortable:!0},{body:r(t=>[T(d(t.data.discount_value),1)]),_:1},8,["header"]),i(_,{field:"expires_at",header:n(o)("discount.expires_at"),sortable:!0},{body:r(t=>[T(d(t.data.expires_at),1)]),_:1},8,["header"]),i(_,{header:n(o)("actions"),headerStyle:"width: 12rem"},{body:r(t=>[k(i(v,{icon:"pi pi-pencil",class:"p-detail",onClick:c=>X(t.data.id)},null,8,["onClick"]),[[x,"edit discounts"],[j,n(o)("edit"),void 0,{top:!0}]]),k(i(v,{icon:"pi pi-trash",class:"p-delete mx-2",onClick:c=>Q(t.data.id)},null,8,["onClick"]),[[x,"delete discounts"],[j,n(o)("delete"),void 0,{top:!0}]])]),_:1},8,["header"])]),_:1},8,["value","loading","rows","filters","totalRecords"])),[[x,"list discounts"]]),a("div",Pe,[a("div",Ve,[a("span",Ne,d(n(o)("show"))+" "+d(R.value)+" "+d(n(o)("to"))+" "+d(E.value)+" "+d(n(o)("from"))+" "+d(V.value),1)]),a("div",$e,[a("button",{class:"p-paginator-first p-paginator-element p-link",disabled:p.value===1,onClick:e[1]||(e[1]=t=>h(1))},e[10]||(e[10]=[a("span",{class:"p-paginator-icon pi pi-angle-double-left"},null,-1)]),8,Se),a("button",{class:"p-paginator-prev p-paginator-element p-link",disabled:!M.value,onClick:e[2]||(e[2]=t=>h(p.value-1))},e[11]||(e[11]=[a("span",{class:"p-paginator-icon pi pi-angle-left"},null,-1)]),8,Be),(m(!0),y(A,null,ve(F.value,(t,c)=>(m(),y(A,{key:c},[t.label&&!isNaN(t.label)?(m(),y("button",{key:0,class:me(["p-paginator-page p-paginator-element p-link",{"p-highlight":t.active}]),onClick:ze=>h(parseInt(t.label))},d(t.label),11,Ue)):t.label==="..."?(m(),y("span",Ie,"...")):ge("",!0)],64))),128)),a("button",{class:"p-paginator-next p-paginator-element p-link",disabled:!I.value,onClick:e[3]||(e[3]=t=>h(p.value+1))},e[12]||(e[12]=[a("span",{class:"p-paginator-icon pi pi-angle-right"},null,-1)]),8,Me),a("button",{class:"p-paginator-last p-paginator-element p-link",disabled:p.value===D.value,onClick:e[4]||(e[4]=t=>h(D.value))},e[13]||(e[13]=[a("span",{class:"p-paginator-icon pi pi-angle-double-right"},null,-1)]),8,Re),i(oe,{filter:"",modelValue:b.value,"onUpdate:modelValue":e[5]||(e[5]=t=>b.value=t),options:[5,10,20,30],optionLabel:"",onChange:J,class:"ml-2",style:{width:"80px"}},null,8,["modelValue"])])])]),i(se,{visible:g.value,"onUpdate:visible":e[7]||(e[7]=t=>g.value=t),style:{width:"450px"},header:n(o)("discount.deleteConfirmTitle"),modal:!0},{footer:r(()=>[i(v,{label:n(o)("no"),icon:"pi pi-times",class:"p-button-text",onClick:e[6]||(e[6]=t=>g.value=!1)},null,8,["label"]),i(v,{label:n(o)("yes"),icon:"pi pi-check",class:"p-button-text p-button-danger",onClick:W},null,8,["label"])]),default:r(()=>[a("div",Ee,[e[14]||(e[14]=a("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem",color:"var(--red-500)"}},null,-1)),a("span",null,d(n(o)("discount.deleteConfirmMessage")),1)])]),_:1},8,["visible","header"])])])])}}},Ge=le(Fe,[["__scopeId","data-v-f5c7e55c"]]);export{Ge as default};
