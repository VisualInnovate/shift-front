import{u as Z,l as ee,a as te,r as i,x as ae,q as le,o as se,a1 as L,e as p,h as C,g as s,i as r,w as d,j as e,B as w,f as S,t as n,F as W,m as oe,a2 as re,b as T,U as ie,W as v,a3 as ne,k as de,s as ue,a4 as h,v as D,ad as ce,n as M,a5 as pe,A as ve,V as me,T as q}from"./index-eed06101.js";const ge={class:"grid"},fe={class:"col-12"},be={class:"card p-4 shadow-2 border-round"},he={class:"text-2xl font-bold"},ye={class:"flex gap-2"},xe={class:"p-input-icon-left"},_e={class:"card shadow-1 surface-0"},ke={class:"flex gap-2"},Ce={class:"text-center py-4"},we={class:"text-xl"},$e={class:"flex justify-content-center align-items-center py-4"},je={class:"p-paginator p-component p-unselectable-text p-paginator-bottom"},Ve={class:"p-paginator-left-content"},Re={class:"p-paginator-current"},Ne={class:"p-paginator-right-content flex align-items-center gap-3"},Se=["disabled"],Te=["disabled"],De=["onClick"],Me={key:1,class:"p-paginator-dots"},Be=["disabled"],Ee=["disabled"],Oe={class:"flex align-items-center justify-content-center gap-3"},Ue={class:"flex align-items-center justify-content-center"},Ae={__name:"index",setup(Fe){const{t:a}=Z(),G=ee(),y=te(),g=i(!0),P=i(""),$=i(!1),x=i(!1),j=i(null),B=i(null);i(null);const E=i(null),O=i({}),V=i(""),u=i(1),R=i(0),f=i(10),_=i(0),U=i(0),F=i(0),I=i([]),Q=()=>{O.value={global:{value:null,matchMode:re.CONTAINS}}},b=()=>{g.value=!0,T.get("/api/order",{params:{page:u.value,limit:f.value,search:V.value||void 0}}).then(o=>{B.value=o.data.data.data,R.value=o.data.data.total,_.value=o.data.data.last_page,U.value=o.data.data.from,F.value=o.data.data.to,I.value=o.data.data.links,g.value=!1}).catch(o=>{y.add({severity:"error",summary:a("error"),detail:a("order.loadError"),life:3e3}),g.value=!1,console.error("Error fetching data:",o)})};ae([V,f],()=>{u.value=1,b()});const k=o=>{o>=1&&o<=_.value&&(u.value=o,b())},H=o=>{f.value=o.value||o.target.value,u.value=1,b()},z=(o,t,c=!1)=>{if(c){j.value=o,x.value=!0;return}A(o,t)},A=(o,t)=>{g.value=!0,T.post(`/api/order/change-status/${o}`,null,{params:{status:t}}).then(()=>{y.add({severity:"success",summary:a("success"),detail:a(t===1?"order.statusAccepted":"order.statusRejected"),life:3e3}),b()}).catch(c=>{y.add({severity:"error",summary:a("error"),detail:a("order.statusChangeError"),life:5e3}),console.error("Status change failed:",c)}).finally(()=>{g.value=!1,x.value=!1})},J=()=>{j.value&&(A(j.value,2),j.value=null)},K=()=>{T.delete(`/api/order/${P.value}`).then(()=>{y.add({severity:"success",summary:a("success"),detail:a("order.deleteSuccess"),life:3e3}),b(),$.value=!1}).catch(()=>{y.add({severity:"error",summary:a("error"),detail:a("order.deleteError"),life:3e3})})},X=()=>{E.value.exportCSV()},Y=o=>{G.push({name:"order-show",params:{id:o}})};return le(()=>{Q()}),se(()=>{b()}),(o,t)=>{const c=L("can"),N=L("tooltip");return p(),C("div",ge,[s("div",fe,[s("div",be,[r(e(ne),{class:"mb-4"},{start:d(()=>[s("h2",he,n(e(a)("order.managementTitle")),1)]),end:d(()=>[s("div",ye,[s("span",xe,[t[10]||(t[10]=s("i",{class:"pi pi-search"},null,-1)),r(e(ie),{modelValue:V.value,"onUpdate:modelValue":t[0]||(t[0]=l=>V.value=l),placeholder:e(a)("order.search")},null,8,["modelValue","placeholder"])]),w(r(e(v),{label:e(a)("order.export"),icon:"pi pi-upload",class:"p-export",onClick:X},null,8,["label"]),[[c,"export orders"]])])]),_:1}),r(e(de)),s("div",_e,[w((p(),S(e(pe),{ref_key:"dt",ref:E,value:B.value,loading:g.value,"data-key":"id",paginator:!1,rows:f.value,filters:O.value,totalRecords:R.value,"responsive-layout":"scroll",stripedRows:"",showGridlines:"",class:"p-datatable-sm"},{empty:d(()=>[s("div",Ce,[t[11]||(t[11]=s("i",{class:"pi pi-exclamation-circle text-2xl mb-2"},null,-1)),s("p",we,n(e(a)("order.noData")),1)])]),loading:d(()=>[s("div",$e,[r(e(ue),{style:{width:"50px",height:"50px"},strokeWidth:"4"})])]),default:d(()=>[r(e(h),{"selection-mode":"multiple","header-style":"width: 3rem"}),r(e(h),{field:"id",header:e(a)("order.id"),sortable:!0,"header-style":"width:10%; min-width:6rem;"},{body:d(l=>[D(" #"+n(l.data.id),1)]),_:1},8,["header"]),r(e(h),{field:"data.user.name",header:e(a)("order.name"),sortable:!0},{body:d(l=>{var m;return[D(n((m=l.data.user)==null?void 0:m.name),1)]}),_:1},8,["header"]),r(e(h),{field:"total_price",header:e(a)("order.totalPrice"),sortable:!0},{body:d(l=>[D(n(l.data.total_price)+" "+n(o.$t("currencyLabel")),1)]),_:1},8,["header"]),r(e(h),{field:"status",header:e(a)("order.status"),sortable:!0},{body:d(l=>[r(e(ce),{value:l.data.status===0?e(a)("order.pending"):l.data.status===1?e(a)("order.completed"):e(a)("order.rejected"),severity:l.data.status===0?"warning":l.data.status===1?"success":"danger"},null,8,["value","severity"])]),_:1},8,["header"]),r(e(h),{header:e(a)("actions"),"header-style":"min-width:14rem;"},{body:d(l=>[s("div",ke,[w(r(e(v),{icon:"pi pi-eye",class:"p-button-rounded p-detail p-button-sm",onClick:m=>Y(l.data.id)},null,8,["onClick"]),[[c,"show orders"],[N,e(a)("view"),void 0,{top:!0}]]),l.data.status===0?w((p(),S(e(v),{key:0,icon:"pi pi-check",class:"p-button-rounded p-detail p-button-sm",onClick:m=>z(l.data.id,1)},null,8,["onClick"])),[[c,"update orders"],[N,e(a)("order.accept"),void 0,{top:!0}]]):M("",!0),l.data.status===0?w((p(),S(e(v),{key:1,icon:"pi pi-times",class:"p-button-rounded p-delete",onClick:m=>z(l.data.id,2,!0)},null,8,["onClick"])),[[c,"update orders"],[N,e(a)("order.reject"),void 0,{top:!0}]]):M("",!0)])]),_:1},8,["header"])]),_:1},8,["value","loading","rows","filters","totalRecords"])),[[c,"list orders"]]),s("div",je,[s("div",Ve,[s("span",Re,n(e(a)("show"))+" "+n(U.value)+" "+n(e(a)("to"))+" "+n(F.value)+" "+n(e(a)("from"))+" "+n(R.value),1)]),s("div",Ne,[s("button",{class:"p-paginator-first p-paginator-element p-link",disabled:u.value===1,onClick:t[1]||(t[1]=l=>k(1))},t[12]||(t[12]=[s("span",{class:"p-paginator-icon pi pi-angle-double-left"},null,-1)]),8,Se),s("button",{class:"p-paginator-prev p-paginator-element p-link",disabled:u.value===1,onClick:t[2]||(t[2]=l=>k(u.value-1))},t[13]||(t[13]=[s("span",{class:"p-paginator-icon pi pi-angle-left"},null,-1)]),8,Te),(p(!0),C(W,null,oe(I.value,(l,m)=>(p(),C(W,{key:m},[l.label&&!isNaN(parseInt(l.label))?(p(),C("button",{key:0,class:ve(["p-paginator-page p-paginator-element p-link",{"p-highlight":l.active}]),onClick:Ie=>k(parseInt(l.label))},n(l.label),11,De)):l.label==="..."?(p(),C("span",Me,"...")):M("",!0)],64))),128)),s("button",{class:"p-paginator-next p-paginator-element p-link",disabled:u.value===_.value,onClick:t[3]||(t[3]=l=>k(u.value+1))},t[14]||(t[14]=[s("span",{class:"p-paginator-icon pi pi-angle-right"},null,-1)]),8,Be),s("button",{class:"p-paginator-last p-paginator-element p-link",disabled:u.value===_.value,onClick:t[4]||(t[4]=l=>k(_.value))},t[15]||(t[15]=[s("span",{class:"p-paginator-icon pi pi-angle-double-right"},null,-1)]),8,Ee),r(e(me),{modelValue:f.value,"onUpdate:modelValue":t[5]||(t[5]=l=>f.value=l),options:[5,10,20,30,50],onChange:H,class:"ml-3",style:{width:"80px"}},null,8,["modelValue"])])])]),r(e(q),{visible:x.value,"onUpdate:visible":t[7]||(t[7]=l=>x.value=l),style:{width:"450px"},header:e(a)("order.rejectConfirmTitle"),modal:!0,closable:!1},{footer:d(()=>[r(e(v),{label:e(a)("no"),icon:"pi pi-times",class:"p-button-text",onClick:t[6]||(t[6]=l=>x.value=!1)},null,8,["label"]),r(e(v),{label:e(a)("yesReject"),icon:"pi pi-check",class:"p-button-danger",onClick:J},null,8,["label"])]),default:d(()=>[s("div",Oe,[t[16]||(t[16]=s("i",{class:"pi pi-exclamation-triangle",style:{"font-size":"2.5rem",color:"var(--red-500)"}},null,-1)),s("span",null,n(e(a)("order.rejectConfirmMessage")),1)])]),_:1},8,["visible","header"]),r(e(q),{visible:$.value,"onUpdate:visible":t[9]||(t[9]=l=>$.value=l),style:{width:"450px"},header:e(a)("order.deleteConfirmTitle"),modal:!0},{footer:d(()=>[r(e(v),{label:e(a)("no"),icon:"pi pi-times",class:"p-button-text",onClick:t[8]||(t[8]=l=>$.value=!1)},null,8,["label"]),r(e(v),{label:e(a)("yes"),icon:"pi pi-check",class:"p-button-text p-button-danger",onClick:K},null,8,["label"])]),default:d(()=>[s("div",Ue,[t[17]||(t[17]=s("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem",color:"var(--red-500)"}},null,-1)),s("span",null,n(e(a)("order.deleteConfirmMessage")),1)])]),_:1},8,["visible","header"])])])])}}};export{Ae as default};
