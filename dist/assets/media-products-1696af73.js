import{_ as V,u as D,l as R,p as W,z as E,r as v,o as G,x as S,e as o,h as l,g as a,t as n,j as _,F as C,m as B,n as c,b as f,G as j,A as L,v as U}from"./index-cbbedec6.js";const J={class:"mx-auto px-4 max-w-[1500px] py-8"},K={key:0,class:"flex justify-center items-center py-20"},Q={key:1,class:"text-center py-20"},X={class:"text-xl font-semibold text-red-600 mb-4"},Y={key:2,class:"max-w-7xl mx-auto"},Z={class:"grid gap-6 grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5"},tt=["onClick"],et={class:"aspect-square bg-gray-100 overflow-hidden relative"},st=["src","alt"],at=["onClick","aria-label"],it={key:1,class:"absolute inset-0 bg-black bg-opacity-60 flex items-center justify-center"},ot={class:"text-white font-bold text-lg"},lt={class:"p-4 flex flex-col"},nt={class:"font-semibold text-gray-900 text-lg line-clamp-2 leading-tight mb-2"},rt={key:0,class:"text-gray-600 text-sm line-clamp-2 mb-3"},ct={class:"flex items-center gap-1 mb-3"},dt={class:"text-yellow-500 font-bold text-sm"},ut={class:"text-gray-500 text-xs"},_t={class:"mt-auto flex items-center justify-between"},gt={class:"flex items-baseline gap-2"},ht={class:"text-2xl font-bold text-gray-900"},mt={key:0,class:"text-base line-through text-blue-600 opacity-80"},vt=["onClick","disabled"],pt={key:0,class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24"},ft={key:1,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},bt={key:1,class:"flex items-center mt-3 text-[#0b3baa] text-xs font-medium"},xt={key:0,class:"mt-12 flex justify-center"},wt={class:"inline-flex gap-2","aria-label":"Pagination"},yt=["onClick","aria-current","disabled"],kt=["innerHTML"],Ct={__name:"media-products",setup(Lt){const{t:d,locale:b}=D(),M=R(),r=W(),x=E(),$=v([]),w=v(!0),p=v(null),g=v(1),y=v({current_page:1,last_page:1,links:[]}),F=t=>Number(t||0).toFixed(2),P=(t,s)=>(t==null?void 0:t.length)>s?t.slice(0,s)+"...":t,T=t=>{if(!t)return 1;const s=t.match(/page=(\d+)/);return s?parseInt(s[1]):1},h=async(t,s=1)=>{w.value=!0,p.value=null;try{const e=window.innerWidth<768?10:20,u=`/api/home/get-media-link/details/${t||""}?limit=${e}&page=${s}`,k=await f.get(u),m=k.data.data.details||k.data.data;$.value=m.data.map(i=>{var z,O;return{id:i.id,name:b.value==="ar"?i.name_ar||i.name_en:i.name_en||i.name_ar,sub_name:b.value==="ar"?i.sub_name_ar||i.sub_name_en:i.sub_name_en||i.sub_name_ar,base_price:parseFloat(i.base_price),total_discounts_value:parseFloat(i.total_discounts_value||0),final_price:Math.max(0,parseFloat(i.base_price)-parseFloat(i.total_discounts_value||0)),img:((O=(z=i.media)==null?void 0:z.find(q=>q.name==="product_main_image"))==null?void 0:O.url)||i.key_default_image||"/placeholder.jpg",total_rating:i.total_rating||"0.0",total_reviews:i.total_reviews||0,is_wished:i.is_wished||!1,in_cart:i.in_cart||!1,is_stock:i.is_stock,isOutOfStock:i.is_stock===0,is_free_shipping:i.is_free_shipping||!1}}),y.value={current_page:m.current_page,last_page:m.last_page,links:m.links||[]},g.value=m.current_page}catch(e){p.value=d("error.fetchFailed")||"Failed to load products",console.error(e)}finally{w.value=!1}},A=t=>{const s=`/product-details/${t}`;window.open(s,"_blank","noopener,noreferrer")},H=t=>{t!==g.value&&(h(r.params.id,t),window.scrollTo({top:0,behavior:"smooth"}))},I=async t=>{if(!x.authenticatedweb)return M.push({name:"AuthLogin"});if(!(t.isOutOfStock||t.in_cart))try{await f.post("/api/cart/add",{product_id:t.id,quantity:1}),t.in_cart=!0}catch{alert(d("cart.error"))}},N=async t=>{if(!x.authenticatedweb)return M.push({name:"AuthLogin"});const s=t.is_wished;try{s?await f.delete(`/api/wishlists/${t.id}`):await f.post("/api/wishlists",{product_id:t.id}),t.is_wished=!s}catch{t.is_wished=s}};return G(()=>{b.value=localStorage.getItem("appLang")||"ar",h(r.params.id,r.query.page||1)}),S(()=>r.params.id,t=>{g.value=1,h(t,1)}),S(()=>r.query.page,t=>{const s=parseInt(t)||1;s!==g.value&&h(r.params.id,s)}),(t,s)=>(o(),l("div",J,[w.value?(o(),l("div",K,s[1]||(s[1]=[a("svg",{class:"animate-spin h-10 w-10 text-indigo-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[a("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),a("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)]))):p.value?(o(),l("div",Q,[a("p",X,n(p.value),1),a("button",{onClick:s[0]||(s[0]=e=>h(_(r).params.id,g.value)),class:"bg-indigo-600 text-white px-6 py-3 rounded-lg hover:bg-indigo-700 transition"},n(_(d)("products.retry")||"Retry"),1)])):(o(),l("div",Y,[a("div",Z,[(o(!0),l(C,null,B($.value,e=>(o(),l("div",{key:e.id,class:"group relative bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-2xl hover:-translate-y-2 transition-all duration-300 cursor-pointer",onClick:u=>A(e.id)},[a("div",et,[a("img",{src:e.img,alt:e.name,class:"w-full h-full object-contain transition-transform duration-700 group-hover:scale-110",loading:"lazy"},null,8,st),s[3]||(s[3]=a("div",{class:"absolute inset-0 bg-black opacity-0 group-hover:opacity-10 transition-opacity"},null,-1)),_(x).authenticatedweb?(o(),l("button",{key:0,onClick:j(u=>N(e),["stop"]),class:L(["absolute top-3 right-3 p-2.5 bg-white rounded-full shadow-lg z-10 transition-all",{"text-red-500":e.is_wished}]),"aria-label":e.is_wished?_(d)("wishlist.remove"):_(d)("wishlist.add")},s[2]||(s[2]=[a("svg",{class:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24"},[a("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})],-1)]),10,at)):c("",!0),e.isOutOfStock?(o(),l("div",it,[a("span",ot,n(_(d)("products.outOfStock")),1)])):c("",!0)]),a("div",lt,[a("h3",nt,n(P(e.name,50)),1),e.sub_name?(o(),l("p",rt,n(e.sub_name),1)):c("",!0),a("div",ct,[a("span",dt,n(e.total_rating||"0.0"),1),s[4]||(s[4]=a("svg",{class:"w-4 h-4 text-yellow-500 fill-current",viewBox:"0 0 24 24"},[a("path",{d:"M12 17.27l6.18 3.73-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73-1.64 7.03z"})],-1)),a("span",ut,"("+n(e.total_reviews||0)+")",1)]),a("div",_t,[a("div",gt,[a("span",ht,n(t.$t("currencyLabel"))+" "+n(F(e.final_price)),1),e.total_discounts_value>0?(o(),l("span",mt,n(t.$t("currencyLabel"))+" "+n(F(e.base_price)),1)):c("",!0)]),a("button",{onClick:j(u=>I(e),["stop"]),disabled:e.isOutOfStock,class:L(["p-3 rounded-full transition-all duration-300 shadow-md",[e.in_cart?"bg-[#0b3baa] text-white":e.isOutOfStock?"bg-gray-200 text-gray-400 cursor-not-allowed":"bg-[#A6853B] text-white hover:bg-[#8f702c]"]])},[e.in_cart?(o(),l("svg",pt,s[5]||(s[5]=[a("path",{d:"M9 16.2l-3.5-3.5a.984.984 0 0 0-1.4 0 .984.984 0 0 0 0 1.4l4.2 4.2c.39.39 1.01.39 1.4 0l8.4-8.4a.984.984 0 0 0 0-1.4.984.984 0 0 0-1.4 0L9 16.2z"},null,-1)]))):(o(),l("svg",ft,s[6]||(s[6]=[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.182 1.708.707 1.708H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"},null,-1)])))],10,vt)]),e.is_free_shipping?(o(),l("div",bt,[s[7]||(s[7]=a("i",{class:"pi pi-truck mr-1"},null,-1)),U(" "+n(t.$t("products.Free_Delivery")),1)])):c("",!0)])],8,tt))),128))]),y.value.last_page>1?(o(),l("div",xt,[a("nav",wt,[(o(!0),l(C,null,B(y.value.links,(e,u)=>(o(),l(C,{key:u},[e.url?(o(),l("button",{key:0,onClick:k=>H(T(e.url)),class:L(["px-4 py-2 rounded-full text-sm font-medium transition-colors",e.active?"bg-indigo-600 text-white":"bg-gray-100 text-gray-700 hover:bg-indigo-100 hover:text-indigo-700"]),"aria-current":e.active?"page":void 0,disabled:!e.url},[a("span",{innerHTML:e.label},null,8,kt)],10,yt)):c("",!0)],64))),128))])])):c("",!0)]))]))}},$t=V(Ct,[["__scopeId","data-v-93c141b6"]]);export{$t as default};
