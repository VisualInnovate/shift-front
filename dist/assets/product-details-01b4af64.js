import{_ as Ve,u as je,p as Fe,l as Be,z as $e,a as qe,r as g,c as x,x as Ie,o as Re,e as n,h as i,i as B,j as o,g as t,t as r,n as _,F as z,m as M,v as Ee,A as ee,B as Pe,D as Te,b as Y,s as Le,K as H,L as ve}from"./index-a771a5d1.js";import{P as ze}from"./ProductOffers-5b08d099.js";const Me={class:"product-page max-w-7xl mx-auto p-4 lg:p-8"},Ne={key:0,class:"text-center py-20"},Ue={class:"mt-4 text-gray-600"},Qe={key:1,class:"text-red-500 text-center py-10 text-lg"},Ge={key:2,class:"flex flex-col lg:flex-row items-start gap-8 lg:gap-12"},Ke={class:"w-full lg:w-1/2 flex flex-col-reverse lg:flex-row items-center gap-4"},We={class:"flex lg:flex-col flex-row items-center justify-center lg:justify-start gap-3 w-full lg:w-1/4 order-2 lg:order-1"},Ye=["src","alt","onClick"],He={class:"w-full lg:w-3/4 order-1 lg:order-2"},Je={class:"relative w-full aspect-square shadow-xl rounded-2xl overflow-hidden bg-gray-50"},Xe={key:0,class:"absolute top-4 left-4 z-10 bg-black text-white text-xs font-bold px-4 py-2 rounded-full uppercase tracking-wider shadow-lg"},Ze={key:1,class:"absolute top-4 right-4 z-10 bg-green-600 text-white text-xs font-bold px-4 py-2 rounded-full flex items-center gap-2 shadow-lg"},et=["src","alt"],tt={class:"w-full lg:w-1/2"},at={class:"bg-white rounded-2xl shadow-lg p-6 lg:p-8"},st={class:"flex flex-wrap gap-3 mb-6"},lt={class:"text-3xl lg:text-4xl font-bold text-gray-800 mb-3 leading-tight"},ot={key:0,class:"text-xl text-gray-600 mb-6"},rt={class:"flex items-center gap-3 mb-6"},nt={class:"text-gray-600"},it={key:1,class:"mb-8 space-y-6"},ut={class:"flex flex-wrap gap-3"},ct=["onClick"],dt={key:1},vt={key:0,class:"text-red-600 font-semibold mt-3"},_t={key:1,class:"text-orange-600 font-medium mt-3"},pt={class:"mb-8"},gt={class:"flex items-baseline gap-4 flex-wrap"},mt={class:"text-4xl font-bold text-gray-900"},ft={key:0,class:"text-2xl font-bold text-[#0b3baa] line-through opacity-80"},ht={key:1,class:"bg-red-100 text-red-800 text-sm font-bold px-3 py-1 rounded-full"},yt={key:2,class:"flex items-center gap-6 mb-8"},bt={class:"font-bold text-gray-700 text-lg"},xt={class:"flex items-center border-2 border-gray-300 rounded-xl overflow-hidden select-none"},wt=["disabled"],kt={class:"px-8 py-3 font-semibold text-lg border-x-2 border-gray-300 min-w-20 text-center"},Ot=["disabled"],St=["disabled"],Ct={key:0,class:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24"},Dt={key:1},At={key:2},Vt={key:3},jt={key:3,class:"text-red-600 font-semibold text-center mt-4"},Ft={key:3,class:"bg-[#E6AC312B] px-8 py-10 rounded-2xl mt-12"},Bt={class:"text-gray-700 leading-relaxed text-base"},$t={key:4,class:"mt-12 p-8 bg-white rounded-2xl shadow-xl"},qt={class:"text-3xl font-bold text-center text-gray-800 mb-10"},It={class:"grid md:grid-cols-3 gap-8 mb-12"},Rt={class:"text-center"},Et={class:"text-6xl font-bold text-gray-800"},Pt={class:"text-gray-500"},Tt={class:"md:col-span-2 space-y-3"},Lt={class:"w-8 text-sm font-medium"},zt={class:"flex-1 bg-gray-200 rounded-full h-4 relative overflow-hidden"},Mt={class:"text-sm text-gray-600 w-12 text-right"},Nt={class:"mt-12 border-t pt-12"},Ut={class:"text-2xl font-bold text-center mb-8"},Qt={key:0,class:"max-w-2xl mx-auto space-y-6"},Gt={class:"text-center"},Kt=["placeholder"],Wt=["disabled"],Yt={key:0,class:"text-red-500 text-center font-medium"},Ht={key:1,class:"text-center py-12 bg-gray-50 rounded-2xl"},Jt={class:"text-gray-600 mb-6 text-lg"},Xt={key:0,class:"mt-12 space-y-8"},Zt={class:"text-2xl font-bold text-gray-800 border-b pb-4"},ea={class:"flex items-center justify-between mb-4"},ta={class:"flex items-center gap-4"},aa={class:"w-12 h-12 bg-gray-200 rounded-full flex items-center justify-center text-xl font-bold text-gray-600"},sa={class:"font-semibold text-lg"},la={class:"text-sm text-gray-500"},oa={class:"text-gray-700 leading-relaxed pl-16"},ra={key:1,class:"text-center py-16 text-gray-500 text-lg"},na={key:5,class:"mt-12"},_e="https://via.placeholder.com/600?text=No+Image",ia={__name:"product-details",setup(ua){const{t:l,locale:w}=je(),J=Fe(),$=Be(),N=$e(),A=qe(),s=g({}),X=g([]),O=g(""),S=g(1),V=g(!0),C=g(null),q=g(!1),I=g(!1),m=g([]),U=g(!1),Q=g(!1),R=g(null),f=g({rating:0,comment:""}),j=g({}),G=g([]),F=g({}),c=g(null),pe=x(()=>{var a;let e=[...X.value];if((a=c.value)!=null&&a.image){const u=c.value.image;e.some(v=>v.url===u)||e.unshift({url:u})}return e.filter((u,v,p)=>p.findIndex(b=>b.url===u.url)===v)}),E=x(()=>{let e=parseFloat(s.value.base_price||0),a=parseFloat(s.value.base_price_after_discount||e),u=parseFloat(s.value.total_discounts_value||0);c.value&&c.value.price&&(e=parseFloat(c.value.price),a=e,u=0);const v=u>0,p=e?Math.round(u/e*100):0;return{base_price:e.toFixed(2),after_discount:a.toFixed(2),has_discount:v,discount_percentage:p}}),P=x(()=>s.value.has_variants?c.value!==null:!0),ge=x(()=>Object.keys(F.value).length>0&&c.value===null),K=x(()=>w.value==="en"?s.value.description_en||l("product.noDescription"):s.value.description_ar||l("product.noDescription")),te=x(()=>K.value.length>300),me=x(()=>te.value?K.value.slice(0,300)+"...":K.value),Z=x(()=>m.value.length?m.value.reduce((e,a)=>e+a.rate,0)/m.value.length:0),fe=x(()=>{const e={1:0,2:0,3:0,4:0,5:0};m.value.forEach(u=>e[u.rate]++);const a=m.value.length;return[5,4,3,2,1].map(u=>({stars:u,count:e[u],percentage:a?Math.round(e[u]/a*100):0}))}),he=x(()=>m.value.slice(0,5)),ae=e=>parseFloat(e||0).toFixed(2),ye=e=>O.value=e,be=()=>U.value=!U.value,xe=e=>new Date(e).toLocaleDateString(w.value==="ar"?"ar-EG":"en-US",{year:"numeric",month:"short",day:"numeric"}),se=(e,a)=>{var u;return((u=F.value[e])==null?void 0:u.id)===a.id},we=(e,a)=>{const u={...F.value,[e]:a};F.value=u;const v=G.value.find(p=>Object.keys(u).every(b=>{var k;const h=u[b].id;return((k=p.attributes[b])==null?void 0:k.id)===h}));v&&Object.keys(u).length===Object.keys(j.value).length?(c.value={...v,variant_id:v.variant_id,price:v.price,image:v.image,isOutOfStock:s.value.is_stock===0,in_cart:s.value.in_cart},v.image&&(O.value=v.image),S.value=s.value.in_cart&&s.value.quantity||1):c.value=null},ke=async()=>{var e,a;if(!N.authenticatedweb)return $.push({name:"authlog"});if(!(!c.value||q.value)){q.value=!0;try{await Y.post("/api/cart/add",{product_id:s.value.id,variant_id:c.value.variant_id||null,quantity:1}),c.value.in_cart=!0,s.value.in_cart=!0,S.value=1,A.add({severity:"success",summary:l("success"),detail:l("cart.added"),life:3e3})}catch(u){A.add({severity:"error",detail:((a=(e=u.response)==null?void 0:e.data)==null?void 0:a.message)||l("cart.error"),life:3e3})}finally{q.value=!1}}},le=async e=>{if(!N.authenticatedweb||I.value||!c.value)return;const a=e==="plus"?S.value+1:S.value-1;if(!(a<1)){I.value=!0;try{await Y.post("/api/cart/update",{product_id:s.value.id,variant_id:c.value.variant_id||null,quantity:a}),S.value=a,A.add({severity:"success",detail:l(e==="plus"?"cart.quantityIncreased":"cart.quantityDecreased"),life:2e3})}catch{A.add({severity:"error",detail:l("cart.quantityError"),life:3e3})}finally{I.value=!1}}},Oe=()=>{var e;if(!P.value){A.add({severity:"warn",detail:l("product.selectVariant")||"Please select all options",life:3e3});return}(e=c.value)!=null&&e.in_cart||ke()},Se=async()=>{var e,a,u;if(f.value.rating===0||!f.value.comment.trim()){R.value=l("reviews.requiredFields");return}Q.value=!0,R.value=null;try{const v={model_id:J.params.id,rate:f.value.rating,type:"product",message:f.value.comment.trim()},{data:p}=await Y.post("/api/review",v);p.is_success&&(m.value.unshift({id:p.data.id||Date.now(),rate:f.value.rating,message:f.value.comment.trim(),user:{name:((e=N.user)==null?void 0:e.name)||"You"},created_at:new Date().toISOString()}),f.value={rating:0,comment:""},A.add({severity:"success",summary:l("success"),detail:l("reviews.submitSuccess"),life:4e3}))}catch(v){R.value=((u=(a=v.response)==null?void 0:a.data)==null?void 0:u.message)||l("reviews.submitError")}finally{Q.value=!1}},Ce=e=>e&&$.push(e.has_subcategories?{name:"subcategory",params:{id:e.id}}:{name:"produts_category",params:{id:e.id}}),De=e=>e&&$.push({name:"products-brand",params:{id:e.id}}),Ae=e=>e&&$.push(e.has_market?{name:"stores-hasmarket"}:{name:"home"}),oe=async()=>{var e,a,u;V.value=!0,C.value=null,F.value={},c.value=null;try{const{data:v}=await Y.get(`/api/home/product-details/${J.params.id}`);if(v.is_success){const p=v.data.product;s.value={...p,in_cart:!!p.in_cart,isOutOfStock:p.is_stock===0},X.value=p.media||[],m.value=p.reviews||[];const b=v.data.variants_details||{};if(j.value=b.attributes||{},G.value=(b.combinations||[]).map(h=>({...h,image:h.image})),G.value.length>0){const h=G.value[0];c.value={...h,isOutOfStock:s.value.is_stock===0,in_cart:s.value.in_cart},Object.keys(j.value).forEach(k=>{const T=j.value[k].find(W=>{var L;return W.id===((L=h.attributes[k])==null?void 0:L.id)});T&&(F.value[k]=T)}),h.image&&(O.value=h.image)}else s.value.has_variants||(c.value={variant_id:null,price:s.value.base_price,image:null,isOutOfStock:s.value.isOutOfStock,in_cart:s.value.in_cart});O.value=O.value||s.value.key_default_image||((e=X.value[0])==null?void 0:e.url)||_e,S.value=s.value.in_cart&&s.value.quantity||1}else C.value=l("product.notFound")}catch(v){C.value=((u=(a=v.response)==null?void 0:a.data)==null?void 0:u.message)||l("product.loadError")}finally{V.value=!1}};return Ie(()=>J.params.id,e=>{e&&oe(),window.scrollTo(0,0)}),Re(()=>{window.scrollTo(0,0),oe()}),(e,a)=>{var u,v,p,b,h,k,T,W,L,re,ne,ie,ue,ce,de;return n(),i("div",Me,[V.value?(n(),i("div",Ne,[B(o(Le),{style:{width:"50px",height:"50px"},strokeWidth:"4"}),t("p",Ue,r(o(l)("common.loading")),1)])):_("",!0),C.value?(n(),i("div",Qe,r(C.value),1)):(n(),i("header",Ge,[t("div",Ke,[t("div",We,[(n(!0),i(z,null,M(pe.value,d=>(n(),i("img",{key:d.url,src:d.url,alt:o(l)("product.thumbnailAlt"),class:ee(["h-20 w-20 object-contain rounded-lg cursor-pointer border-2 transition-all duration-200 hover:border-blue-500",{"border-blue-500 opacity-100":O.value===d.url,"border-gray-300 opacity-70":O.value!==d.url}]),onClick:D=>ye(d.url)},null,10,Ye))),128))]),t("div",He,[t("div",Je,[s.value.is_best_seller?(n(),i("div",Xe," Best Seller ")):_("",!0),s.value.is_free_shipping?(n(),i("div",Ze,[a[8]||(a[8]=t("i",{class:"pi pi-truck"},null,-1)),Ee(" "+r(o(l)("products.Free_Delivery")),1)])):_("",!0),t("img",{src:O.value||s.value.key_default_image||_e,alt:o(w)==="en"?s.value.name_en:s.value.name_ar,class:"w-full h-full object-contain transition-transform duration-700 hover:scale-105",loading:"lazy"},null,8,et)])])]),t("div",tt,[t("div",at,[t("section",st,[s.value.store_id?(n(),i("span",{key:0,onClick:a[0]||(a[0]=d=>Ae(s.value.store)),class:"sub-tiles cursor-pointer"},r(o(w)==="en"?(u=s.value.store)==null?void 0:u.name_en:((v=s.value.store)==null?void 0:v.name_ar)||o(l)("store.default")),1)):_("",!0),s.value.category?(n(),i("span",{key:1,onClick:a[1]||(a[1]=d=>Ce(s.value.category)),class:"sub-tiles cursor-pointer"},r(o(w)==="en"?s.value.category.name_en:s.value.category.name_ar),1)):_("",!0),s.value.brand_id?(n(),i("span",{key:2,onClick:a[2]||(a[2]=d=>De(s.value.brand)),class:"sub-tiles cursor-pointer"},r(o(w)==="en"?(p=s.value.brand)==null?void 0:p.name_en:((b=s.value.brand)==null?void 0:b.name_ar)||o(l)("brand.default")),1)):_("",!0)]),t("h1",lt,r(o(w)==="en"?s.value.name_en:s.value.name_ar),1),s.value.sub_name_en||s.value.sub_name_ar?(n(),i("h2",ot,r(o(w)==="en"?s.value.sub_name_en:s.value.sub_name_ar),1)):_("",!0),t("div",rt,[B(o(H),{modelValue:Z.value,readonly:!0,cancel:!1,class:"text-lg"},null,8,["modelValue"]),t("span",nt,"("+r(m.value.length)+" "+r(m.value.length===1?o(l)("reviews.singular"):o(l)("reviews.plural"))+")",1)]),a[10]||(a[10]=t("hr",{class:"bg-gradient-to-r from-transparent via-[#A17D1C] to-transparent h-0.5 my-8"},null,-1)),s.value.has_variants&&Object.keys(j.value).length?(n(),i("section",it,[(n(!0),i(z,null,M(j.value,(d,D)=>(n(),i("div",{key:D,class:"space-y-2"},[t("div",ut,[(n(!0),i(z,null,M(d,y=>(n(),i("button",{key:y.id,onClick:ca=>we(D,y),class:ee([{"border-blue-600 ring-4 ring-blue-100":se(D,y),"border-gray-300 hover:border-blue-400":!se(D,y)},"px-4 py-2 text-sm font-medium border-2 rounded-lg transition-all duration-200 flex items-center gap-2"])},[y.is_color?(n(),i("span",{key:0,class:"w-6 h-6 rounded-full border-2 border-gray-300",style:ve({backgroundColor:y.value_en})},null,4)):_("",!0),y.is_color?_("",!0):(n(),i("span",dt,r(o(w)==="en"?y.value_en:y.value_ar),1))],10,ct))),128))])]))),128)),c.value&&c.value.isOutOfStock?(n(),i("p",vt,r(o(l)("product.outOfStock")),1)):c.value===null&&ge.value?(n(),i("p",_t,r(o(l)("product.selectAllVariants")||"Please select all options"),1)):_("",!0)])):_("",!0),t("div",pt,[t("div",gt,[t("span",mt,r(ae(E.value.after_discount))+" "+r(e.$t("currencyLabel")),1),E.value.has_discount?(n(),i("span",ft,r(ae(E.value.base_price))+" "+r(e.$t("currencyLabel")),1)):_("",!0),E.value.has_discount?(n(),i("span",ht," -"+r(E.value.discount_percentage)+"% ",1)):_("",!0)])]),(h=c.value)!=null&&h.in_cart?(n(),i("div",yt,[t("label",bt,r(o(l)("product.quantity"))+":",1),t("div",xt,[t("button",{onClick:a[3]||(a[3]=d=>le("minus")),disabled:S.value<=1||I.value||((k=c.value)==null?void 0:k.isOutOfStock),class:"px-5 py-3 text-2xl font-bold hover:bg-gray-100 disabled:opacity-50 transition"},"âˆ’",8,wt),t("span",kt,r(S.value),1),t("button",{onClick:a[4]||(a[4]=d=>le("plus")),disabled:I.value||((T=c.value)==null?void 0:T.isOutOfStock),class:"px-5 py-3 text-2xl font-bold hover:bg-gray-100 disabled:opacity-50 transition"},"+",8,Ot)])])):_("",!0),t("button",{onClick:Oe,disabled:q.value||((W=c.value)==null?void 0:W.isOutOfStock)||!P.value,class:ee(["w-full py-5 text-xl font-bold rounded-2xl text-white transition-all duration-300 shadow-lg hover:shadow-xl active:scale-95 flex items-center justify-center gap-3",{"bg-[#A6853B] hover:bg-[#8f702c]":!((L=c.value)!=null&&L.in_cart)&&P.value,"bg-[#0b3baa] hover:bg-[#093080]":(re=c.value)==null?void 0:re.in_cart,"bg-gray-400 cursor-not-allowed":((ne=c.value)==null?void 0:ne.isOutOfStock)||!P.value}])},[(ie=c.value)!=null&&ie.in_cart?(n(),i("svg",Ct,a[9]||(a[9]=[t("path",{d:"M9 16.2l-3.5-3.5a.984.984 0 0 0-1.4 0 .984.984 0 0 0 0 1.4l4.2 4.2c.39.39 1.01.39 1.4 0l8.4-8.4a.984.984 0 0 0 0-1.4.984.984 0 0 0-1.4 0L9 16.2z"},null,-1)]))):_("",!0),(ue=c.value)!=null&&ue.in_cart?(n(),i("span",Dt,r(o(l)("product.inCart")),1)):(ce=c.value)!=null&&ce.isOutOfStock||!P.value?(n(),i("span",At,r(o(l)("product.outOfStock")),1)):(n(),i("span",Vt,r(q.value?o(l)("product.adding")+"...":o(l)("product.addToCart")),1))],10,St),(de=c.value)!=null&&de.isOutOfStock?(n(),i("p",jt,r(o(l)("product.outOfStock")),1)):_("",!0)])])])),!V.value&&!C.value?(n(),i("section",Ft,[t("p",Bt,r(U.value?K.value:me.value),1),te.value?(n(),i("button",{key:0,onClick:be,class:"mt-4 text-[#E39F30] font-bold text-sm hover:underline focus:outline-none"},r(U.value?o(l)("product.readLess"):o(l)("product.readMore")),1)):_("",!0)])):_("",!0),!V.value&&!C.value?(n(),i("section",$t,[t("h2",qt,r(o(l)("reviews.title")),1),t("div",It,[t("div",Rt,[t("div",Et,r(Z.value.toFixed(1)),1),B(o(H),{modelValue:Z.value,readonly:!0,cancel:!1,class:"my-4 justify-center text-3xl"},null,8,["modelValue"]),t("p",Pt,r(m.value.length)+" "+r(m.value.length===1?o(l)("reviews.singular"):o(l)("reviews.plural")),1)]),t("div",Tt,[(n(!0),i(z,null,M(fe.value,d=>(n(),i("div",{key:d.stars,class:"flex items-center gap-3"},[t("span",Lt,r(d.stars),1),t("div",zt,[t("div",{class:"absolute top-0 left-0 h-full bg-[#A6853B] transition-all duration-700 ease-out",style:ve({width:d.percentage+"%"})},null,4)]),t("span",Mt,r(d.count),1)]))),128))])]),t("div",Nt,[t("h3",Ut,r(o(l)("reviews.writeReview")),1),o(N).authenticatedweb?(n(),i("div",Qt,[t("div",Gt,[B(o(H),{modelValue:f.value.rating,"onUpdate:modelValue":a[5]||(a[5]=d=>f.value.rating=d),stars:5,cancel:!1,class:"text-4xl justify-center"},null,8,["modelValue"])]),Pe(t("textarea",{"onUpdate:modelValue":a[6]||(a[6]=d=>f.value.comment=d),rows:"6",class:"w-full p-5 border border-gray-300 rounded-xl focus:ring-4 focus:ring-[#A6853B]/20 focus:border-[#A6853B] outline-none resize-none transition",placeholder:o(l)("reviews.placeholder")},null,8,Kt),[[Te,f.value.comment]]),t("button",{onClick:Se,disabled:Q.value||f.value.rating===0||!f.value.comment.trim(),class:"w-full py-4 bg-[#A6853B] hover:bg-[#8f702c] text-white font-bold rounded-xl transition disabled:opacity-50 disabled:cursor-not-allowed shadow-lg hover:shadow-xl"},r(Q.value?o(l)("reviews.submitting")+"...":o(l)("reviews.submit")),9,Wt),R.value?(n(),i("p",Yt,r(R.value),1)):_("",!0)])):(n(),i("div",Ht,[t("p",Jt,r(o(l)("reviews.loginToReview")),1),t("button",{onClick:a[7]||(a[7]=d=>o($).push({name:"authlog"})),class:"px-10 py-4 bg-[#A6853B] text-white font-bold rounded-xl hover:bg-[#8f702c] transition shadow-lg"},r(o(l)("reviews.login")),1)]))]),m.value.length?(n(),i("div",Xt,[t("h3",Zt,r(o(l)("reviews.customerReviews")),1),(n(!0),i(z,null,M(he.value,d=>{var D,y;return n(),i("div",{key:d.id,class:"border-b pb-8 last:border-0"},[t("div",ea,[t("div",ta,[t("div",aa,r((((D=d.user)==null?void 0:D.name)||"A")[0].toUpperCase()),1),t("div",null,[t("p",sa,r(((y=d.user)==null?void 0:y.name)||o(l)("reviews.anonymous")),1),B(o(H),{modelValue:d.rate,readonly:!0,cancel:!1},null,8,["modelValue"])])]),t("span",la,r(xe(d.created_at)),1)]),t("p",oa,r(d.message),1)])}),128))])):(n(),i("div",ra,r(o(l)("reviews.noReviews")),1))])):_("",!0),!V.value&&!C.value?(n(),i("section",na,[B(ze)])):_("",!0)])}}},_a=Ve(ia,[["__scopeId","data-v-29234944"]]);export{_a as default};
