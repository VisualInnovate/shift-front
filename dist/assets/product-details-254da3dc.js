import{_ as Oe,j as Se,k as Ce,u as De,v as Ve,G as Ae,r as _,l as O,q as Fe,o as qe,a as i,c as u,h as A,e as o,f as t,t as l,g as v,F as U,d as N,p as Be,x as Y,y as $e,A as je,i as Q,H as Ie,I as G,J as Re}from"./index-275009ef.js";import{P as Ee}from"./ProductOffers-3f0b87f5.js";const Pe={class:"product-page max-w-7xl mx-auto p-4 lg:p-8"},Te={key:0,class:"text-center py-20"},Le={class:"mt-4 text-gray-600"},ze={key:1,class:"text-red-500 text-center py-10 text-lg"},Me={key:2,class:"flex flex-col lg:flex-row items-start gap-8 lg:gap-12"},Ue={class:"w-full lg:w-1/2 flex flex-col-reverse lg:flex-row items-center gap-4"},Ne={class:"flex lg:flex-col flex-row items-center justify-center lg:justify-start gap-3 w-full lg:w-1/4 order-2 lg:order-1"},Qe=["src","alt","onClick"],Ge={class:"w-full lg:w-3/4 order-1 lg:order-2"},He={class:"relative w-full aspect-square shadow-xl rounded-2xl overflow-hidden bg-gray-50"},Je={key:0,class:"absolute top-4 left-4 z-10 bg-black text-white text-xs font-bold px-4 py-2 rounded-full uppercase tracking-wider shadow-lg"},We={key:1,class:"absolute top-4 right-4 z-10 bg-green-600 text-white text-xs font-bold px-4 py-2 rounded-full flex items-center gap-2 shadow-lg"},Ye=["src","alt"],Ke={class:"w-full lg:w-1/2"},Xe={class:"bg-white rounded-2xl shadow-lg p-6 lg:p-8"},Ze={class:"flex flex-wrap gap-3 mb-6"},et={class:"text-3xl lg:text-4xl font-bold text-gray-800 mb-3 leading-tight"},tt={key:0,class:"text-xl text-gray-600 mb-6"},at={class:"flex items-center gap-3 mb-6"},st={class:"text-gray-600"},lt={key:1,class:"mb-8"},ot={class:"flex flex-wrap gap-3"},rt=["onClick"],nt={key:0,class:"text-red-600 font-semibold mt-3"},it={class:"mb-8"},ut={class:"flex items-baseline gap-4 flex-wrap"},ct={class:"text-4xl font-bold text-gray-900"},dt={key:0,class:"text-2xl font-bold text-[#0b3baa] line-through opacity-80"},vt={key:1,class:"bg-red-100 text-red-800 text-sm font-bold px-3 py-1 rounded-full"},_t={key:2,class:"flex items-center gap-6 mb-8"},gt={class:"font-bold text-gray-700 text-lg"},pt={class:"flex items-center border-2 border-gray-300 rounded-xl overflow-hidden select-none"},mt=["disabled"],ft={class:"px-8 py-3 font-semibold text-lg border-x-2 border-gray-300 min-w-20 text-center"},ht=["disabled"],xt=["disabled"],yt={key:0,class:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24"},bt={key:1},wt={key:2},kt={key:3},Ot={key:3,class:"text-red-600 font-semibold text-center mt-4"},St={key:3,class:"bg-[#E6AC312B] px-8 py-10 rounded-2xl mt-12"},Ct={class:"text-gray-700 leading-relaxed text-base"},Dt={key:4,class:"mt-12 p-8 bg-white rounded-2xl shadow-xl"},Vt={class:"text-3xl font-bold text-center text-gray-800 mb-10"},At={class:"grid md:grid-cols-3 gap-8 mb-12"},Ft={class:"text-center"},qt={class:"text-6xl font-bold text-gray-800"},Bt={class:"text-gray-500"},$t={class:"md:col-span-2 space-y-3"},jt={class:"w-8 text-sm font-medium"},It={class:"flex-1 bg-gray-200 rounded-full h-4 relative overflow-hidden"},Rt={class:"text-sm text-gray-600 w-12 text-right"},Et={class:"mt-12 border-t pt-12"},Pt={class:"text-2xl font-bold text-center mb-8"},Tt={key:0,class:"max-w-2xl mx-auto space-y-6"},Lt={class:"text-center"},zt=["placeholder"],Mt=["disabled"],Ut={key:0,class:"text-red-500 text-center font-medium"},Nt={key:1,class:"text-center py-12 bg-gray-50 rounded-2xl"},Qt={class:"text-gray-600 mb-6 text-lg"},Gt={key:0,class:"mt-12 space-y-8"},Ht={class:"text-2xl font-bold text-gray-800 border-b pb-4"},Jt={class:"flex items-center justify-between mb-4"},Wt={class:"flex items-center gap-4"},Yt={class:"w-12 h-12 bg-gray-200 rounded-full flex items-center justify-center text-xl font-bold text-gray-600"},Kt={class:"font-semibold text-lg"},Xt={class:"text-sm text-gray-500"},Zt={class:"text-gray-700 leading-relaxed pl-16"},ea={key:0,class:"text-center mt-8"},ta={class:"text-[#A6853B] font-bold hover:underline"},aa={key:1,class:"text-center py-16 text-gray-500 text-lg"},sa={key:5,class:"mt-12"},la={__name:"product-details",setup(oa){const{t:s,locale:y}=Se(),H=Ce(),F=De(),T=Ve(),C=Ae(),n=_({}),q=_([]),b=_(""),w=_(1),D=_(!0),k=_(null),B=_(!1),$=_(!1),g=_([]),L=_(!1),z=_(!1),j=_(null),m=_({rating:2,comment:""}),I=_({}),J=_([]),r=_(null),de=O(()=>{let a=[...q.value];if(r.value&&r.value.variant_image.length){const e=r.value.variant_image[0].url;q.value.find(d=>d.url===e)||a.unshift(r.value.variant_image[0])}return a.filter((e,d,p)=>d===p.findIndex(f=>f.url===e.url))}),R=O(()=>{let a=parseFloat(n.value.base_price||0),e=parseFloat(n.value.base_price_after_discount||0),d=parseFloat(n.value.total_discounts_value||0);if(r.value){const h=parseFloat(r.value.price||0);a=h,e=h,d=0}const p=d>0,f=a?Math.round(d/a*100):0;return{base_price:a.toFixed(2),after_discount:e.toFixed(2),has_discount:p,discount_percentage:f}}),K=a=>parseFloat(a||0).toFixed(2),M=O(()=>y.value==="en"?n.value.description_en||s("product.noDescription"):n.value.description_ar||s("product.noDescription")),X=O(()=>M.value.length>300),ve=O(()=>X.value?M.value.slice(0,300)+"...":M.value),W=O(()=>g.value.length?g.value.reduce((e,d)=>e+d.rate,0)/g.value.length:0),_e=O(()=>{const a={5:0,4:0,3:0,2:0,1:0};g.value.forEach(d=>a[d.rate]++);const e=g.value.length;return[5,4,3,2,1].map(d=>({stars:d,count:a[d],percentage:e?Math.round(a[d]/e*100):0}))}),ge=O(()=>g.value.slice(0,5)),pe=a=>b.value=a,me=()=>L.value=!L.value,fe=a=>a?new Date(a).toLocaleDateString(y.value==="ar"?"ar-EG":"en-US",{year:"numeric",month:"short",day:"numeric"}):"",Z=a=>{var d;y.value==="en"?a.value_en:a.value_ar;const e=J.value.find(p=>p.weight===a.value_en);e?(r.value={...e,isOutOfStock:n.value.is_stock===0,in_cart:n.value.in_cart},e.variant_image&&e.variant_image.length>0?b.value=e.variant_image[0].url:b.value=n.value.key_default_image||((d=q.value[0])==null?void 0:d.url)||"",w.value=r.value.in_cart&&n.value.quantity||1):r.value=null},he=async()=>{var a,e;if(!T.authenticatedweb)return F.push({name:"authlog"});if(!(!r.value||r.value.isOutOfStock||B.value)){B.value=!0;try{await Q.post("/api/cart/add",{product_id:n.value.id,variant_id:r.value.variant_id,quantity:1}),r.value.in_cart=!0,w.value=1,C.add({severity:"success",summary:s("success"),detail:s("cart.added"),life:3e3})}catch(d){C.add({severity:"error",detail:((e=(a=d.response)==null?void 0:a.data)==null?void 0:e.message)||s("cart.error"),life:3e3})}finally{B.value=!1}}},ee=async a=>{if(!T.authenticatedweb||$.value||!r.value||r.value.isOutOfStock)return;const e=a==="plus"?w.value+1:w.value-1;if(!(e<1)){$.value=!0;try{await Q.post("/api/cart/update",{product_id:n.value.id,variant_id:r.value.variant_id,quantity:e}),w.value=e,C.add({severity:"success",detail:s(a==="plus"?"cart.quantityIncreased":"cart.quantityDecreased"),life:2e3})}catch{C.add({severity:"error",detail:s("cart.quantityError"),life:3e3})}finally{$.value=!1}}},xe=()=>{if(!r.value){C.add({severity:"warn",summary:s("warning"),detail:s("product.selectVariant")||"Please select a variant.",life:3e3});return}r.value.in_cart||r.value.isOutOfStock||he()},ye=async()=>{var a,e,d;if(m.value.rating===0||!m.value.comment.trim()){j.value=s("reviews.requiredFields");return}z.value=!0,j.value=null;try{const p={model_id:H.params.id,rate:m.value.rating,type:"product",message:m.value.comment.trim()},{data:f}=await Q.post("/api/review",p);f.is_success&&(g.value.unshift({id:f.data.id||Date.now(),rate:m.value.rating,message:m.value.comment.trim(),user:{name:((a=T.user)==null?void 0:a.name)||"You"},created_at:new Date().toISOString()}),m.value={rating:0,comment:""},C.add({severity:"success",summary:s("success"),detail:s("reviews.submitSuccess"),life:4e3}))}catch(p){j.value=((d=(e=p.response)==null?void 0:e.data)==null?void 0:d.message)||s("reviews.submitError")}finally{z.value=!1}},be=a=>a&&F.push(a.has_subcategories?{name:"subcategory",params:{id:a.id}}:{name:"produts_category",params:{id:a.id}}),we=a=>a&&F.push({name:"products-brand",params:{id:a.id}}),ke=a=>a&&F.push(a.has_market?{name:"stores-hasmarket"}:{name:"home"}),te=async()=>{var a,e,d,p,f;D.value=!0,k.value=null,r.value=null;try{const{data:h}=await Q.get(`/api/home/product-details/${H.params.id}`);if(h.is_success){const x=h.data.product;n.value={...x,in_cart:!!x.in_cart,isOutOfStock:x.is_stock===0},q.value=x.media||[],g.value=x.reviews||[];const E=h.data.variants_details||{};if(I.value=E.attributes||{},J.value=(E.combinations||[]).map(S=>S),J.value.length>0){const S=Object.keys(I.value)[0];S&&Z(I.value[S][0])}else r.value={variant_id:null,isOutOfStock:n.value.isOutOfStock,in_cart:n.value.in_cart,price:n.value.base_price,variant_image:x.media,quantity:x.in_cart&&x.quantity||1};(e=(a=r.value)==null?void 0:a.variant_image)!=null&&e.length?b.value=r.value.variant_image[0].url:b.value=n.value.key_default_image||((d=q.value[0])==null?void 0:d.url)||"",w.value=r.value.in_cart&&r.value.quantity||1}else k.value=s("product.notFound")}catch(h){console.error("Fetch error:",h),k.value=((f=(p=h.response)==null?void 0:p.data)==null?void 0:f.message)||s("product.loadError")}finally{D.value=!1}};return Fe(()=>H.params.id,a=>{a&&(te(),window.scrollTo(0,0))}),qe(()=>{window.scrollTo(0,0),te()}),(a,e)=>{var d,p,f,h,x,E,S,ae,se,le,oe,re,ne,ie,ue,ce;return i(),u("div",Pe,[D.value?(i(),u("div",Te,[A(o(Ie),{style:{width:"50px",height:"50px"},strokeWidth:"4"}),t("p",Le,l(o(s)("loading")),1)])):v("",!0),k.value?(i(),u("div",ze,l(k.value),1)):(i(),u("header",Me,[t("div",Ue,[t("div",Ne,[(i(!0),u(U,null,N(de.value,c=>(i(),u("img",{key:c.url,src:c.url,alt:o(s)("product.thumbnailAlt"),class:Y(["h-20 w-20 object-contain rounded-lg cursor-pointer border-2 transition-all duration-200 hover:border-blue-500",{"border-blue-500 opacity-100":b.value===c.url,"border-gray-300 opacity-70":b.value!==c.url}]),onClick:V=>pe(c.url)},null,10,Qe))),128))]),t("div",Ge,[t("div",He,[n.value.is_best_seller?(i(),u("div",Je," Best Seller ")):v("",!0),n.value.is_free_shipping?(i(),u("div",We,[e[8]||(e[8]=t("i",{class:"pi pi-truck"},null,-1)),Be(" "+l(o(s)("products.Free_Delivery")),1)])):v("",!0),t("img",{src:b.value||n.value.key_default_image,alt:o(y)==="en"?n.value.name_en:n.value.name_ar,class:"w-full h-full object-contain transition-transform duration-700 hover:scale-105",loading:"lazy"},null,8,Ye)])])]),t("div",Ke,[t("div",Xe,[t("section",Ze,[n.value.store_id?(i(),u("span",{key:0,onClick:e[0]||(e[0]=c=>ke(n.value.store)),class:"sub-tiles cursor-pointer"},l(o(y)==="en"?(d=n.value.store)==null?void 0:d.name_en:((p=n.value.store)==null?void 0:p.name_ar)||o(s)("store.default")),1)):v("",!0),n.value.category?(i(),u("span",{key:1,onClick:e[1]||(e[1]=c=>be(n.value.category)),class:"sub-tiles cursor-pointer"},l(o(y)==="en"?n.value.category.name_en:n.value.category.name_ar),1)):v("",!0),n.value.brand_id?(i(),u("span",{key:2,onClick:e[2]||(e[2]=c=>we(n.value.brand)),class:"sub-tiles cursor-pointer"},l(o(y)==="en"?(f=n.value.brand)==null?void 0:f.name_en:((h=n.value.brand)==null?void 0:h.name_ar)||o(s)("brand.default")),1)):v("",!0)]),t("h1",et,l(o(y)==="en"?n.value.name_en:n.value.name_ar),1),n.value.sub_name_en||n.value.sub_name_ar?(i(),u("h2",tt,l(o(y)==="en"?n.value.sub_name_en:n.value.sub_name_ar),1)):v("",!0),t("div",at,[A(o(G),{modelValue:W.value,readonly:!0,cancel:!1,class:"text-lg"},null,8,["modelValue"]),t("span",st,"("+l(g.value.length)+" "+l(g.value.length===1?o(s)("reviews.singular"):o(s)("reviews.plural"))+")",1)]),e[10]||(e[10]=t("hr",{class:"bg-gradient-to-r from-transparent via-[#A17D1C] to-transparent h-0.5 my-8"},null,-1)),n.value.has_variants&&I.value.weight?(i(),u("section",lt,[t("div",ot,[(i(!0),u(U,null,N(I.value.weight,c=>{var V,P;return i(),u("button",{key:c.value_en,onClick:ra=>Z(c),class:Y([{"border-blue-600 ring-4 ring-blue-100":((V=r.value)==null?void 0:V.weight)===c.value_en,"border-gray-300 hover:border-blue-400":((P=r.value)==null?void 0:P.weight)!==c.value_en},"px-4 py-2 text-sm font-medium border-2 rounded-lg transition-all duration-200"])},l(o(y)==="en"?c.value_en:c.value_ar),11,rt)}),128))]),r.value&&r.value.isOutOfStock?(i(),u("p",nt,l(o(s)("product.outOfStock")),1)):v("",!0)])):v("",!0),t("div",it,[t("div",ut,[t("span",ct,l(K(R.value.after_discount))+" "+l(a.$t("currencyLabel")),1),R.value.has_discount?(i(),u("span",dt,l(K(R.value.base_price))+" "+l(a.$t("currencyLabel")),1)):v("",!0),R.value.has_discount?(i(),u("span",vt," -"+l(R.value.discount_percentage)+"% ",1)):v("",!0)])]),(x=r.value)!=null&&x.in_cart?(i(),u("div",_t,[t("label",gt,l(o(s)("product.quantity"))+":",1),t("div",pt,[t("button",{onClick:e[3]||(e[3]=c=>ee("minus")),disabled:w.value<=1||$.value||((E=r.value)==null?void 0:E.isOutOfStock),class:"px-5 py-3 text-2xl font-bold hover:bg-gray-100 disabled:opacity-50 transition"},"âˆ’",8,mt),t("span",ft,l(w.value),1),t("button",{onClick:e[4]||(e[4]=c=>ee("plus")),disabled:$.value||((S=r.value)==null?void 0:S.isOutOfStock),class:"px-5 py-3 text-2xl font-bold hover:bg-gray-100 disabled:opacity-50 transition"},"+",8,ht)])])):v("",!0),t("button",{onClick:xe,disabled:B.value||((ae=r.value)==null?void 0:ae.isOutOfStock),class:Y(["w-full py-5 text-xl font-bold rounded-2xl text-white transition-all duration-300 shadow-lg hover:shadow-xl active:scale-95 flex items-center justify-center gap-3",{"bg-[#A6853B] hover:bg-[#8f702c]":!((se=r.value)!=null&&se.in_cart)&&!((le=r.value)!=null&&le.isOutOfStock),"bg-[#0b3baa] hover:bg-[#093080]":(oe=r.value)==null?void 0:oe.in_cart,"bg-gray-400 cursor-not-allowed":(re=r.value)==null?void 0:re.isOutOfStock}])},[(ne=r.value)!=null&&ne.in_cart?(i(),u("svg",yt,e[9]||(e[9]=[t("path",{d:"M9 16.2l-3.5-3.5a.984.984 0 0 0-1.4 0 .984.984 0 0 0 0 1.4l4.2 4.2c.39.39 1.01.39 1.4 0l8.4-8.4a.984.984 0 0 0 0-1.4.984.984 0 0 0-1.4 0L9 16.2z"},null,-1)]))):v("",!0),(ie=r.value)!=null&&ie.in_cart?(i(),u("span",bt,l(o(s)("product.inCart")),1)):(ue=r.value)!=null&&ue.isOutOfStock?(i(),u("span",wt,l(o(s)("product.outOfStock")),1)):(i(),u("span",kt,l(B.value?o(s)("product.adding")+"...":o(s)("product.addToCart")),1))],10,xt),(ce=r.value)!=null&&ce.isOutOfStock?(i(),u("p",Ot,l(o(s)("product.outOfStock")),1)):v("",!0)])])])),!D.value&&!k.value?(i(),u("section",St,[t("p",Ct,l(L.value?M.value:ve.value),1),X.value?(i(),u("button",{key:0,onClick:me,class:"mt-4 text-[#E39F30] font-bold text-sm hover:underline focus:outline-none"},l(L.value?o(s)("product.readLess"):o(s)("product.readMore")),1)):v("",!0)])):v("",!0),!D.value&&!k.value?(i(),u("section",Dt,[t("h2",Vt,l(o(s)("reviews.title")),1),t("div",At,[t("div",Ft,[t("div",qt,l(W.value.toFixed(1)),1),A(o(G),{modelValue:W.value,readonly:!0,cancel:!1,class:"my-4 justify-center text-3xl"},null,8,["modelValue"]),t("p",Bt,l(g.value.length)+" "+l(g.value.length===1?o(s)("reviews.singular"):o(s)("reviews.plural")),1)]),t("div",$t,[(i(!0),u(U,null,N(_e.value,c=>(i(),u("div",{key:c.stars,class:"flex items-center gap-3"},[t("span",jt,l(c.stars),1),t("div",It,[t("div",{class:"absolute top-0 left-0 h-full bg-[#A6853B] transition-all duration-700 ease-out",style:Re({width:c.percentage+"%"})},null,4)]),t("span",Rt,l(c.count),1)]))),128))])]),t("div",Et,[t("h3",Pt,l(o(s)("reviews.writeReview")),1),o(T).authenticatedweb?(i(),u("div",Tt,[t("div",Lt,[A(o(G),{modelValue:m.value.rating,"onUpdate:modelValue":e[5]||(e[5]=c=>m.value.rating=c),stars:5,cancel:!1,class:"text-4xl justify-center"},null,8,["modelValue"])]),$e(t("textarea",{"onUpdate:modelValue":e[6]||(e[6]=c=>m.value.comment=c),rows:"6",class:"w-full p-5 border border-gray-300 rounded-xl focus:ring-4 focus:ring-[#A6853B]/20 focus:border-[#A6853B] outline-none resize-none transition",placeholder:o(s)("reviews.placeholder")},null,8,zt),[[je,m.value.comment]]),t("button",{onClick:ye,disabled:z.value||m.value.rating===0||!m.value.comment.trim(),class:"w-full py-4 bg-[#A6853B] hover:bg-[#8f702c] text-white font-bold rounded-xl transition disabled:opacity-50 disabled:cursor-not-allowed shadow-lg hover:shadow-xl"},l(z.value?o(s)("reviews.submitting")+"...":o(s)("reviews.submit")),9,Mt),j.value?(i(),u("p",Ut,l(j.value),1)):v("",!0)])):(i(),u("div",Nt,[t("p",Qt,l(o(s)("reviews.loginToReview")),1),t("button",{onClick:e[7]||(e[7]=c=>o(F).push({name:"authlog"})),class:"px-10 py-4 bg-[#A6853B] text-white font-bold rounded-xl hover:bg-[#8f702c] transition shadow-lg"},l(o(s)("reviews.login")),1)]))]),g.value.length?(i(),u("div",Gt,[t("h3",Ht,l(o(s)("reviews.customerReviews")),1),(i(!0),u(U,null,N(ge.value,c=>{var V,P;return i(),u("div",{key:c.id,class:"border-b pb-8 last:border-0"},[t("div",Jt,[t("div",Wt,[t("div",Yt,l((((V=c.user)==null?void 0:V.name)||"A")[0].toUpperCase()),1),t("div",null,[t("p",Kt,l(((P=c.user)==null?void 0:P.name)||o(s)("reviews.anonymous")),1),A(o(G),{modelValue:c.rate,readonly:!0,cancel:!1},null,8,["modelValue"])])]),t("span",Xt,l(fe(c.created_at)),1)]),t("p",Zt,l(c.message),1)])}),128)),g.value.length>5?(i(),u("div",ea,[t("button",ta,l(o(s)("reviews.viewAll"))+" ("+l(g.value.length)+") ",1)])):v("",!0)])):(i(),u("div",aa,l(o(s)("reviews.noReviews")),1))])):v("",!0),!D.value&&!k.value?(i(),u("section",sa,[A(Ee)])):v("",!0)])}}},ua=Oe(la,[["__scopeId","data-v-9f723cef"]]);export{ua as default};
