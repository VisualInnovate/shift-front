import{_ as Ve,u as je,p as Fe,l as Be,z as $e,a as Re,r as p,c as b,x as qe,o as Ie,e as n,h as r,i as F,j as l,g as t,t as o,n as _,F as L,m as z,v as Pe,A as J,B as Te,D as Ee,b as X,s as Le,K as G,L as ve}from"./index-7be5bfc6.js";import{P as ze}from"./ProductOffers-94194c57.js";const Me={class:"product-page max-w-7xl mx-auto p-4 lg:p-8"},Ne={key:0,class:"text-center py-20"},Ue={class:"mt-4 text-gray-600"},Qe={key:1,class:"text-red-500 text-center py-10 text-lg"},Ge={key:2,class:"flex flex-col lg:flex-row items-start gap-8 lg:gap-12"},Ke={class:"w-full lg:w-1/2 flex flex-col-reverse lg:flex-row items-center gap-4"},We={class:"flex lg:flex-col flex-row items-center justify-center lg:justify-start gap-3 w-full lg:w-1/4 order-2 lg:order-1"},He=["src","alt","onClick"],Je={class:"w-full lg:w-3/4 order-1 lg:order-2"},Xe={class:"relative w-full aspect-square shadow-xl rounded-2xl overflow-hidden bg-gray-50"},Ye={key:0,class:"absolute top-4 left-4 z-10 bg-black text-white text-xs font-bold px-4 py-2 rounded-full uppercase tracking-wider shadow-lg"},Ze={key:1,class:"absolute top-4 right-4 z-10 bg-green-600 text-white text-xs font-bold px-4 py-2 rounded-full flex items-center gap-2 shadow-lg"},et=["src","alt"],tt={class:"w-full lg:w-1/2"},at={class:"bg-white rounded-2xl shadow-lg p-6 lg:p-8"},st={class:"flex flex-wrap gap-3 mb-6"},lt={class:"text-3xl lg:text-4xl font-bold text-gray-800 mb-3 leading-tight"},ot={key:0,class:"text-xl text-gray-600 mb-6"},nt={class:"flex items-center gap-3 mb-6"},rt={class:"text-gray-600"},it={key:1,class:"mb-8 space-y-6"},ut={class:"flex flex-wrap gap-3"},ct=["onClick"],dt={key:0,class:"text-red-600 font-semibold mt-3"},vt={key:1,class:"text-orange-600 font-medium mt-3"},_t={class:"mb-8"},pt={class:"flex items-baseline gap-4 flex-wrap"},gt={class:"text-4xl font-bold text-gray-900"},ft={key:0,class:"text-2xl font-bold text-[#0b3baa] line-through opacity-80"},ht={key:1,class:"bg-red-100 text-red-800 text-sm font-bold px-3 py-1 rounded-full"},mt={key:2,class:"flex items-center gap-6 mb-8"},xt={class:"font-bold text-gray-700 text-lg"},bt={class:"flex items-center border-2 border-gray-300 rounded-xl overflow-hidden select-none"},yt=["disabled"],wt={class:"px-8 py-3 font-semibold text-lg border-x-2 border-gray-300 min-w-20 text-center"},kt=["disabled"],Ot=["disabled"],Ct={key:0,class:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24"},St={key:1},Dt={key:2},At={key:3},Vt={key:3,class:"text-red-600 font-semibold text-center mt-4"},jt={key:3,class:"bg-[#E6AC312B] px-8 py-10 rounded-2xl mt-12"},Ft={class:"text-gray-700 leading-relaxed text-base"},Bt={key:4,class:"mt-12 p-8 bg-white rounded-2xl shadow-xl"},$t={class:"text-3xl font-bold text-center text-gray-800 mb-10"},Rt={class:"grid md:grid-cols-3 gap-8 mb-12"},qt={class:"text-center"},It={class:"text-6xl font-bold text-gray-800"},Pt={class:"text-gray-500"},Tt={class:"md:col-span-2 space-y-3"},Et={class:"w-8 text-sm font-medium"},Lt={class:"flex-1 bg-gray-200 rounded-full h-4 relative overflow-hidden"},zt={class:"text-sm text-gray-600 w-12 text-right"},Mt={class:"mt-12 border-t pt-12"},Nt={class:"text-2xl font-bold text-center mb-8"},Ut={key:0,class:"max-w-2xl mx-auto space-y-6"},Qt={class:"text-center"},Gt=["placeholder"],Kt=["disabled"],Wt={key:0,class:"text-red-500 text-center font-medium"},Ht={key:1,class:"text-center py-12 bg-gray-50 rounded-2xl"},Jt={class:"text-gray-600 mb-6 text-lg"},Xt={key:0,class:"mt-12 space-y-8"},Yt={class:"text-2xl font-bold text-gray-800 border-b pb-4"},Zt={class:"flex items-center justify-between mb-4"},ea={class:"flex items-center gap-4"},ta={class:"w-12 h-12 bg-gray-200 rounded-full flex items-center justify-center text-xl font-bold text-gray-600"},aa={class:"font-semibold text-lg"},sa={class:"text-sm text-gray-500"},la={class:"text-gray-700 leading-relaxed pl-16"},oa={key:1,class:"text-center py-16 text-gray-500 text-lg"},na={key:5,class:"mt-12"},_e="https://via.placeholder.com/600?text=No+Image",ra={__name:"product-details",setup(ia){const{t:i,locale:y}=je(),Y=Fe(),B=Be(),K=$e(),$=Re(),a=p({}),W=p([]),k=p(""),O=p(1),D=p(!0),C=p(null),R=p(!1),q=p(!1),f=p([]),M=p(!1),Z=p(!1),ee=p(null),A=p({rating:0,comment:""}),V=p({}),N=p([]),j=p({}),u=p(null),pe=b(()=>{var s;let e=[...W.value];if((s=u.value)!=null&&s.image){const c=u.value.image;e.some(v=>v.url===c)||e.unshift({url:c})}return e.filter((c,v,g)=>g.findIndex(x=>x.url===c.url)===v)}),I=b(()=>{let e=parseFloat(a.value.base_price||0),s=parseFloat(a.value.base_price_after_discount||e),c=parseFloat(a.value.total_discounts_value||0);u.value&&u.value.price&&(e=parseFloat(u.value.price),s=e,c=0);const v=c>0,g=e?Math.round(c/e*100):0;return{base_price:e.toFixed(2),after_discount:s.toFixed(2),has_discount:v,discount_percentage:g}}),P=b(()=>a.value.has_variants?u.value!==null:!0),ge=b(()=>Object.keys(j.value).length>0&&u.value===null),U=b(()=>y.value==="en"?a.value.description_en||i("product.noDescription"):a.value.description_ar||i("product.noDescription")),te=b(()=>U.value.length>300),fe=b(()=>te.value?U.value.slice(0,300)+"...":U.value),H=b(()=>f.value.length?f.value.reduce((e,s)=>e+s.rate,0)/f.value.length:0),he=b(()=>{const e={1:0,2:0,3:0,4:0,5:0};f.value.forEach(c=>e[c.rate]++);const s=f.value.length;return[5,4,3,2,1].map(c=>({stars:c,count:e[c],percentage:s?Math.round(e[c]/s*100):0}))}),me=b(()=>f.value.slice(0,5)),ae=e=>parseFloat(e||0).toFixed(2),xe=e=>k.value=e,be=()=>M.value=!M.value,ye=e=>new Date(e).toLocaleDateString(y.value==="ar"?"ar-EG":"en-US",{year:"numeric",month:"short",day:"numeric"}),se=(e,s)=>{var c;return((c=j.value[e])==null?void 0:c.id)===s.id},we=(e,s)=>{const c={...j.value,[e]:s};j.value=c;const v=N.value.find(g=>Object.keys(c).every(x=>{var w;const h=c[x].id;return((w=g.attributes[x])==null?void 0:w.id)===h}));v&&Object.keys(c).length===Object.keys(V.value).length?(u.value={...v,variant_id:v.variant_id,price:v.price,image:v.image,isOutOfStock:a.value.is_stock===0,in_cart:a.value.in_cart},v.image&&(k.value=v.image),O.value=a.value.in_cart&&a.value.quantity||1):u.value=null},ke=async()=>{var e,s;if(!K.authenticatedweb)return B.push({name:"authlog"});if(!(!u.value||R.value)){R.value=!0;try{await X.post("/api/cart/add",{product_id:a.value.id,variant_id:u.value.variant_id||null,quantity:1}),u.value.in_cart=!0,a.value.in_cart=!0,O.value=1,$.add({severity:"success",summary:i("success"),detail:i("cart.added"),life:3e3})}catch(c){$.add({severity:"error",detail:((s=(e=c.response)==null?void 0:e.data)==null?void 0:s.message)||i("cart.error"),life:3e3})}finally{R.value=!1}}},le=async e=>{if(!K.authenticatedweb||q.value||!u.value)return;const s=e==="plus"?O.value+1:O.value-1;if(!(s<1)){q.value=!0;try{await X.post("/api/cart/update",{product_id:a.value.id,variant_id:u.value.variant_id||null,quantity:s}),O.value=s,$.add({severity:"success",detail:i(e==="plus"?"cart.quantityIncreased":"cart.quantityDecreased"),life:2e3})}catch{$.add({severity:"error",detail:i("cart.quantityError"),life:3e3})}finally{q.value=!1}}},Oe=()=>{var e;if(!P.value){$.add({severity:"warn",detail:i("product.selectVariant")||"Please select all options",life:3e3});return}(e=u.value)!=null&&e.in_cart||ke()},Ce=async()=>{},Se=e=>e&&B.push(e.has_subcategories?{name:"subcategory",params:{id:e.id}}:{name:"produts_category",params:{id:e.id}}),De=e=>e&&B.push({name:"products-brand",params:{id:e.id}}),Ae=e=>e&&B.push(e.has_market?{name:"stores-hasmarket"}:{name:"home"}),oe=async()=>{var e,s,c;D.value=!0,C.value=null,j.value={},u.value=null;try{const{data:v}=await X.get(`/api/home/product-details/${Y.params.id}`);if(v.is_success){const g=v.data.product;a.value={...g,in_cart:!!g.in_cart,isOutOfStock:g.is_stock===0},W.value=g.media||[],f.value=g.reviews||[];const x=v.data.variants_details||{};if(V.value=x.attributes||{},N.value=(x.combinations||[]).map(h=>({...h,image:h.image})),N.value.length>0){const h=N.value[0];u.value={...h,isOutOfStock:a.value.is_stock===0,in_cart:a.value.in_cart},Object.keys(V.value).forEach(w=>{const T=V.value[w].find(Q=>{var E;return Q.id===((E=h.attributes[w])==null?void 0:E.id)});T&&(j.value[w]=T)}),h.image&&(k.value=h.image)}else a.value.has_variants||(u.value={variant_id:null,price:a.value.base_price,image:null,isOutOfStock:a.value.isOutOfStock,in_cart:a.value.in_cart});k.value=k.value||a.value.key_default_image||((e=W.value[0])==null?void 0:e.url)||_e,O.value=a.value.in_cart&&a.value.quantity||1}else C.value=i("product.notFound")}catch(v){C.value=((c=(s=v.response)==null?void 0:s.data)==null?void 0:c.message)||i("product.loadError")}finally{D.value=!1}};return qe(()=>Y.params.id,e=>{e&&oe(),window.scrollTo(0,0)}),Ie(()=>{window.scrollTo(0,0),oe()}),(e,s)=>{var c,v,g,x,h,w,T,Q,E,ne,re,ie,ue,ce,de;return n(),r("div",Me,[D.value?(n(),r("div",Ne,[F(l(Le),{style:{width:"50px",height:"50px"},strokeWidth:"4"}),t("p",Ue,o(l(i)("loading")),1)])):_("",!0),C.value?(n(),r("div",Qe,o(C.value),1)):(n(),r("header",Ge,[t("div",Ke,[t("div",We,[(n(!0),r(L,null,z(pe.value,d=>(n(),r("img",{key:d.url,src:d.url,alt:l(i)("product.thumbnailAlt"),class:J(["h-20 w-20 object-contain rounded-lg cursor-pointer border-2 transition-all duration-200 hover:border-blue-500",{"border-blue-500 opacity-100":k.value===d.url,"border-gray-300 opacity-70":k.value!==d.url}]),onClick:S=>xe(d.url)},null,10,He))),128))]),t("div",Je,[t("div",Xe,[a.value.is_best_seller?(n(),r("div",Ye," Best Seller ")):_("",!0),a.value.is_free_shipping?(n(),r("div",Ze,[s[8]||(s[8]=t("i",{class:"pi pi-truck"},null,-1)),Pe(" "+o(l(i)("products.Free_Delivery")),1)])):_("",!0),t("img",{src:k.value||a.value.key_default_image||_e,alt:l(y)==="en"?a.value.name_en:a.value.name_ar,class:"w-full h-full object-contain transition-transform duration-700 hover:scale-105",loading:"lazy"},null,8,et)])])]),t("div",tt,[t("div",at,[t("section",st,[a.value.store_id?(n(),r("span",{key:0,onClick:s[0]||(s[0]=d=>Ae(a.value.store)),class:"sub-tiles cursor-pointer"},o(l(y)==="en"?(c=a.value.store)==null?void 0:c.name_en:((v=a.value.store)==null?void 0:v.name_ar)||l(i)("store.default")),1)):_("",!0),a.value.category?(n(),r("span",{key:1,onClick:s[1]||(s[1]=d=>Se(a.value.category)),class:"sub-tiles cursor-pointer"},o(l(y)==="en"?a.value.category.name_en:a.value.category.name_ar),1)):_("",!0),a.value.brand_id?(n(),r("span",{key:2,onClick:s[2]||(s[2]=d=>De(a.value.brand)),class:"sub-tiles cursor-pointer"},o(l(y)==="en"?(g=a.value.brand)==null?void 0:g.name_en:((x=a.value.brand)==null?void 0:x.name_ar)||l(i)("brand.default")),1)):_("",!0)]),t("h1",lt,o(l(y)==="en"?a.value.name_en:a.value.name_ar),1),a.value.sub_name_en||a.value.sub_name_ar?(n(),r("h2",ot,o(l(y)==="en"?a.value.sub_name_en:a.value.sub_name_ar),1)):_("",!0),t("div",nt,[F(l(G),{modelValue:H.value,readonly:!0,cancel:!1,class:"text-lg"},null,8,["modelValue"]),t("span",rt,"("+o(f.value.length)+" "+o(f.value.length===1?l(i)("reviews.singular"):l(i)("reviews.plural"))+")",1)]),s[10]||(s[10]=t("hr",{class:"bg-gradient-to-r from-transparent via-[#A17D1C] to-transparent h-0.5 my-8"},null,-1)),a.value.has_variants&&Object.keys(V.value).length?(n(),r("section",it,[(n(!0),r(L,null,z(V.value,(d,S)=>(n(),r("div",{key:S,class:"space-y-2"},[t("div",ut,[(n(!0),r(L,null,z(d,m=>(n(),r("button",{key:m.id,onClick:ua=>we(S,m),class:J([{"border-blue-600 ring-4 ring-blue-100":se(S,m),"border-gray-300 hover:border-blue-400":!se(S,m)},"px-4 py-2 text-sm font-medium border-2 rounded-lg transition-all duration-200 flex items-center gap-2"])},[m.is_color?(n(),r("span",{key:0,class:"w-6 h-6 rounded-full border-2 border-gray-300",style:ve({backgroundColor:m.value_en})},null,4)):_("",!0),t("span",null,o(l(y)==="en"?m.value_en:m.value_ar),1)],10,ct))),128))])]))),128)),u.value&&u.value.isOutOfStock?(n(),r("p",dt,o(l(i)("product.outOfStock")),1)):u.value===null&&ge.value?(n(),r("p",vt,o(l(i)("product.selectAllVariants")||"Please select all options"),1)):_("",!0)])):_("",!0),t("div",_t,[t("div",pt,[t("span",gt,o(ae(I.value.after_discount))+" "+o(e.$t("currencyLabel")),1),I.value.has_discount?(n(),r("span",ft,o(ae(I.value.base_price))+" "+o(e.$t("currencyLabel")),1)):_("",!0),I.value.has_discount?(n(),r("span",ht," -"+o(I.value.discount_percentage)+"% ",1)):_("",!0)])]),(h=u.value)!=null&&h.in_cart?(n(),r("div",mt,[t("label",xt,o(l(i)("product.quantity"))+":",1),t("div",bt,[t("button",{onClick:s[3]||(s[3]=d=>le("minus")),disabled:O.value<=1||q.value||((w=u.value)==null?void 0:w.isOutOfStock),class:"px-5 py-3 text-2xl font-bold hover:bg-gray-100 disabled:opacity-50 transition"},"âˆ’",8,yt),t("span",wt,o(O.value),1),t("button",{onClick:s[4]||(s[4]=d=>le("plus")),disabled:q.value||((T=u.value)==null?void 0:T.isOutOfStock),class:"px-5 py-3 text-2xl font-bold hover:bg-gray-100 disabled:opacity-50 transition"},"+",8,kt)])])):_("",!0),t("button",{onClick:Oe,disabled:R.value||((Q=u.value)==null?void 0:Q.isOutOfStock)||!P.value,class:J(["w-full py-5 text-xl font-bold rounded-2xl text-white transition-all duration-300 shadow-lg hover:shadow-xl active:scale-95 flex items-center justify-center gap-3",{"bg-[#A6853B] hover:bg-[#8f702c]":!((E=u.value)!=null&&E.in_cart)&&P.value,"bg-[#0b3baa] hover:bg-[#093080]":(ne=u.value)==null?void 0:ne.in_cart,"bg-gray-400 cursor-not-allowed":((re=u.value)==null?void 0:re.isOutOfStock)||!P.value}])},[(ie=u.value)!=null&&ie.in_cart?(n(),r("svg",Ct,s[9]||(s[9]=[t("path",{d:"M9 16.2l-3.5-3.5a.984.984 0 0 0-1.4 0 .984.984 0 0 0 0 1.4l4.2 4.2c.39.39 1.01.39 1.4 0l8.4-8.4a.984.984 0 0 0 0-1.4.984.984 0 0 0-1.4 0L9 16.2z"},null,-1)]))):_("",!0),(ue=u.value)!=null&&ue.in_cart?(n(),r("span",St,o(l(i)("product.inCart")),1)):(ce=u.value)!=null&&ce.isOutOfStock||!P.value?(n(),r("span",Dt,o(l(i)("product.outOfStock")),1)):(n(),r("span",At,o(R.value?l(i)("product.adding")+"...":l(i)("product.addToCart")),1))],10,Ot),(de=u.value)!=null&&de.isOutOfStock?(n(),r("p",Vt,o(l(i)("product.outOfStock")),1)):_("",!0)])])])),!D.value&&!C.value?(n(),r("section",jt,[t("p",Ft,o(M.value?U.value:fe.value),1),te.value?(n(),r("button",{key:0,onClick:be,class:"mt-4 text-[#E39F30] font-bold text-sm hover:underline focus:outline-none"},o(M.value?l(i)("product.readLess"):l(i)("product.readMore")),1)):_("",!0)])):_("",!0),!D.value&&!C.value?(n(),r("section",Bt,[t("h2",$t,o(l(i)("reviews.title")),1),t("div",Rt,[t("div",qt,[t("div",It,o(H.value.toFixed(1)),1),F(l(G),{modelValue:H.value,readonly:!0,cancel:!1,class:"my-4 justify-center text-3xl"},null,8,["modelValue"]),t("p",Pt,o(f.value.length)+" "+o(f.value.length===1?l(i)("reviews.singular"):l(i)("reviews.plural")),1)]),t("div",Tt,[(n(!0),r(L,null,z(he.value,d=>(n(),r("div",{key:d.stars,class:"flex items-center gap-3"},[t("span",Et,o(d.stars),1),t("div",Lt,[t("div",{class:"absolute top-0 left-0 h-full bg-[#A6853B] transition-all duration-700 ease-out",style:ve({width:d.percentage+"%"})},null,4)]),t("span",zt,o(d.count),1)]))),128))])]),t("div",Mt,[t("h3",Nt,o(l(i)("reviews.writeReview")),1),l(K).authenticatedweb?(n(),r("div",Ut,[t("div",Qt,[F(l(G),{modelValue:A.value.rating,"onUpdate:modelValue":s[5]||(s[5]=d=>A.value.rating=d),stars:5,cancel:!1,class:"text-4xl justify-center"},null,8,["modelValue"])]),Te(t("textarea",{"onUpdate:modelValue":s[6]||(s[6]=d=>A.value.comment=d),rows:"6",class:"w-full p-5 border border-gray-300 rounded-xl focus:ring-4 focus:ring-[#A6853B]/20 focus:border-[#A6853B] outline-none resize-none transition",placeholder:l(i)("reviews.placeholder")},null,8,Gt),[[Ee,A.value.comment]]),t("button",{onClick:Ce,disabled:Z.value||A.value.rating===0||!A.value.comment.trim(),class:"w-full py-4 bg-[#A6853B] hover:bg-[#8f702c] text-white font-bold rounded-xl transition disabled:opacity-50 disabled:cursor-not-allowed shadow-lg hover:shadow-xl"},o(Z.value?l(i)("reviews.submitting")+"...":l(i)("reviews.submit")),9,Kt),ee.value?(n(),r("p",Wt,o(ee.value),1)):_("",!0)])):(n(),r("div",Ht,[t("p",Jt,o(l(i)("reviews.loginToReview")),1),t("button",{onClick:s[7]||(s[7]=d=>l(B).push({name:"authlog"})),class:"px-10 py-4 bg-[#A6853B] text-white font-bold rounded-xl hover:bg-[#8f702c] transition shadow-lg"},o(l(i)("reviews.login")),1)]))]),f.value.length?(n(),r("div",Xt,[t("h3",Yt,o(l(i)("reviews.customerReviews")),1),(n(!0),r(L,null,z(me.value,d=>{var S,m;return n(),r("div",{key:d.id,class:"border-b pb-8 last:border-0"},[t("div",Zt,[t("div",ea,[t("div",ta,o((((S=d.user)==null?void 0:S.name)||"A")[0].toUpperCase()),1),t("div",null,[t("p",aa,o(((m=d.user)==null?void 0:m.name)||l(i)("reviews.anonymous")),1),F(l(G),{modelValue:d.rate,readonly:!0,cancel:!1},null,8,["modelValue"])])]),t("span",sa,o(ye(d.created_at)),1)]),t("p",la,o(d.message),1)])}),128))])):(n(),r("div",oa,o(l(i)("reviews.noReviews")),1))])):_("",!0),!D.value&&!C.value?(n(),r("section",na,[F(ze)])):_("",!0)])}}},va=Ve(ra,[["__scopeId","data-v-fd4944f5"]]);export{va as default};
