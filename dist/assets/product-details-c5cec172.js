import{_ as je,u as Be,p as $e,l as qe,z as Ie,a as Re,r as p,c as h,x as Ee,o as Pe,e as n,h as i,i as B,j as o,g as s,t as r,n as _,F as L,m as z,v as Te,A as Z,B as Le,D as ze,b as W,s as Me,K as Y,L as de}from"./index-df093464.js";import{P as Ne}from"./ProductOffers-c7f81bad.js";const Ue={class:"product-page max-w-7xl mx-auto p-4 lg:p-8"},Qe={key:0,class:"text-center py-20"},Ge={class:"mt-4 text-gray-600"},Ke={key:1,class:"text-red-500 text-center py-10 text-lg"},We={key:2,class:"flex flex-col lg:flex-row items-start gap-8 lg:gap-12"},Ye={class:"w-full lg:w-1/2 flex flex-col-reverse lg:flex-row items-center gap-4"},He={class:"flex lg:flex-col flex-row items-center justify-center lg:justify-start gap-3 w-full lg:w-1/4 order-2 lg:order-1"},Je=["src","alt","onClick"],Xe={class:"w-full lg:w-3/4 order-1 lg:order-2"},Ze={class:"relative w-full aspect-square shadow-xl rounded-2xl overflow-hidden bg-gray-50"},et={key:0,class:"absolute top-4 left-4 z-10 bg-black text-white text-xs font-bold px-4 py-2 rounded-full uppercase tracking-wider shadow-lg"},tt={key:1,class:"absolute top-4 right-4 z-10 bg-green-600 text-white text-xs font-bold px-4 py-2 rounded-full flex items-center gap-2 shadow-lg"},at=["src","alt"],st={class:"w-full lg:w-1/2"},lt={class:"bg-white rounded-2xl shadow-lg p-6 lg:p-8"},ot={class:"flex flex-wrap gap-3 mb-6"},rt={class:"text-3xl lg:text-4xl font-bold text-gray-800 mb-3 leading-tight"},nt={key:0,class:"text-xl text-gray-600 mb-6"},it={class:"flex items-center gap-3 mb-6"},ut={class:"text-gray-600"},ct={key:1,class:"mb-8 space-y-6"},dt={class:"flex flex-wrap gap-3"},vt=["onClick"],_t={key:1},pt={key:0,class:"text-red-600 font-semibold mt-3"},gt={key:1,class:"text-orange-600 font-medium mt-3"},mt={class:"mb-8"},ft={class:"flex items-baseline gap-4 flex-wrap"},ht={class:"text-4xl font-bold text-gray-900"},yt={key:0,class:"text-2xl font-bold text-[#0b3baa] line-through opacity-80"},bt={key:1,class:"bg-red-100 text-red-800 text-sm font-bold px-3 py-1 rounded-full"},xt={key:2,class:"flex items-center gap-6 mb-8"},wt={class:"font-bold text-gray-700 text-lg"},kt={class:"flex items-center border-2 border-gray-300 rounded-xl overflow-hidden select-none"},Ot=["disabled"],St={class:"px-8 py-3 font-semibold text-lg border-x-2 border-gray-300 min-w-20 text-center"},Ct=["disabled"],Dt=["disabled"],At={key:0,class:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24"},Ft={key:1},Vt={key:2},jt={key:3},Bt={key:3,class:"text-red-600 font-semibold text-center mt-4"},$t={key:3,class:"bg-[#E6AC312B] px-8 py-10 rounded-2xl mt-12"},qt={class:"text-gray-700 leading-relaxed text-base"},It={key:4,class:"mt-12 p-8 bg-white rounded-2xl shadow-xl"},Rt={class:"text-3xl font-bold text-center text-gray-800 mb-10"},Et={class:"grid md:grid-cols-3 gap-8 mb-12"},Pt={class:"text-center"},Tt={class:"text-6xl font-bold text-gray-800"},Lt={class:"text-gray-500"},zt={class:"md:col-span-2 space-y-3"},Mt={class:"w-8 text-sm font-medium"},Nt={class:"flex-1 bg-gray-200 rounded-full h-4 relative overflow-hidden"},Ut={class:"text-sm text-gray-600 w-12 text-right"},Qt={class:"mt-12 border-t pt-12"},Gt={class:"text-2xl font-bold text-center mb-8"},Kt={key:0,class:"max-w-2xl mx-auto space-y-6"},Wt={class:"text-center"},Yt=["placeholder"],Ht=["disabled"],Jt={key:0,class:"text-red-500 text-center font-medium"},Xt={key:1,class:"text-center py-12 bg-gray-50 rounded-2xl"},Zt={class:"text-gray-600 mb-6 text-lg"},ea={key:0,class:"mt-12 space-y-8"},ta={class:"text-2xl font-bold text-gray-800 border-b pb-4"},aa={class:"flex items-center justify-between mb-4"},sa={class:"flex items-center gap-4"},la={class:"w-12 h-12 bg-gray-200 rounded-full flex items-center justify-center text-xl font-bold text-gray-600"},oa={class:"font-semibold text-lg"},ra={class:"text-sm text-gray-500"},na={class:"text-gray-700 leading-relaxed pl-16"},ia={key:1,class:"text-center py-16 text-gray-500 text-lg"},ua={key:5,class:"mt-12"},ve="https://via.placeholder.com/600?text=No+Image",ca={__name:"product-details",setup(da){const{t:l,locale:w}=Be(),H=$e(),$=qe(),M=Ie(),A=Re(),a=p({}),J=p([]),O=p(""),S=p(1),F=p(!0),C=p(null),q=p(!1),I=p(!1),m=p([]),N=p(!1),U=p(!1),R=p(null),f=p({rating:0,comment:""}),V=p({}),Q=p([]),j=p({}),c=p(null),_e=h(()=>parseFloat(a.value.base_price||0).toFixed(2)),pe=h(()=>{const e=parseFloat(a.value.base_price||0),t=parseFloat(a.value.total_discounts_value||0),u=parseFloat(a.value.base_price_after_discount||0);return(u>0?u:Math.max(0,e-t)).toFixed(2)}),ee=h(()=>parseFloat(a.value.total_discounts_value||0)>.01),ge=h(()=>{const e=parseFloat(a.value.base_price||0),t=parseFloat(a.value.total_discounts_value||0);return e<=0||t<=0?0:Math.round(t/e*100)}),me=h(()=>{var t;let e=[...J.value];if((t=c.value)!=null&&t.image){const u=c.value.image;e.some(v=>v.url===u)||e.unshift({url:u})}return e.filter((u,v,g)=>g.findIndex(x=>x.url===u.url)===v)}),E=h(()=>a.value.has_variants?c.value!==null:!0),fe=h(()=>Object.keys(j.value).length>0&&c.value===null),G=h(()=>w.value==="en"?a.value.description_en||l("product.noDescription"):a.value.description_ar||l("product.noDescription")),te=h(()=>G.value.length>300),he=h(()=>te.value?G.value.slice(0,300)+"...":G.value),X=h(()=>m.value.length?m.value.reduce((e,t)=>e+t.rate,0)/m.value.length:0),ye=h(()=>{const e={1:0,2:0,3:0,4:0,5:0};m.value.forEach(u=>e[u.rate]++);const t=m.value.length;return[5,4,3,2,1].map(u=>({stars:u,count:e[u],percentage:t?Math.round(e[u]/t*100):0}))}),be=h(()=>m.value.slice(0,5)),xe=e=>O.value=e,we=()=>N.value=!N.value,ke=e=>new Date(e).toLocaleDateString(w.value==="ar"?"ar-EG":"en-US",{year:"numeric",month:"short",day:"numeric"}),ae=(e,t)=>{var u;return((u=j.value[e])==null?void 0:u.id)===t.id},Oe=(e,t)=>{const u={...j.value,[e]:t};j.value=u;const v=Q.value.find(g=>Object.keys(u).every(x=>{var k;const b=u[x].id;return((k=g.attributes[x])==null?void 0:k.id)===b}));v&&Object.keys(u).length===Object.keys(V.value).length?(c.value={...v,variant_id:v.variant_id,price:v.price,image:v.image,isOutOfStock:a.value.is_stock===0,in_cart:a.value.in_cart},v.image&&(O.value=v.image),S.value=a.value.in_cart&&a.value.quantity||1):c.value=null},Se=async()=>{var e,t;if(!M.authenticatedweb)return $.push({name:"authlog"});if(!(!c.value||q.value)){q.value=!0;try{await W.post("/api/cart/add",{product_id:a.value.id,variant_id:c.value.variant_id||null,quantity:1}),c.value.in_cart=!0,a.value.in_cart=!0,S.value=1,A.add({severity:"success",summary:l("success"),detail:l("cart.added"),life:3e3})}catch(u){A.add({severity:"error",detail:((t=(e=u.response)==null?void 0:e.data)==null?void 0:t.message)||l("cart.error"),life:3e3})}finally{q.value=!1}}},se=async e=>{if(!M.authenticatedweb||I.value||!c.value)return;const t=e==="plus"?S.value+1:S.value-1;if(!(t<1)){I.value=!0;try{await W.post("/api/cart/update",{product_id:a.value.id,variant_id:c.value.variant_id||null,quantity:t}),S.value=t,A.add({severity:"success",detail:l(e==="plus"?"cart.quantityIncreased":"cart.quantityDecreased"),life:2e3})}catch{A.add({severity:"error",detail:l("cart.quantityError"),life:3e3})}finally{I.value=!1}}},Ce=()=>{var e;if(!E.value){A.add({severity:"warn",detail:l("product.selectVariant")||"Please select all options",life:3e3});return}(e=c.value)!=null&&e.in_cart||Se()},De=async()=>{var e,t,u;if(f.value.rating===0||!f.value.comment.trim()){R.value=l("reviews.requiredFields");return}U.value=!0,R.value=null;try{const v={model_id:H.params.id,rate:f.value.rating,type:"product",message:f.value.comment.trim()},{data:g}=await W.post("/api/review",v);g.is_success&&(m.value.unshift({id:g.data.id||Date.now(),rate:f.value.rating,message:f.value.comment.trim(),user:{name:((e=M.user)==null?void 0:e.name)||"You"},created_at:new Date().toISOString()}),f.value={rating:0,comment:""},A.add({severity:"success",summary:l("success"),detail:l("reviews.submitSuccess"),life:4e3}))}catch(v){R.value=((u=(t=v.response)==null?void 0:t.data)==null?void 0:u.message)||l("reviews.submitError")}finally{U.value=!1}},Ae=e=>e&&$.push(e.has_subcategories?{name:"subcategory",params:{id:e.id}}:{name:"produts_category",params:{id:e.id}}),Fe=e=>e&&$.push({name:"products-brand",params:{id:e.id}}),Ve=e=>e&&$.push(e.has_market?{name:"stores-hasmarket"}:{name:"home"}),le=async()=>{var e,t,u;F.value=!0,C.value=null,j.value={},c.value=null;try{const{data:v}=await W.get(`/api/home/product-details/${H.params.id}`);if(v.is_success){const g=v.data.product;a.value={...g,in_cart:!!g.in_cart,isOutOfStock:g.is_stock===0},J.value=g.media||[],m.value=g.reviews||[];const x=v.data.variants_details||{};if(V.value=x.attributes||{},Q.value=(x.combinations||[]).map(b=>({...b})),Q.value.length>0){const b=Q.value[0];c.value={...b,isOutOfStock:a.value.is_stock===0,in_cart:a.value.in_cart},Object.keys(V.value).forEach(k=>{const P=V.value[k].find(K=>{var T;return K.id===((T=b.attributes[k])==null?void 0:T.id)});P&&(j.value[k]=P)}),b.image&&(O.value=b.image)}else c.value={variant_id:null,price:a.value.base_price_after_discount||a.value.base_price,image:null,isOutOfStock:a.value.is_stock===0,in_cart:a.value.in_cart};O.value=O.value||a.value.key_default_image||((e=J.value[0])==null?void 0:e.url)||ve,S.value=a.value.in_cart&&a.value.quantity||1}else C.value=l("product.notFound")}catch(v){C.value=((u=(t=v.response)==null?void 0:t.data)==null?void 0:u.message)||l("product.loadError")}finally{F.value=!1}};return Ee(()=>H.params.id,e=>{e&&(le(),window.scrollTo(0,0))}),Pe(()=>{window.scrollTo(0,0),le()}),(e,t)=>{var u,v,g,x,b,k,P,K,T,oe,re,ne,ie,ue,ce;return n(),i("div",Ue,[F.value?(n(),i("div",Qe,[B(o(Me),{style:{width:"50px",height:"50px"},strokeWidth:"4"}),s("p",Ge,r(o(l)("common.loading")),1)])):_("",!0),C.value?(n(),i("div",Ke,r(C.value),1)):(n(),i("header",We,[s("div",Ye,[s("div",He,[(n(!0),i(L,null,z(me.value,d=>(n(),i("img",{key:d.url,src:d.url,alt:o(l)("product.thumbnailAlt"),class:Z(["h-20 w-20 object-contain rounded-lg cursor-pointer border-2 transition-all duration-200 hover:border-blue-500",{"border-blue-500 opacity-100":O.value===d.url,"border-gray-300 opacity-70":O.value!==d.url}]),onClick:D=>xe(d.url)},null,10,Je))),128))]),s("div",Xe,[s("div",Ze,[a.value.is_best_seller?(n(),i("div",et," Best Seller ")):_("",!0),a.value.is_free_shipping?(n(),i("div",tt,[t[8]||(t[8]=s("i",{class:"pi pi-truck"},null,-1)),Te(" "+r(o(l)("products.Free_Delivery")),1)])):_("",!0),s("img",{src:O.value||a.value.key_default_image||ve,alt:o(w)==="en"?a.value.name_en:a.value.name_ar,class:"w-full h-full object-contain transition-transform duration-700 hover:scale-105",loading:"lazy"},null,8,at)])])]),s("div",st,[s("div",lt,[s("section",ot,[a.value.store_id?(n(),i("span",{key:0,onClick:t[0]||(t[0]=d=>Ve(a.value.store)),class:"sub-tiles cursor-pointer"},r(o(w)==="en"?(u=a.value.store)==null?void 0:u.name_en:((v=a.value.store)==null?void 0:v.name_ar)||o(l)("store.default")),1)):_("",!0),a.value.category?(n(),i("span",{key:1,onClick:t[1]||(t[1]=d=>Ae(a.value.category)),class:"sub-tiles cursor-pointer"},r(o(w)==="en"?a.value.category.name_en:a.value.category.name_ar),1)):_("",!0),a.value.brand_id?(n(),i("span",{key:2,onClick:t[2]||(t[2]=d=>Fe(a.value.brand)),class:"sub-tiles cursor-pointer"},r(o(w)==="en"?(g=a.value.brand)==null?void 0:g.name_en:((x=a.value.brand)==null?void 0:x.name_ar)||o(l)("brand.default")),1)):_("",!0)]),s("h1",rt,r(o(w)==="en"?a.value.name_en:a.value.name_ar),1),a.value.sub_name_en||a.value.sub_name_ar?(n(),i("h2",nt,r(o(w)==="en"?a.value.sub_name_en:a.value.sub_name_ar),1)):_("",!0),s("div",it,[B(o(Y),{modelValue:X.value,readonly:!0,cancel:!1,class:"text-lg"},null,8,["modelValue"]),s("span",ut," ("+r(m.value.length)+" "+r(m.value.length===1?o(l)("reviews.singular"):o(l)("reviews.plural"))+") ",1)]),t[10]||(t[10]=s("hr",{class:"bg-gradient-to-r from-transparent via-[#A17D1C] to-transparent h-0.5 my-8"},null,-1)),a.value.has_variants&&Object.keys(V.value).length?(n(),i("section",ct,[(n(!0),i(L,null,z(V.value,(d,D)=>(n(),i("div",{key:D,class:"space-y-2"},[s("div",dt,[(n(!0),i(L,null,z(d,y=>(n(),i("button",{key:y.id,onClick:va=>Oe(D,y),class:Z([{"border-blue-600 ring-4 ring-blue-100":ae(D,y),"border-gray-300 hover:border-blue-400":!ae(D,y)},"px-4 py-2 text-sm font-medium border-2 rounded-lg transition-all duration-200 flex items-center gap-2"])},[y.is_color?(n(),i("span",{key:0,class:"w-6 h-6 rounded-full border-2 border-gray-300",style:de({backgroundColor:y.value_en})},null,4)):_("",!0),y.is_color?_("",!0):(n(),i("span",_t,r(o(w)==="en"?y.value_en:y.value_ar),1))],10,vt))),128))])]))),128)),c.value&&c.value.isOutOfStock?(n(),i("p",pt,r(o(l)("product.outOfStock")),1)):c.value===null&&fe.value?(n(),i("p",gt,r(o(l)("product.selectAllVariants")||"Please select all options"),1)):_("",!0)])):_("",!0),s("div",mt,[s("div",ft,[s("span",ht,r(pe.value)+" "+r(e.$t("currencyLabel")),1),ee.value?(n(),i("span",yt,r(_e.value)+" "+r(e.$t("currencyLabel")),1)):_("",!0),ee.value?(n(),i("span",bt," -"+r(ge.value)+"% ",1)):_("",!0)])]),(b=c.value)!=null&&b.in_cart?(n(),i("div",xt,[s("label",wt,r(o(l)("product.quantity"))+":",1),s("div",kt,[s("button",{onClick:t[3]||(t[3]=d=>se("minus")),disabled:S.value<=1||I.value||((k=c.value)==null?void 0:k.isOutOfStock),class:"px-5 py-3 text-2xl font-bold hover:bg-gray-100 disabled:opacity-50 transition"},"âˆ’",8,Ot),s("span",St,r(S.value),1),s("button",{onClick:t[4]||(t[4]=d=>se("plus")),disabled:I.value||((P=c.value)==null?void 0:P.isOutOfStock),class:"px-5 py-3 text-2xl font-bold hover:bg-gray-100 disabled:opacity-50 transition"},"+",8,Ct)])])):_("",!0),s("button",{onClick:Ce,disabled:q.value||((K=c.value)==null?void 0:K.isOutOfStock)||!E.value,class:Z(["w-full py-5 text-xl font-bold rounded-2xl text-white transition-all duration-300 shadow-lg hover:shadow-xl active:scale-95 flex items-center justify-center gap-3",{"bg-[#A6853B] hover:bg-[#8f702c]":!((T=c.value)!=null&&T.in_cart)&&E.value,"bg-[#0b3baa] hover:bg-[#093080]":(oe=c.value)==null?void 0:oe.in_cart,"bg-gray-400 cursor-not-allowed":((re=c.value)==null?void 0:re.isOutOfStock)||!E.value}])},[(ne=c.value)!=null&&ne.in_cart?(n(),i("svg",At,t[9]||(t[9]=[s("path",{d:"M9 16.2l-3.5-3.5a.984.984 0 0 0-1.4 0 .984.984 0 0 0 0 1.4l4.2 4.2c.39.39 1.01.39 1.4 0l8.4-8.4a.984.984 0 0 0 0-1.4.984.984 0 0 0-1.4 0L9 16.2z"},null,-1)]))):_("",!0),(ie=c.value)!=null&&ie.in_cart?(n(),i("span",Ft,r(o(l)("product.inCart")),1)):(ue=c.value)!=null&&ue.isOutOfStock||!E.value?(n(),i("span",Vt,r(o(l)("product.outOfStock")),1)):(n(),i("span",jt,r(q.value?o(l)("product.adding")+"...":o(l)("product.addToCart")),1))],10,Dt),(ce=c.value)!=null&&ce.isOutOfStock?(n(),i("p",Bt,r(o(l)("product.outOfStock")),1)):_("",!0)])])])),!F.value&&!C.value?(n(),i("section",$t,[s("p",qt,r(N.value?G.value:he.value),1),te.value?(n(),i("button",{key:0,onClick:we,class:"mt-4 text-[#E39F30] font-bold text-sm hover:underline focus:outline-none"},r(N.value?o(l)("product.readLess"):o(l)("product.readMore")),1)):_("",!0)])):_("",!0),!F.value&&!C.value?(n(),i("section",It,[s("h2",Rt,r(o(l)("reviews.title")),1),s("div",Et,[s("div",Pt,[s("div",Tt,r(X.value.toFixed(1)),1),B(o(Y),{modelValue:X.value,readonly:!0,cancel:!1,class:"my-4 justify-center text-3xl"},null,8,["modelValue"]),s("p",Lt,r(m.value.length)+" "+r(m.value.length===1?o(l)("reviews.singular"):o(l)("reviews.plural")),1)]),s("div",zt,[(n(!0),i(L,null,z(ye.value,d=>(n(),i("div",{key:d.stars,class:"flex items-center gap-3"},[s("span",Mt,r(d.stars),1),s("div",Nt,[s("div",{class:"absolute top-0 left-0 h-full bg-[#A6853B] transition-all duration-700 ease-out",style:de({width:d.percentage+"%"})},null,4)]),s("span",Ut,r(d.count),1)]))),128))])]),s("div",Qt,[s("h3",Gt,r(o(l)("reviews.writeReview")),1),o(M).authenticatedweb?(n(),i("div",Kt,[s("div",Wt,[B(o(Y),{modelValue:f.value.rating,"onUpdate:modelValue":t[5]||(t[5]=d=>f.value.rating=d),stars:5,cancel:!1,class:"text-4xl justify-center"},null,8,["modelValue"])]),Le(s("textarea",{"onUpdate:modelValue":t[6]||(t[6]=d=>f.value.comment=d),rows:"6",class:"w-full p-5 border border-gray-300 rounded-xl focus:ring-4 focus:ring-[#A6853B]/20 focus:border-[#A6853B] outline-none resize-none transition",placeholder:o(l)("reviews.placeholder")},null,8,Yt),[[ze,f.value.comment]]),s("button",{onClick:De,disabled:U.value||f.value.rating===0||!f.value.comment.trim(),class:"w-full py-4 bg-[#A6853B] hover:bg-[#8f702c] text-white font-bold rounded-xl transition disabled:opacity-50 disabled:cursor-not-allowed shadow-lg hover:shadow-xl"},r(U.value?o(l)("reviews.submitting")+"...":o(l)("reviews.submit")),9,Ht),R.value?(n(),i("p",Jt,r(R.value),1)):_("",!0)])):(n(),i("div",Xt,[s("p",Zt,r(o(l)("reviews.loginToReview")),1),s("button",{onClick:t[7]||(t[7]=d=>o($).push({name:"authlog"})),class:"px-10 py-4 bg-[#A6853B] text-white font-bold rounded-xl hover:bg-[#8f702c] transition shadow-lg"},r(o(l)("reviews.login")),1)]))]),m.value.length?(n(),i("div",ea,[s("h3",ta,r(o(l)("reviews.customerReviews")),1),(n(!0),i(L,null,z(be.value,d=>{var D,y;return n(),i("div",{key:d.id,class:"border-b pb-8 last:border-0"},[s("div",aa,[s("div",sa,[s("div",la,r((((D=d.user)==null?void 0:D.name)||"A")[0].toUpperCase()),1),s("div",null,[s("p",oa,r(((y=d.user)==null?void 0:y.name)||o(l)("reviews.anonymous")),1),B(o(Y),{modelValue:d.rate,readonly:!0,cancel:!1},null,8,["modelValue"])])]),s("span",ra,r(ke(d.created_at)),1)]),s("p",na,r(d.message),1)])}),128))])):(n(),i("div",ia,r(o(l)("reviews.noReviews")),1))])):_("",!0),!F.value&&!C.value?(n(),i("section",ua,[B(Ne)])):_("",!0)])}}},ga=je(ca,[["__scopeId","data-v-764f0dc4"]]);export{ga as default};
