import{_ as $e,u as Ie,a as Pe,b as qe,A as Re,c as Te,r as g,d as m,z as Ee,o as Le,e as u,f as i,h as B,i as r,g as a,t as l,l as _,F as L,m as M,k as Me,n as Z,B as ze,D as Ne,p as W,s as Ue,K as Y,L as ve}from"./index-6aa0199c.js";import{P as Qe}from"./ProductOffers-60ebd9ae.js";const Ge={class:"product-page max-w-7xl mx-auto p-4 lg:p-8"},Ke={key:0,class:"text-center py-20"},We={class:"mt-4 text-gray-600"},Ye={key:1,class:"text-red-500 text-center py-10 text-lg"},He={key:2,class:"flex flex-col lg:flex-row items-start gap-8 lg:gap-12"},Je={class:"w-full lg:w-1/2 flex flex-col-reverse lg:flex-row items-center gap-4"},Xe={class:"flex lg:flex-col flex-row items-center justify-center lg:justify-start gap-3 w-full lg:w-1/4 order-2 lg:order-1"},Ze=["src","alt","onClick"],et={class:"w-full lg:w-3/4 order-1 lg:order-2"},tt={class:"relative w-full aspect-square shadow-xl rounded-2xl overflow-hidden bg-gray-50"},at={key:0,class:"absolute top-4 left-4 z-10 bg-black text-white text-xs font-bold px-4 py-2 rounded-full uppercase tracking-wider shadow-lg"},st={key:1,class:"absolute top-4 right-4 z-10 bg-green-600 text-white text-xs font-bold px-4 py-2 rounded-full flex items-center gap-2 shadow-lg"},lt=["src","alt"],ot={class:"w-full lg:w-1/2"},rt={class:"bg-white rounded-2xl shadow-lg p-6 lg:p-8"},nt={class:"flex flex-wrap gap-3 mb-6"},ut={class:"text-3xl lg:text-4xl font-bold text-gray-800 mb-3 leading-tight"},it={key:0,class:"text-xl text-gray-600 mb-6"},ct={class:"flex items-center gap-3 mb-6"},dt={class:"text-gray-600"},vt={key:1,class:"mb-8 space-y-6"},_t={class:"flex flex-wrap gap-3"},pt=["onClick"],gt={key:1},mt={key:0,class:"text-red-600 font-semibold mt-3"},ft={key:1,class:"text-orange-600 font-medium mt-3"},ht={class:"mb-8"},bt={class:"flex items-baseline gap-4 flex-wrap"},yt={class:"text-4xl font-bold text-gray-900"},xt={key:0,class:"text-2xl font-bold text-[#0b3baa] line-through opacity-80"},wt={key:1,class:"bg-red-100 text-red-800 text-sm font-bold px-3 py-1 rounded-full"},kt={key:2,class:"flex items-center gap-6 mb-8"},Ot={class:"font-bold text-gray-700 text-lg"},St={class:"flex items-center border-2 border-gray-300 rounded-xl overflow-hidden select-none"},Ct=["disabled"],Ft={class:"px-8 py-3 font-semibold text-lg border-x-2 border-gray-300 min-w-20 text-center"},Dt=["disabled"],At={class:"ml-4 text-lg font-bold"},Vt=["disabled"],jt={key:0,class:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24"},Bt={key:1},$t={key:2},It={key:3},Pt={key:3,class:"text-red-600 font-semibold text-center mt-4"},qt={key:3,class:"bg-[#E6AC312B] px-8 py-10 rounded-2xl mt-12"},Rt={class:"text-gray-700 leading-relaxed text-base"},Tt={key:4,class:"mt-12 p-8 bg-white rounded-2xl shadow-xl"},Et={class:"text-3xl font-bold text-center text-gray-800 mb-10"},Lt={class:"grid md:grid-cols-3 gap-8 mb-12"},Mt={class:"text-center"},zt={class:"text-6xl font-bold text-gray-800"},Nt={class:"text-gray-500"},Ut={class:"md:col-span-2 space-y-3"},Qt={class:"w-8 text-sm font-medium"},Gt={class:"flex-1 bg-gray-200 rounded-full h-4 relative overflow-hidden"},Kt={class:"text-sm text-gray-600 w-12 text-right"},Wt={class:"mt-12 border-t pt-12"},Yt={class:"text-2xl font-bold text-center mb-8"},Ht={key:0,class:"max-w-2xl mx-auto space-y-6"},Jt={class:"text-center"},Xt=["placeholder"],Zt=["disabled"],ea={key:0,class:"text-red-500 text-center font-medium"},ta={key:1,class:"text-center py-12 bg-gray-50 rounded-2xl"},aa={class:"text-gray-600 mb-6 text-lg"},sa={key:0,class:"mt-12 space-y-8"},la={class:"text-2xl font-bold text-gray-800 border-b pb-4"},oa={class:"flex items-center justify-between mb-4"},ra={class:"flex items-center gap-4"},na={class:"w-12 h-12 bg-gray-200 rounded-full flex items-center justify-center text-xl font-bold text-gray-600"},ua={class:"font-semibold text-lg"},ia={class:"text-sm text-gray-500"},ca={class:"text-gray-700 leading-relaxed pl-16"},da={key:1,class:"text-center py-16 text-gray-500 text-lg"},va={key:5,class:"mt-12"},_e="https://via.placeholder.com/600?text=No+Image",_a={__name:"product-details",setup(pa){const{t:o,locale:w}=Ie(),H=Pe(),$=qe(),z=Re(),D=Te(),s=g({}),J=g([]),S=g(""),k=g(1),A=g(!0),C=g(null),I=g(!1),P=g(!1),f=g([]),N=g(!1),U=g(!1),q=g(null),h=g({rating:0,comment:""}),V=g({}),Q=g([]),j=g({}),n=g(null),pe=m(()=>n.value&&n.value.price!=null?parseFloat(n.value.price||0).toFixed(2):parseFloat(s.value.base_price||0).toFixed(2)),ee=m(()=>{if(n.value&&n.value.price!=null){const p=parseFloat(n.value.price||0),b=parseFloat(n.value.total_discounts_value||0);return Math.max(0,p-b).toFixed(2)}const e=parseFloat(s.value.base_price||0),t=parseFloat(s.value.total_discounts_value||0),c=parseFloat(s.value.base_price_after_discount||0);return(c>0?c:Math.max(0,e-t)).toFixed(2)}),te=m(()=>n.value&&n.value.price!=null?parseFloat(n.value.total_discounts_value||0)>.01:parseFloat(s.value.total_discounts_value||0)>.01),ge=m(()=>{if(n.value&&n.value.price!=null){const c=parseFloat(n.value.price||0),v=parseFloat(n.value.total_discounts_value||0);return c<=0||v<=0?0:Math.round(v/c*100)}const e=parseFloat(s.value.base_price||0),t=parseFloat(s.value.total_discounts_value||0);return e<=0||t<=0?0:Math.round(t/e*100)}),me=m(()=>{var t;let e=[...J.value];if((t=n.value)!=null&&t.image){const c=n.value.image;e.some(v=>v.url===c)||e.unshift({url:c})}return e.filter((c,v,p)=>p.findIndex(b=>b.url===c.url)===v)}),R=m(()=>s.value.has_variants?n.value!==null:!0),fe=m(()=>Object.keys(j.value).length>0&&n.value===null),G=m(()=>w.value==="en"?s.value.description_en||o("product.noDescription"):s.value.description_ar||o("product.noDescription")),ae=m(()=>G.value.length>300),he=m(()=>ae.value?G.value.slice(0,300)+"...":G.value),X=m(()=>f.value.length?f.value.reduce((e,t)=>e+t.rate,0)/f.value.length:0),be=m(()=>{const e={1:0,2:0,3:0,4:0,5:0};f.value.forEach(c=>e[c.rate]++);const t=f.value.length;return[5,4,3,2,1].map(c=>({stars:c,count:e[c],percentage:t?Math.round(e[c]/t*100):0}))}),ye=m(()=>f.value.slice(0,5)),xe=m(()=>parseFloat(ee.value||0)),we=m(()=>(xe.value*(k.value||1)).toFixed(2)),ke=e=>S.value=e,Oe=()=>N.value=!N.value,Se=e=>new Date(e).toLocaleDateString(w.value==="ar"?"ar-EG":"en-US",{year:"numeric",month:"short",day:"numeric"}),se=(e,t)=>{var c;return((c=j.value[e])==null?void 0:c.id)===t.id},Ce=(e,t)=>{const c={...j.value,[e]:t};j.value=c;const v=Q.value.find(p=>Object.keys(c).every(b=>{var O;const y=c[b].id;return((O=p.attributes[b])==null?void 0:O.id)===y}));v&&Object.keys(c).length===Object.keys(V.value).length?(n.value={...v,variant_id:v.variant_id,price:v.price,image:v.image,isOutOfStock:s.value.is_stock===0,in_cart:s.value.in_cart},v.image&&(S.value=v.image),k.value=s.value.in_cart&&s.value.quantity||1):n.value=null},Fe=async()=>{var e,t;if(!z.authenticatedweb)return $.push({name:"authlog"});if(!(!n.value||I.value)){I.value=!0;try{await W.post("/api/cart/add",{product_id:s.value.id,variant_id:n.value.variant_id||null,quantity:1}),n.value.in_cart=!0,s.value.in_cart=!0,k.value=1,D.add({severity:"success",summary:o("success"),detail:o("cart.added"),life:3e3})}catch(c){D.add({severity:"error",detail:((t=(e=c.response)==null?void 0:e.data)==null?void 0:t.message)||o("cart.error"),life:3e3})}finally{I.value=!1}}},le=async e=>{if(!z.authenticatedweb||P.value||!n.value)return;const t=e==="plus"?k.value+1:k.value-1;if(!(t<1)){P.value=!0;try{await W.post("/api/cart/update",{product_id:s.value.id,variant_id:n.value.variant_id||null,quantity:t}),k.value=t,D.add({severity:"success",detail:o(e==="plus"?"cart.quantityIncreased":"cart.quantityDecreased"),life:2e3})}catch{D.add({severity:"error",detail:o("cart.quantityError"),life:3e3})}finally{P.value=!1}}},De=()=>{var e;if(!R.value){D.add({severity:"warn",detail:o("product.selectVariant")||"Please select all options",life:3e3});return}(e=n.value)!=null&&e.in_cart||Fe()},Ae=async()=>{var e,t,c;if(h.value.rating===0||!h.value.comment.trim()){q.value=o("reviews.requiredFields");return}U.value=!0,q.value=null;try{const v={model_id:H.params.id,rate:h.value.rating,type:"product",message:h.value.comment.trim()},{data:p}=await W.post("/api/review",v);p.is_success&&(f.value.unshift({id:p.data.id||Date.now(),rate:h.value.rating,message:h.value.comment.trim(),user:{name:((e=z.user)==null?void 0:e.name)||"You"},created_at:new Date().toISOString()}),h.value={rating:0,comment:""},D.add({severity:"success",summary:o("success"),detail:o("reviews.submitSuccess"),life:4e3}))}catch(v){q.value=((c=(t=v.response)==null?void 0:t.data)==null?void 0:c.message)||o("reviews.submitError")}finally{U.value=!1}},Ve=e=>e&&$.push(e.has_subcategories?{name:"subcategory",params:{id:e.id}}:{name:"produts_category",params:{id:e.id}}),je=e=>e&&$.push({name:"products-brand",params:{id:e.id}}),Be=e=>e&&$.push(e.has_market?{name:"stores-hasmarket"}:{name:"home"}),oe=async()=>{var e,t,c;A.value=!0,C.value=null,j.value={},n.value=null;try{const{data:v}=await W.get(`/api/home/product-details/${H.params.id}`);if(v.is_success){const p=v.data.product;s.value={...p,in_cart:!!p.in_cart,isOutOfStock:p.is_stock===0},J.value=p.media||[],f.value=p.reviews||[];const b=v.data.variants_details||{};if(V.value=b.attributes||{},Q.value=(b.combinations||[]).map(y=>({...y})),Q.value.length>0){const y=Q.value[0];n.value={...y,isOutOfStock:s.value.is_stock===0,in_cart:s.value.in_cart},Object.keys(V.value).forEach(O=>{const T=V.value[O].find(K=>{var E;return K.id===((E=y.attributes[O])==null?void 0:E.id)});T&&(j.value[O]=T)}),y.image&&(S.value=y.image)}else n.value={variant_id:null,price:s.value.base_price,total_discounts_value:s.value.total_discounts_value,image:null,isOutOfStock:s.value.is_stock===0,in_cart:s.value.in_cart};S.value=S.value||s.value.key_default_image||((e=J.value[0])==null?void 0:e.url)||_e,k.value=s.value.in_cart&&s.value.quantity||1}else C.value=o("product.notFound")}catch(v){C.value=((c=(t=v.response)==null?void 0:t.data)==null?void 0:c.message)||o("product.loadError")}finally{A.value=!1}};return Ee(()=>H.params.id,e=>{e&&(oe(),window.scrollTo(0,0))}),Le(()=>{window.scrollTo(0,0),oe()}),(e,t)=>{var c,v,p,b,y,O,T,K,E,re,ne,ue,ie,ce,de;return u(),i("div",Ge,[A.value?(u(),i("div",Ke,[B(r(Ue),{style:{width:"50px",height:"50px"},strokeWidth:"4"}),a("p",We,l(r(o)("common.loading")),1)])):_("",!0),C.value?(u(),i("div",Ye,l(C.value),1)):(u(),i("header",He,[a("div",Je,[a("div",Xe,[(u(!0),i(L,null,M(me.value,d=>(u(),i("img",{key:d.url,src:d.url,alt:r(o)("product.thumbnailAlt"),class:Z(["h-20 w-20 object-contain rounded-lg cursor-pointer border-2 transition-all duration-200 hover:border-blue-500",{"border-blue-500 opacity-100":S.value===d.url,"border-gray-300 opacity-70":S.value!==d.url}]),onClick:F=>ke(d.url)},null,10,Ze))),128))]),a("div",et,[a("div",tt,[s.value.is_best_seller?(u(),i("div",at," Best Seller ")):_("",!0),s.value.is_free_shipping?(u(),i("div",st,[t[8]||(t[8]=a("i",{class:"pi pi-truck"},null,-1)),Me(" "+l(r(o)("products.Free_Delivery")),1)])):_("",!0),a("img",{src:S.value||s.value.key_default_image||_e,alt:r(w)==="en"?s.value.name_en:s.value.name_ar,class:"w-full h-full object-contain transition-transform duration-700 hover:scale-105",loading:"lazy"},null,8,lt)])])]),a("div",ot,[a("div",rt,[a("section",nt,[s.value.store_id?(u(),i("span",{key:0,onClick:t[0]||(t[0]=d=>Be(s.value.store)),class:"sub-tiles cursor-pointer"},l(r(w)==="en"?(c=s.value.store)==null?void 0:c.name_en:((v=s.value.store)==null?void 0:v.name_ar)||r(o)("store.default")),1)):_("",!0),s.value.category?(u(),i("span",{key:1,onClick:t[1]||(t[1]=d=>Ve(s.value.category)),class:"sub-tiles cursor-pointer"},l(r(w)==="en"?s.value.category.name_en:s.value.category.name_ar),1)):_("",!0),s.value.brand_id?(u(),i("span",{key:2,onClick:t[2]||(t[2]=d=>je(s.value.brand)),class:"sub-tiles cursor-pointer"},l(r(w)==="en"?(p=s.value.brand)==null?void 0:p.name_en:((b=s.value.brand)==null?void 0:b.name_ar)||r(o)("brand.default")),1)):_("",!0)]),a("h1",ut,l(r(w)==="en"?s.value.name_en:s.value.name_ar),1),s.value.sub_name_en||s.value.sub_name_ar?(u(),i("h2",it,l(r(w)==="en"?s.value.sub_name_en:s.value.sub_name_ar),1)):_("",!0),a("div",ct,[B(r(Y),{modelValue:X.value,readonly:!0,cancel:!1,class:"text-lg"},null,8,["modelValue"]),a("span",dt," ("+l(f.value.length)+" "+l(f.value.length===1?r(o)("reviews.singular"):r(o)("reviews.plural"))+") ",1)]),t[10]||(t[10]=a("hr",{class:"bg-gradient-to-r from-transparent via-[#A17D1C] to-transparent h-0.5 my-8"},null,-1)),s.value.has_variants&&Object.keys(V.value).length?(u(),i("section",vt,[(u(!0),i(L,null,M(V.value,(d,F)=>(u(),i("div",{key:F,class:"space-y-2"},[a("div",_t,[(u(!0),i(L,null,M(d,x=>(u(),i("button",{key:x.id,onClick:ga=>Ce(F,x),class:Z([{"border-blue-600 ring-4 ring-blue-100":se(F,x),"border-gray-300 hover:border-blue-400":!se(F,x)},"px-4 py-2 text-sm font-medium border-2 rounded-lg transition-all duration-200 flex items-center gap-2"])},[x.is_color?(u(),i("span",{key:0,class:"w-6 h-6 rounded-full border-2 border-gray-300",style:ve({backgroundColor:x.value_en})},null,4)):_("",!0),x.is_color?_("",!0):(u(),i("span",gt,l(r(w)==="en"?x.value_en:x.value_ar),1))],10,pt))),128))])]))),128)),n.value&&n.value.isOutOfStock?(u(),i("p",mt,l(r(o)("product.outOfStock")),1)):n.value===null&&fe.value?(u(),i("p",ft,l(r(o)("product.selectAllVariants")||"Please select all options"),1)):_("",!0)])):_("",!0),a("div",ht,[a("div",bt,[a("span",yt,l(ee.value)+" "+l(e.$t("currencyLabel")),1),te.value?(u(),i("span",xt,l(pe.value)+" "+l(e.$t("currencyLabel")),1)):_("",!0),te.value?(u(),i("span",wt," -"+l(ge.value)+"% ",1)):_("",!0)])]),(y=n.value)!=null&&y.in_cart?(u(),i("div",kt,[a("label",Ot,l(r(o)("product.quantity"))+":",1),a("div",St,[a("button",{onClick:t[3]||(t[3]=d=>le("minus")),disabled:k.value<=1||P.value||((O=n.value)==null?void 0:O.isOutOfStock),class:"px-5 py-3 text-2xl font-bold hover:bg-gray-100 disabled:opacity-50 transition"},"âˆ’",8,Ct),a("span",Ft,l(k.value),1),a("button",{onClick:t[4]||(t[4]=d=>le("plus")),disabled:P.value||((T=n.value)==null?void 0:T.isOutOfStock),class:"px-5 py-3 text-2xl font-bold hover:bg-gray-100 disabled:opacity-50 transition"},"+",8,Dt)]),a("div",At,l(r(o)("product.total")||"Total")+": "+l(we.value)+" "+l(e.$t("currencyLabel")),1)])):_("",!0),a("button",{onClick:De,disabled:I.value||((K=n.value)==null?void 0:K.isOutOfStock)||!R.value,class:Z(["w-full py-5 text-xl font-bold rounded-2xl text-white transition-all duration-300 shadow-lg hover:shadow-xl active:scale-95 flex items-center justify-center gap-3",{"bg-[#A6853B] hover:bg-[#8f702c]":!((E=n.value)!=null&&E.in_cart)&&R.value,"bg-[#0b3baa] hover:bg-[#093080]":(re=n.value)==null?void 0:re.in_cart,"bg-gray-400 cursor-not-allowed":((ne=n.value)==null?void 0:ne.isOutOfStock)||!R.value}])},[(ue=n.value)!=null&&ue.in_cart?(u(),i("svg",jt,t[9]||(t[9]=[a("path",{d:"M9 16.2l-3.5-3.5a.984.984 0 0 0-1.4 0 .984.984 0 0 0 0 1.4l4.2 4.2c.39.39 1.01.39 1.4 0l8.4-8.4a.984.984 0 0 0 0-1.4.984.984 0 0 0-1.4 0L9 16.2z"},null,-1)]))):_("",!0),(ie=n.value)!=null&&ie.in_cart?(u(),i("span",Bt,l(r(o)("product.inCart")),1)):(ce=n.value)!=null&&ce.isOutOfStock||!R.value?(u(),i("span",$t,l(r(o)("product.outOfStock")),1)):(u(),i("span",It,l(I.value?r(o)("product.adding")+"...":r(o)("product.addToCart")),1))],10,Vt),(de=n.value)!=null&&de.isOutOfStock?(u(),i("p",Pt,l(r(o)("product.outOfStock")),1)):_("",!0)])])])),!A.value&&!C.value?(u(),i("section",qt,[a("p",Rt,l(N.value?G.value:he.value),1),ae.value?(u(),i("button",{key:0,onClick:Oe,class:"mt-4 text-[#E39F30] font-bold text-sm hover:underline focus:outline-none"},l(N.value?r(o)("product.readLess"):r(o)("product.readMore")),1)):_("",!0)])):_("",!0),!A.value&&!C.value?(u(),i("section",Tt,[a("h2",Et,l(r(o)("reviews.title")),1),a("div",Lt,[a("div",Mt,[a("div",zt,l(X.value.toFixed(1)),1),B(r(Y),{modelValue:X.value,readonly:!0,cancel:!1,class:"my-4 justify-center text-3xl"},null,8,["modelValue"]),a("p",Nt,l(f.value.length)+" "+l(f.value.length===1?r(o)("reviews.singular"):r(o)("reviews.plural")),1)]),a("div",Ut,[(u(!0),i(L,null,M(be.value,d=>(u(),i("div",{key:d.stars,class:"flex items-center gap-3"},[a("span",Qt,l(d.stars),1),a("div",Gt,[a("div",{class:"absolute top-0 left-0 h-full bg-[#A6853B] transition-all duration-700 ease-out",style:ve({width:d.percentage+"%"})},null,4)]),a("span",Kt,l(d.count),1)]))),128))])]),a("div",Wt,[a("h3",Yt,l(r(o)("reviews.writeReview")),1),r(z).authenticatedweb?(u(),i("div",Ht,[a("div",Jt,[B(r(Y),{modelValue:h.value.rating,"onUpdate:modelValue":t[5]||(t[5]=d=>h.value.rating=d),stars:5,cancel:!1,class:"text-4xl justify-center"},null,8,["modelValue"])]),ze(a("textarea",{"onUpdate:modelValue":t[6]||(t[6]=d=>h.value.comment=d),rows:"6",class:"w-full p-5 border border-gray-300 rounded-xl focus:ring-4 focus:ring-[#A6853B]/20 focus:border-[#A6853B] outline-none resize-none transition",placeholder:r(o)("reviews.placeholder")},null,8,Xt),[[Ne,h.value.comment]]),a("button",{onClick:Ae,disabled:U.value||h.value.rating===0||!h.value.comment.trim(),class:"w-full py-4 bg-[#A6853B] hover:bg-[#8f702c] text-white font-bold rounded-xl transition disabled:opacity-50 disabled:cursor-not-allowed shadow-lg hover:shadow-xl"},l(U.value?r(o)("reviews.submitting")+"...":r(o)("reviews.submit")),9,Zt),q.value?(u(),i("p",ea,l(q.value),1)):_("",!0)])):(u(),i("div",ta,[a("p",aa,l(r(o)("reviews.loginToReview")),1),a("button",{onClick:t[7]||(t[7]=d=>r($).push({name:"authlog"})),class:"px-10 py-4 bg-[#A6853B] text-white font-bold rounded-xl hover:bg-[#8f702c] transition shadow-lg"},l(r(o)("reviews.login")),1)]))]),f.value.length?(u(),i("div",sa,[a("h3",la,l(r(o)("reviews.customerReviews")),1),(u(!0),i(L,null,M(ye.value,d=>{var F,x;return u(),i("div",{key:d.id,class:"border-b pb-8 last:border-0"},[a("div",oa,[a("div",ra,[a("div",na,l((((F=d.user)==null?void 0:F.name)||"A")[0].toUpperCase()),1),a("div",null,[a("p",ua,l(((x=d.user)==null?void 0:x.name)||r(o)("reviews.anonymous")),1),B(r(Y),{modelValue:d.rate,readonly:!0,cancel:!1},null,8,["modelValue"])])]),a("span",ia,l(Se(d.created_at)),1)]),a("p",ca,l(d.message),1)])}),128))])):(u(),i("div",da,l(r(o)("reviews.noReviews")),1))])):_("",!0),!A.value&&!C.value?(u(),i("section",va,[B(Qe)])):_("",!0)])}}},ha=$e(_a,[["__scopeId","data-v-0495ed9a"]]);export{ha as default};
