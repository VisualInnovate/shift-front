import{_ as ee,a as te,b as se,u as ae,A as oe,r as p,d as A,z as V,y as ne,e as l,f as r,g as e,t as n,i as u,n as y,B as g,C as N,D as M,F as H,m as T,l as w,h as le,p as k,j as re,E as ie,G as q,k as de,H as ue}from"./index-7b82f61b.js";import{l as ce}from"./lodash-3e556b5d.js";import{d as pe}from"./banner-addtion-e4104052.js";const _e={class:"mx-auto mt-16 max-w-[1440px] px-4 sm:px-6 lg:px-8 pb-16"},me={key:0,class:"flex flex-col items-center justify-center py-20"},ge={class:"mt-4 text-lg text-gray-600"},ve={key:1,class:"text-center py-20"},fe={class:"text-xl font-semibold text-red-600 mb-4"},he={key:2,class:"lg:flex gap-8"},be={class:"lg:w-1/4 mb-8 lg:mb-0"},xe={class:"bg-white p-6 rounded-xl shadow-lg sticky top-24"},ye={class:"font-bold text-xl mb-6"},we={class:"space-y-6"},ke={class:"border-b pb-5"},Ce={class:"font-semibold"},Be={class:"mt-4 space-y-3"},Le=["placeholder"],Me=["id","value"],je=["for"],Pe={class:"border-b pb-5"},$e={class:"font-semibold"},Fe={class:"mt-4"},ze={class:"text-center text-sm font-medium mt-2"},Ve={class:"font-semibold"},Ne={class:"mt-4 flex gap-3"},Se=["placeholder"],Ue=["placeholder"],De={class:"lg:w-3/4"},Ee={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"},Ie=["onClick"],Re={class:"relative aspect-square bg-gray-100 overflow-hidden"},Ae=["src","alt"],He=["onClick"],Te={class:"p-5 flex flex-col flex-grow"},qe={class:"font-semibold text-gray-900 text-lg line-clamp-2 leading-tight mb-2"},Ge={key:0,class:"text-gray-600 text-sm line-clamp-2 mb-3 leading-snug"},Qe={class:"flex items-center gap-1 mb-3"},We={class:"text-yellow-500 font-bold text-sm"},Je={class:"text-gray-500 text-xs"},Ke={class:"mt-auto flex items-center justify-between"},Oe={class:"flex items-baseline gap-2"},Xe={class:"text-2xl font-bold text-gray-900"},Ye={key:0,class:"text-base line-through text-blue-600 font-medium opacity-80"},Ze=["onClick","disabled"],et={key:0,class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24"},tt={key:1,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},st={key:1,class:"flex items-center mt-3 text-[#0b3baa] text-xs font-medium"},at={class:"mt-12 flex justify-center"},ot={__name:"produts-category",setup(nt){const f=te(),S=se(),{t:d,locale:h}=ae(),j=oe();h.value=localStorage.getItem("appLang")||"en";const U=p(!0),C=p(null),D=p([]),b=p(1),P=p(12),E=p(0),i=p({category_ids:[],brand_ids:[],rate:0,min_price:null,max_price:null}),_=p({brand:!0,rating:!1,price:!1}),B=p([]),v=p(""),$=p(!0),F=p(1),G=A(()=>v.value?B.value.filter(a=>a.name.toLowerCase().includes(v.value.toLowerCase())):B.value),Q=A(()=>D.value),I=a=>Number(a).toFixed(2),W=(a,t)=>(a==null?void 0:a.length)>t?a.slice(0,t)+"...":a,L=async(a=1,t=!1)=>{try{const c=(await k.get(`/api/home/brands-by-category/${f.params.id||""}`,{params:{page:a,search:v.value||void 0}})).data.data,o=c.data.map(m=>({id:m.id,name:h.value==="ar"?m.name_ar||m.name_en:m.name_en||m.name_ar}));B.value=t?[...B.value,...o]:o,$.value=!!c.next_page_url,F.value=c.current_page}catch(s){console.error("Brands error:",s)}},J=()=>{$.value&&L(F.value+1,!0)},x=async(a=1)=>{C.value=null;try{const t={page:a,limit:P.value,category_ids:f.params.id?f.params.id:void 0,brand_ids:i.value.brand_ids.length?i.value.brand_ids.join(","):void 0,rate:i.value.rate>0?i.value.rate:void 0,min_price:i.value.min_price,max_price:i.value.max_price},c=(await k.get("/api/home/products",{params:t})).data.data;D.value=c.data.map(o=>{var m,R;return{id:o.id,name:h.value==="ar"?o.name_ar||o.name_en:o.name_en||o.name_ar,sub_name:h.value==="ar"?o.sub_name_ar||o.sub_name_en:o.sub_name_en||o.sub_name_ar,base_price:parseFloat(o.base_price),total_discounts_value:parseFloat(o.total_discounts_value||0),final_price:parseFloat(o.base_price)-parseFloat(o.total_discounts_value||0),img:((R=(m=o.media)==null?void 0:m.find(Z=>Z.name==="product_main_image"))==null?void 0:R.url)||o.key_default_image||pe,is_wished:o.is_wished||!1,in_cart:o.in_cart||!1,is_stock:o.is_stock,is_free_shipping:o.is_free_shipping||!1}}),b.value=c.current_page,E.value=c.total}catch(t){C.value=d("products.errorLoading"),console.error(t)}finally{U.value=!1}},K=async a=>{if(!j.authenticatedweb)return S.push({name:"authlog"});if(a.is_stock!==0)try{await k.post("/api/cart/add",{product_id:a.id,quantity:1}),a.in_cart=!0}catch{alert(d("cart.error"))}},O=async a=>{if(!j.authenticatedweb)return S.push({name:"authlog"});const t=a.is_wished;try{t?await k.delete(`/api/wishlists/${a.id}`):await k.post("/api/wishlists",{product_id:a.id}),a.is_wished=!t}catch{a.is_wished=t}},z=a=>{_.value[a]=!_.value[a]},X=a=>{const t=`/product-details/${a.id}`;window.open(t,"_blank","noopener,noreferrer")},Y=a=>{b.value=a.page+1,x(b.value)};return V(v,ce.debounce(()=>{F.value=1,L()},300)),V(i,()=>{b.value=1,x()},{deep:!0}),V(h,()=>{L(),x()}),ne(()=>{f.params.id&&(i.value.category_ids=[f.params.id]),L(),x()}),(a,t)=>(l(),r("div",_e,[U.value?(l(),r("div",me,[t[9]||(t[9]=e("img",{src:re,alt:"Loading",class:"w-32 h-32 object-contain animate-bounce"},null,-1)),e("p",ge,n(u(d)("common.loading")),1)])):C.value?(l(),r("div",ve,[e("p",fe,n(C.value),1),e("button",{onClick:x,class:"bg-indigo-600 text-white px-6 py-3 rounded-lg hover:bg-indigo-700 transition"},n(u(d)("products.retry")),1)])):(l(),r("div",he,[e("aside",be,[e("div",xe,[e("h3",ye,n(u(d)("products.filters")),1),e("div",we,[e("div",ke,[e("div",{onClick:t[0]||(t[0]=s=>z("brand")),class:"flex justify-between items-center cursor-pointer"},[e("span",Ce,n(u(d)("products.brand")),1),(l(),r("svg",{class:y([{"rotate-180":_.value.brand},"w-5 h-5 transition-transform"]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},t[10]||(t[10]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)]),2))]),g(e("div",Be,[g(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>v.value=s),type:"text",placeholder:u(d)("products.searchBrand"),class:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"},null,8,Le),[[M,v.value]]),(l(!0),r(H,null,T(G.value,s=>(l(),r("div",{key:s.id,class:"flex items-center"},[g(e("input",{type:"checkbox",id:`brand-${s.id}`,value:s.id,"onUpdate:modelValue":t[2]||(t[2]=c=>i.value.brand_ids=c),class:"w-4 h-4 text-indigo-600 rounded focus:ring-indigo-500"},null,8,Me),[[ie,i.value.brand_ids]]),e("label",{for:`brand-${s.id}`,class:"mx-3 text-sm text-gray-700"},n(s.name),9,je)]))),128)),$.value?(l(),r("button",{key:0,onClick:J,class:"text-indigo-600 text-sm hover:underline"},n(u(d)("products.loadMore")),1)):w("",!0)],512),[[N,_.value.brand]])]),e("div",Pe,[e("div",{onClick:t[3]||(t[3]=s=>z("rating")),class:"flex justify-between items-center cursor-pointer"},[e("span",$e,n(u(d)("products.rating")),1),(l(),r("svg",{class:y([{"rotate-180":_.value.rating},"w-5 h-5 transition-transform"]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},t[11]||(t[11]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)]),2))]),g(e("div",Fe,[g(e("input",{type:"range","onUpdate:modelValue":t[4]||(t[4]=s=>i.value.rate=s),min:"0",max:"5",step:"1",class:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider"},null,512),[[M,i.value.rate,void 0,{number:!0}]]),t[12]||(t[12]=e("div",{class:"flex justify-between text-xs text-gray-500 mt-2"},[e("span",null,"0"),e("span",null,"1"),e("span",null,"2"),e("span",null,"3"),e("span",null,"4"),e("span",null,"5")],-1)),e("p",ze,n(i.value.rate)+"+ "+n(u(d)("products.stars")),1)],512),[[N,_.value.rating]])]),e("div",null,[e("div",{onClick:t[5]||(t[5]=s=>z("price")),class:"flex justify-between items-center cursor-pointer"},[e("span",Ve,n(u(d)("products.price")),1),(l(),r("svg",{class:y([{"rotate-180":_.value.price},"w-5 h-5 transition-transform"]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},t[13]||(t[13]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)]),2))]),g(e("div",Ne,[g(e("input",{type:"number","onUpdate:modelValue":t[6]||(t[6]=s=>i.value.min_price=s),placeholder:u(d)("min_price"),class:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500"},null,8,Se),[[M,i.value.min_price,void 0,{number:!0}]]),t[14]||(t[14]=e("span",{class:"self-center"},"-",-1)),g(e("input",{type:"number","onUpdate:modelValue":t[7]||(t[7]=s=>i.value.max_price=s),placeholder:u(d)("max_price"),class:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500"},null,8,Ue),[[M,i.value.max_price,void 0,{number:!0}]])],512),[[N,_.value.price]])])])])]),e("div",De,[e("div",Ee,[(l(!0),r(H,null,T(Q.value,s=>(l(),r("div",{key:s.id,class:"group cursor-pointer bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-2xl hover:-translate-y-2 transition-all duration-300",onClick:c=>X(s)},[e("div",Re,[e("img",{src:s.img,alt:s.name,class:"w-full h-full object-contain transition-transform duration-700 group-hover:scale-110",loading:"lazy"},null,8,Ae),t[16]||(t[16]=e("div",{class:"absolute inset-0 bg-black opacity-0 group-hover:opacity-10 transition-opacity"},null,-1)),u(j).authenticatedweb?(l(),r("button",{key:0,onClick:q(c=>O(s),["stop"]),class:y(["absolute top-3 right-3 p-2.5 bg-white rounded-full shadow-lg z-10",{"text-red-500":s.is_wished}])},t[15]||(t[15]=[e("svg",{class:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24"},[e("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})],-1)]),10,He)):w("",!0)]),e("div",Te,[e("h3",qe,n(W(s.name,50)),1),s.sub_name?(l(),r("p",Ge,n(s.sub_name),1)):w("",!0),e("div",Qe,[e("span",We,n(s.total_rating||"0.0"),1),t[17]||(t[17]=e("svg",{class:"w-4 h-4 text-yellow-500 fill-current",viewBox:"0 0 24 24"},[e("path",{d:"M12 17.27l6.18 3.73-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73-1.64 7.03z"})],-1)),e("span",Je,"("+n(s.total_reviews||0)+")",1)]),e("div",Ke,[e("div",Oe,[e("span",Xe,n(a.$t("currencyLabel"))+" "+n(I(s.final_price)),1),s.total_discounts_value>0?(l(),r("span",Ye,n(a.$t("currencyLabel"))+" "+n(I(s.base_price)),1)):w("",!0)]),e("button",{onClick:q(c=>K(s),["stop"]),disabled:s.is_stock===0,class:y(["p-3 rounded-full transition-all duration-300 shadow-md",[s.in_cart?"bg-[#0b3baa] text-white":s.is_stock===0?"bg-gray-200 text-gray-400 cursor-not-allowed":"bg-[#A6853B] text-white hover:bg-[#8f702c]"]])},[s.in_cart?(l(),r("svg",et,t[18]||(t[18]=[e("path",{d:"M9 16.2l-3.5-3.5a.984.984 0 0 0-1.4 0 .984.984 0 0 0 0 1.4l4.2 4.2c.39.39 1.01.39 1.4 0l8.4-8.4a.984.984 0 0 0 0-1.4.984.984 0 0 0-1.4 0L9 16.2z"},null,-1)]))):(l(),r("svg",tt,t[19]||(t[19]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.182 1.708.707 1.708H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"},null,-1)])))],10,Ze)]),s.is_free_shipping?(l(),r("div",st,[t[20]||(t[20]=e("i",{class:"pi pi-truck mr-1"},null,-1)),de(" "+n(a.$t("products.Free_Delivery")),1)])):w("",!0)])],8,Ie))),128))]),e("div",at,[le(u(ue),{rows:P.value,totalRecords:E.value,first:(b.value-1)*P.value,onPage:t[8]||(t[8]=s=>Y(s)),template:"PrevPageLink PageLinks NextPageLink",class:"custom-paginator"},null,8,["rows","totalRecords","first"])])])]))]))}},dt=ee(ot,[["__scopeId","data-v-6a861322"]]);export{dt as default};
