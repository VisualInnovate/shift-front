import{_ as Z,p as ee,l as te,u as se,z as ae,r as p,c as q,x as N,q as oe,e as n,h as i,g as e,t as l,j as d,A as y,B as g,C as S,D as M,F as A,m as H,n as w,i as le,b as k,y as ne,E as ie,G as T,v as re,H as de}from"./index-df093464.js";import{l as ue}from"./lodash-d9203ffc.js";import{d as ce}from"./banner-addtion-e4104052.js";const pe={class:"mx-auto mt-16 max-w-[1440px] px-4 sm:px-6 lg:px-8 pb-16"},_e={key:0,class:"flex flex-col items-center justify-center py-20"},me={class:"mt-4 text-lg text-gray-600"},ge={key:1,class:"text-center py-20"},ve={class:"text-xl font-semibold text-red-600 mb-4"},fe={key:2,class:"lg:flex gap-8"},he={class:"lg:w-1/4 mb-8 lg:mb-0"},be={class:"bg-white p-6 rounded-xl shadow-lg sticky top-24"},xe={class:"font-bold text-xl mb-6"},ye={class:"space-y-6"},we={class:"border-b pb-5"},ke={class:"font-semibold"},Ce={class:"mt-4 space-y-3"},Be=["placeholder"],Le=["id","value"],Me=["for"],je={class:"border-b pb-5"},Pe={class:"font-semibold"},$e={class:"mt-4"},Fe={class:"text-center text-sm font-medium mt-2"},ze={class:"font-semibold"},Ve={class:"mt-4 flex gap-3"},Ne=["placeholder"],Se=["placeholder"],Ue={class:"lg:w-3/4"},De={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"},Ee=["onClick"],Ie={class:"relative aspect-square bg-gray-100 overflow-hidden"},Re=["src","alt"],qe=["onClick"],Ae={class:"p-5 flex flex-col flex-grow"},He={class:"font-semibold text-gray-900 text-lg line-clamp-2 leading-tight mb-2"},Te={key:0,class:"text-gray-600 text-sm line-clamp-2 mb-3 leading-snug"},Ge={class:"flex items-center gap-1 mb-3"},Qe={class:"text-yellow-500 font-bold text-sm"},We={class:"text-gray-500 text-xs"},Je={class:"mt-auto flex items-center justify-between"},Ke={class:"flex items-baseline gap-2"},Oe={class:"text-2xl font-bold text-gray-900"},Xe={key:0,class:"text-base line-through text-blue-600 font-medium opacity-80"},Ye=["onClick","disabled"],Ze={key:0,class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24"},et={key:1,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},tt={key:1,class:"flex items-center mt-3 text-[#0b3baa] text-xs font-medium"},st={class:"mt-12 flex justify-center"},at={__name:"produts-category",setup(ot){const f=ee(),j=te(),{t:u,locale:h}=se(),P=ae();h.value=localStorage.getItem("appLang")||"en";const U=p(!0),C=p(null),D=p([]),b=p(1),$=p(12),E=p(0),r=p({category_ids:[],brand_ids:[],rate:0,min_price:null,max_price:null}),_=p({brand:!0,rating:!1,price:!1}),B=p([]),v=p(""),F=p(!0),z=p(1),G=q(()=>v.value?B.value.filter(a=>a.name.toLowerCase().includes(v.value.toLowerCase())):B.value),Q=q(()=>D.value),I=a=>Number(a).toFixed(2),W=(a,t)=>(a==null?void 0:a.length)>t?a.slice(0,t)+"...":a,L=async(a=1,t=!1)=>{try{const c=(await k.get(`/api/home/brands-by-category/${f.params.id||""}`,{params:{page:a,search:v.value||void 0}})).data.data,o=c.data.map(m=>({id:m.id,name:h.value==="ar"?m.name_ar||m.name_en:m.name_en||m.name_ar}));B.value=t?[...B.value,...o]:o,F.value=!!c.next_page_url,z.value=c.current_page}catch(s){console.error("Brands error:",s)}},J=()=>{F.value&&L(z.value+1,!0)},x=async(a=1)=>{C.value=null;try{const t={page:a,limit:$.value,category_ids:f.params.id?f.params.id:void 0,brand_ids:r.value.brand_ids.length?r.value.brand_ids.join(","):void 0,rate:r.value.rate>0?r.value.rate:void 0,min_price:r.value.min_price,max_price:r.value.max_price},c=(await k.get("/api/home/products",{params:t})).data.data;D.value=c.data.map(o=>{var m,R;return{id:o.id,name:h.value==="ar"?o.name_ar||o.name_en:o.name_en||o.name_ar,sub_name:h.value==="ar"?o.sub_name_ar||o.sub_name_en:o.sub_name_en||o.sub_name_ar,base_price:parseFloat(o.base_price),total_discounts_value:parseFloat(o.total_discounts_value||0),final_price:parseFloat(o.base_price)-parseFloat(o.total_discounts_value||0),img:((R=(m=o.media)==null?void 0:m.find(Y=>Y.name==="product_main_image"))==null?void 0:R.url)||o.key_default_image||ce,is_wished:o.is_wished||!1,in_cart:o.in_cart||!1,is_stock:o.is_stock,is_free_shipping:o.is_free_shipping||!1}}),b.value=c.current_page,E.value=c.total}catch(t){C.value=u("products.errorLoading"),console.error(t)}finally{U.value=!1}},K=async a=>{if(!P.authenticatedweb)return j.push({name:"authlog"});if(a.is_stock!==0)try{await k.post("/api/cart/add",{product_id:a.id,quantity:1}),a.in_cart=!0}catch{alert(u("cart.error"))}},O=async a=>{if(!P.authenticatedweb)return j.push({name:"authlog"});const t=a.is_wished;try{t?await k.delete(`/api/wishlists/${a.id}`):await k.post("/api/wishlists",{product_id:a.id}),a.is_wished=!t}catch{a.is_wished=t}},V=a=>{_.value[a]=!_.value[a]},X=a=>{b.value=a.page+1,x(b.value)};return N(v,ue.debounce(()=>{z.value=1,L()},300)),N(r,()=>{b.value=1,x()},{deep:!0}),N(h,()=>{L(),x()}),oe(()=>{f.params.id&&(r.value.category_ids=[f.params.id]),L(),x()}),(a,t)=>(n(),i("div",pe,[U.value?(n(),i("div",_e,[t[9]||(t[9]=e("img",{src:ne,alt:"Loading",class:"w-32 h-32 object-contain animate-bounce"},null,-1)),e("p",me,l(d(u)("common.loading")),1)])):C.value?(n(),i("div",ge,[e("p",ve,l(C.value),1),e("button",{onClick:x,class:"bg-indigo-600 text-white px-6 py-3 rounded-lg hover:bg-indigo-700 transition"},l(d(u)("products.retry")),1)])):(n(),i("div",fe,[e("aside",he,[e("div",be,[e("h3",xe,l(d(u)("products.filters")),1),e("div",ye,[e("div",we,[e("div",{onClick:t[0]||(t[0]=s=>V("brand")),class:"flex justify-between items-center cursor-pointer"},[e("span",ke,l(d(u)("products.brand")),1),(n(),i("svg",{class:y([{"rotate-180":_.value.brand},"w-5 h-5 transition-transform"]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},t[10]||(t[10]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)]),2))]),g(e("div",Ce,[g(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>v.value=s),type:"text",placeholder:d(u)("products.searchBrand"),class:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"},null,8,Be),[[M,v.value]]),(n(!0),i(A,null,H(G.value,s=>(n(),i("div",{key:s.id,class:"flex items-center"},[g(e("input",{type:"checkbox",id:`brand-${s.id}`,value:s.id,"onUpdate:modelValue":t[2]||(t[2]=c=>r.value.brand_ids=c),class:"w-4 h-4 text-indigo-600 rounded focus:ring-indigo-500"},null,8,Le),[[ie,r.value.brand_ids]]),e("label",{for:`brand-${s.id}`,class:"mx-3 text-sm text-gray-700"},l(s.name),9,Me)]))),128)),F.value?(n(),i("button",{key:0,onClick:J,class:"text-indigo-600 text-sm hover:underline"},l(d(u)("products.loadMore")),1)):w("",!0)],512),[[S,_.value.brand]])]),e("div",je,[e("div",{onClick:t[3]||(t[3]=s=>V("rating")),class:"flex justify-between items-center cursor-pointer"},[e("span",Pe,l(d(u)("products.rating")),1),(n(),i("svg",{class:y([{"rotate-180":_.value.rating},"w-5 h-5 transition-transform"]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},t[11]||(t[11]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)]),2))]),g(e("div",$e,[g(e("input",{type:"range","onUpdate:modelValue":t[4]||(t[4]=s=>r.value.rate=s),min:"0",max:"5",step:"1",class:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider"},null,512),[[M,r.value.rate,void 0,{number:!0}]]),t[12]||(t[12]=e("div",{class:"flex justify-between text-xs text-gray-500 mt-2"},[e("span",null,"0"),e("span",null,"1"),e("span",null,"2"),e("span",null,"3"),e("span",null,"4"),e("span",null,"5")],-1)),e("p",Fe,l(r.value.rate)+"+ "+l(d(u)("products.stars")),1)],512),[[S,_.value.rating]])]),e("div",null,[e("div",{onClick:t[5]||(t[5]=s=>V("price")),class:"flex justify-between items-center cursor-pointer"},[e("span",ze,l(d(u)("products.price")),1),(n(),i("svg",{class:y([{"rotate-180":_.value.price},"w-5 h-5 transition-transform"]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},t[13]||(t[13]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)]),2))]),g(e("div",Ve,[g(e("input",{type:"number","onUpdate:modelValue":t[6]||(t[6]=s=>r.value.min_price=s),placeholder:d(u)("min_price"),class:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500"},null,8,Ne),[[M,r.value.min_price,void 0,{number:!0}]]),t[14]||(t[14]=e("span",{class:"self-center"},"-",-1)),g(e("input",{type:"number","onUpdate:modelValue":t[7]||(t[7]=s=>r.value.max_price=s),placeholder:d(u)("max_price"),class:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500"},null,8,Se),[[M,r.value.max_price,void 0,{number:!0}]])],512),[[S,_.value.price]])])])])]),e("div",Ue,[e("div",De,[(n(!0),i(A,null,H(Q.value,s=>(n(),i("div",{key:s.id,class:"group cursor-pointer bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-2xl hover:-translate-y-2 transition-all duration-300",onClick:c=>d(j).push({name:"Product-details",params:{id:s.id}})},[e("div",Ie,[e("img",{src:s.img,alt:s.name,class:"w-full h-full object-contain transition-transform duration-700 group-hover:scale-110",loading:"lazy"},null,8,Re),t[16]||(t[16]=e("div",{class:"absolute inset-0 bg-black opacity-0 group-hover:opacity-10 transition-opacity"},null,-1)),d(P).authenticatedweb?(n(),i("button",{key:0,onClick:T(c=>O(s),["stop"]),class:y(["absolute top-3 right-3 p-2.5 bg-white rounded-full shadow-lg z-10",{"text-red-500":s.is_wished}])},t[15]||(t[15]=[e("svg",{class:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24"},[e("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})],-1)]),10,qe)):w("",!0)]),e("div",Ae,[e("h3",He,l(W(s.name,50)),1),s.sub_name?(n(),i("p",Te,l(s.sub_name),1)):w("",!0),e("div",Ge,[e("span",Qe,l(s.total_rating||"0.0"),1),t[17]||(t[17]=e("svg",{class:"w-4 h-4 text-yellow-500 fill-current",viewBox:"0 0 24 24"},[e("path",{d:"M12 17.27l6.18 3.73-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73-1.64 7.03z"})],-1)),e("span",We,"("+l(s.total_reviews||0)+")",1)]),e("div",Je,[e("div",Ke,[e("span",Oe,l(a.$t("currencyLabel"))+" "+l(I(s.final_price)),1),s.total_discounts_value>0?(n(),i("span",Xe,l(a.$t("currencyLabel"))+" "+l(I(s.base_price)),1)):w("",!0)]),e("button",{onClick:T(c=>K(s),["stop"]),disabled:s.is_stock===0,class:y(["p-3 rounded-full transition-all duration-300 shadow-md",[s.in_cart?"bg-[#0b3baa] text-white":s.is_stock===0?"bg-gray-200 text-gray-400 cursor-not-allowed":"bg-[#A6853B] text-white hover:bg-[#8f702c]"]])},[s.in_cart?(n(),i("svg",Ze,t[18]||(t[18]=[e("path",{d:"M9 16.2l-3.5-3.5a.984.984 0 0 0-1.4 0 .984.984 0 0 0 0 1.4l4.2 4.2c.39.39 1.01.39 1.4 0l8.4-8.4a.984.984 0 0 0 0-1.4.984.984 0 0 0-1.4 0L9 16.2z"},null,-1)]))):(n(),i("svg",et,t[19]||(t[19]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.182 1.708.707 1.708H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"},null,-1)])))],10,Ye)]),s.is_free_shipping?(n(),i("div",tt,[t[20]||(t[20]=e("i",{class:"pi pi-truck mr-1"},null,-1)),re(" "+l(a.$t("products.Free_Delivery")),1)])):w("",!0)])],8,Ee))),128))]),e("div",st,[le(d(de),{rows:$.value,totalRecords:E.value,first:(b.value-1)*$.value,onPage:t[8]||(t[8]=s=>X(s)),template:"PrevPageLink PageLinks NextPageLink",class:"custom-paginator"},null,8,["rows","totalRecords","first"])])])]))]))}},rt=Z(at,[["__scopeId","data-v-a84bd0c4"]]);export{rt as default};
