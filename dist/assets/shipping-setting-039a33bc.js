import{u as j,k as H,G as L,j as Z,r as x,l as F,o as M,a0 as B,a as g,c as f,y as I,f as o,t as n,e,p as b,h as i,w as k,F as w,d as R,C as G,i as D,ag as m,aj as J,T as U,ad as T,V as y,Q}from"./index-9c7fed1c.js";import{h as q}from"./moment-fbc5633a.js";import{x as W,A as K,O as P}from"./index.es-c69a672a.js";const X={class:"max-w-5xl mx-auto p-6 bg-white rounded-xl shadow-lg"},Y={class:"text-3xl font-bold text-center mb-8 text-gray-800"},ee={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},se={class:"space-y-2"},te={for:"min_amount",class:"block text-sm font-medium text-gray-700"},oe={class:"space-y-2"},ae={for:"free_amount",class:"block text-sm font-medium text-gray-700"},le={class:"space-y-2"},ie={for:"days",class:"block text-sm font-medium text-gray-700"},re={class:"space-y-2"},ne={for:"from",class:"block text-sm font-medium text-gray-700"},de={class:"space-y-2"},ue={for:"to",class:"block text-sm font-medium text-gray-700"},pe={class:"flex"},ce={class:"space-y-4 my-auto"},me={class:"flex items-center space-x-4"},ge={class:"block text-sm font-medium text-gray-700 mx-2"},fe={class:"space-y-4 my-auto"},be={class:"flex items-center space-x-4"},_e={class:"block text-sm font-medium text-gray-700 mx-2"},ye={class:"space-y-2 md:col-span-2"},he={class:"text-xl font-semibold text-gray-800 mb-4"},xe={class:"space-y-2 md:col-span-2"},ve={class:"block text-sm font-medium text-gray-700"},Ve={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Se={class:"space-y-2"},Fe=["for"],ke={class:"space-y-2"},we=["for"],De={class:"space-y-2"},Ue=["for"],Te={class:"space-y-2"},qe=["for"],Ce={class:"space-y-2"},Ee=["for"],ze={class:"flex items-center"},Oe={class:"pt-4 flex justify-center space-x-4"},Ae={key:0},$e={key:1,class:"pi pi-spinner pi-spin"},Ze={__name:"shipping-setting",setup(Ne){const v=j(),h=H(),_=L(),{t}=Z(),c=x(!1),a=x({category_id:null,is_enabled:!1,min_amount:0,free_amount:0,express_enabled:!1,days:[],from:"",to:"",lat:31.984983325941823,long:35.900908045672196,distance:1e3,zones:[]}),C=F(()=>{const d=Number(a.value.distance)||1e3;return{center:{lat:Number(a.value.lat),lng:Number(a.value.long)},radius:d,strokeColor:"#FF0000",strokeOpacity:.8,strokeWeight:2,fillColor:"#FF0000",fillOpacity:.35}});x([]);const E=F(()=>[{label:t("days.sunday"),value:0},{label:t("days.monday"),value:1},{label:t("days.tuesday"),value:2},{label:t("days.wednesday"),value:3},{label:t("days.thursday"),value:4},{label:t("days.friday"),value:5},{label:t("days.saturday"),value:6}]),z=async()=>{c.value=!0;try{const d=await D.get(`/api/category/shipping/setting/show/${h.params.id}`),s=d.data.data.category_shipping_setting;a.value.category_id=h.params.id,d.data.data.category_shipping_setting&&(a.value={category_id:h.params.id,is_enabled:s.is_enabled,min_amount:parseFloat(s.min_amount),free_amount:parseFloat(s.free_amount),express_enabled:s.express_enabled,days:Array.isArray(s.days)?s.days:JSON.parse(s.days||"[]"),from:s.from?q(s.from,"H:mm").format("HH:mm"):"",to:s.to?q(s.to,"H:mm").format("HH:mm"):"",lat:parseFloat(s.lat),long:parseFloat(s.long),distance:parseFloat(s.distance||1e3),zones:s.zones.map(p=>({from:parseFloat(p.from),to:parseFloat(p.to),fee:parseFloat(p.fee),express_time:parseInt(p.express_time),express_fee:parseFloat(p.express_fee)}))})}catch(d){console.error("Error fetching shipping setting:",d),_.add({severity:"error",summary:t("error"),detail:t("shippingSetting.loadError"),life:3e3}),v.push({name:"shipping-settings"})}finally{c.value=!1}};function O(d){const s=d.latLng;a.value.lat=s.lat(),a.value.long=s.lng()}const A=()=>{a.value.zones.push({from:0,to:0,fee:0,express_time:0,express_fee:0})},$=d=>{a.value.zones.length>1?a.value.zones.splice(d,1):_.add({severity:"warn",summary:t("warning"),detail:t("shippingSetting.atLeastOneZone"),life:3e3})},N=async()=>{var d,s,p,l;c.value=!0;try{await D.post("/api/category/shipping/setting/update",a.value,{}),_.add({severity:"success",summary:t("success"),detail:t("shippingSetting.updatedSuccess"),life:3e3})}catch(r){console.error("Error:",r);const u=((s=(d=r.response)==null?void 0:d.data)==null?void 0:s.message)||t("shippingSetting.updateError"),V=((l=(p=r.response)==null?void 0:p.data)==null?void 0:l.errors)||{};let S=u;Object.keys(V).length>0&&(S=Object.values(V).flat().join(" ")),_.add({severity:"error",summary:t("error"),detail:S,life:5e3})}finally{c.value=!1}};return M(()=>{z()}),(d,s)=>{const p=B("can");return g(),f(w,null,[I((g(),f("div",X,[o("h1",Y,n(e(t)("shippingSetting.editTitle")),1),o("form",{onSubmit:G(N,["prevent"]),class:"space-y-6"},[o("div",ee,[o("div",se,[o("label",te,[b(n(e(t)("shippingSetting.minAmount"))+" ",1),s[8]||(s[8]=o("span",{class:"text-red-500"},"*",-1))]),i(e(m),{id:"min_amount",modelValue:a.value.min_amount,"onUpdate:modelValue":s[0]||(s[0]=l=>a.value.min_amount=l),mode:"decimal",minFractionDigits:2,maxFractionDigits:2,placeholder:e(t)("shippingSetting.enterMinAmount"),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",required:""},null,8,["modelValue","placeholder"])]),o("div",oe,[o("label",ae,[b(n(e(t)("shippingSetting.freeAmount"))+" ",1),s[9]||(s[9]=o("span",{class:"text-red-500"},"*",-1))]),i(e(m),{id:"free_amount",modelValue:a.value.free_amount,"onUpdate:modelValue":s[1]||(s[1]=l=>a.value.free_amount=l),mode:"decimal",minFractionDigits:2,maxFractionDigits:2,placeholder:e(t)("shippingSetting.enterFreeAmount"),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",required:""},null,8,["modelValue","placeholder"])]),o("div",le,[o("label",ie,[b(n(e(t)("shippingSetting.days"))+" ",1),s[10]||(s[10]=o("span",{class:"text-red-500"},"*",-1))]),i(e(J),{id:"days",modelValue:a.value.days,"onUpdate:modelValue":s[2]||(s[2]=l=>a.value.days=l),options:E.value,optionLabel:"label",optionValue:"value",placeholder:e(t)("shippingSetting.selectDays"),class:"w-full border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",required:""},null,8,["modelValue","options","placeholder"])]),o("div",re,[o("label",ne,[b(n(e(t)("shippingSetting.fromTime"))+" ",1),s[11]||(s[11]=o("span",{class:"text-red-500"},"*",-1))]),i(e(U),{id:"from",modelValue:a.value.from,"onUpdate:modelValue":s[3]||(s[3]=l=>a.value.from=l),type:"time",placeholder:e(t)("shippingSetting.enterFromTime"),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",required:""},null,8,["modelValue","placeholder"])]),o("div",de,[o("label",ue,[b(n(e(t)("shippingSetting.toTime"))+" ",1),s[12]||(s[12]=o("span",{class:"text-red-500"},"*",-1))]),i(e(U),{id:"to",modelValue:a.value.to,"onUpdate:modelValue":s[4]||(s[4]=l=>a.value.to=l),type:"time",placeholder:e(t)("shippingSetting.enterToTime"),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",required:""},null,8,["modelValue","placeholder"])]),o("div",pe,[o("div",ce,[o("div",me,[o("label",ge,n(e(t)("shippingSetting.isEnabled")),1),i(e(T),{modelValue:a.value.is_enabled,"onUpdate:modelValue":s[5]||(s[5]=l=>a.value.is_enabled=l)},null,8,["modelValue"])])]),o("div",fe,[o("div",be,[o("label",_e,n(e(t)("shippingSetting.expressEnabled")),1),i(e(T),{modelValue:a.value.express_enabled,"onUpdate:modelValue":s[6]||(s[6]=l=>a.value.express_enabled=l)},null,8,["modelValue"])])])]),o("div",ye,[o("h2",he,n(e(t)("shippingSetting.select_location")),1),i(e(P),{onClick:O,style:{width:"100%",height:"500px"},center:{lat:parseFloat(a.value.lat),lng:parseFloat(a.value.long)},zoom:14},{default:k(()=>[i(e(W),{options:{position:{lat:parseFloat(a.value.lat),lng:parseFloat(a.value.long)}}},null,8,["options"]),i(e(K),{options:C.value},null,8,["options"])]),_:1},8,["center"])]),o("div",xe,[o("label",ve,n(e(t)("shippingSetting.zones")),1),(g(!0),f(w,null,R(a.value.zones,(l,r)=>(g(),f("div",{key:r,class:"border p-4 rounded-lg mb-4"},[o("div",Ve,[o("div",Se,[o("label",{for:"zone_from_"+r,class:"block text-sm font-medium text-gray-700"},n(e(t)("shippingSetting.zoneFrom")),9,Fe),i(e(m),{id:"zone_from_"+r,modelValue:l.from,"onUpdate:modelValue":u=>l.from=u,mode:"decimal",minFractionDigits:2,maxFractionDigits:2,placeholder:e(t)("shippingSetting.enterZoneFrom"),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",required:""},null,8,["id","modelValue","onUpdate:modelValue","placeholder"])]),o("div",ke,[o("label",{for:"zone_to_"+r,class:"block text-sm font-medium text-gray-700"},n(e(t)("shippingSetting.zoneTo")),9,we),i(e(m),{id:"zone_to_"+r,modelValue:l.to,"onUpdate:modelValue":u=>l.to=u,mode:"decimal",minFractionDigits:2,maxFractionDigits:2,placeholder:e(t)("shippingSetting.enterZoneTo"),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",required:""},null,8,["id","modelValue","onUpdate:modelValue","placeholder"])]),o("div",De,[o("label",{for:"zone_fee_"+r,class:"block text-sm font-medium text-gray-700"},n(e(t)("shippingSetting.fee")),9,Ue),i(e(m),{id:"zone_fee_"+r,modelValue:l.fee,"onUpdate:modelValue":u=>l.fee=u,mode:"decimal",minFractionDigits:2,maxFractionDigits:2,placeholder:e(t)("shippingSetting.enterFee"),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",required:""},null,8,["id","modelValue","onUpdate:modelValue","placeholder"])]),o("div",Te,[o("label",{for:"zone_express_time_"+r,class:"block text-sm font-medium text-gray-700"},n(e(t)("shippingSetting.expressTime")),9,qe),i(e(m),{id:"zone_express_time_"+r,modelValue:l.express_time,"onUpdate:modelValue":u=>l.express_time=u,placeholder:e(t)("shippingSetting.enterExpressTime"),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",required:""},null,8,["id","modelValue","onUpdate:modelValue","placeholder"])]),o("div",Ce,[o("label",{for:"zone_express_fee_"+r,class:"block text-sm font-medium text-gray-700"},n(e(t)("shippingSetting.expressFee")),9,Ee),i(e(m),{id:"zone_express_fee_"+r,modelValue:l.express_fee,"onUpdate:modelValue":u=>l.express_fee=u,mode:"decimal",minFractionDigits:2,maxFractionDigits:2,placeholder:e(t)("shippingSetting.enterExpressFee"),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",required:""},null,8,["id","modelValue","onUpdate:modelValue","placeholder"])]),o("div",ze,[i(e(y),{icon:"pi pi-trash",class:"p-button-danger p-button-text",onClick:u=>$(r),disabled:a.value.zones.length===1},null,8,["onClick","disabled"])])])]))),128)),i(e(y),{label:e(t)("shippingSetting.addZone"),icon:"pi pi-plus",class:"p-button-outlined",onClick:A},null,8,["label"])])]),o("div",Oe,[i(e(y),{type:"button",label:e(t)("cancel"),icon:"pi pi-times",onClick:s[7]||(s[7]=l=>e(v).go(-1)),class:"px-6 py-3 bg-gray-200 mx-2 hover:bg-gray-300 text-gray-700 rounded-lg shadow-md hover:shadow-lg transition-all duration-300",disabled:c.value},null,8,["label","disabled"]),i(e(y),{type:"submit",label:e(t)("shippingSetting.updateShipping"),icon:"pi pi-check",loading:c.value,class:"px-8 py-3 bg-gradient-to-r mx-2 from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-lg shadow-md hover:shadow-lg transition-all duration-300",disabled:c.value},{default:k(()=>[c.value?(g(),f("i",$e)):(g(),f("span",Ae,n(e(t)("shippingSetting.updateShipping")),1))]),_:1},8,["label","loading","disabled"])])],32)])),[[p,"edit shipping settings"]]),i(e(Q))],64)}}};export{Ze as default};
