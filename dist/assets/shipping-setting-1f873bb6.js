import{l as B,p as N,a as I,u as R,r as L,c as H,x as J,o as K,a1 as q,e as u,h as g,B as D,g as t,v as _,t as i,j as e,G as W,i as r,w as C,n as j,F as y,m as T,b as $,ae as S,ai as b,U as w,ag as P,W as f,k as Q}from"./index-36bf7d27.js";import{x as X,O as Y}from"./index.es-0b8306b6.js";const ee={class:"min-h-screen bg-gray-50 p-4 sm:p-6 lg:p-8"},te={class:"max-w-6xl mx-auto bg-white rounded-2xl shadow-2xl p-6 md:p-10 border border-gray-100"},se={class:"text-4xl font-extrabold text-center mb-10 text-indigo-700 tracking-tight border-b pb-4"},ae={class:"p-6 border border-indigo-200 rounded-xl shadow-lg bg-indigo-50/50"},oe={class:"text-2xl font-semibold text-indigo-700 mb-6 border-b pb-2 flex items-center"},le={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6"},ie={class:"flex items-center justify-between p-3 bg-white rounded-lg border"},ne={class:"text-base font-medium text-gray-700"},re={class:"flex items-center justify-between p-3 bg-white rounded-lg border"},de={class:"text-base font-medium text-gray-700"},pe={class:"flex items-center justify-between p-3 bg-white rounded-lg border"},ue={class:"text-base font-medium text-gray-700"},ge={class:"sm:col-span-2 lg:col-span-3 space-y-2"},ce={for:"free_amount",class:"block text-sm font-medium text-gray-700"},me={class:"sm:col-span-2 lg:col-span-3 space-y-2"},he={for:"shipping_time",class:"block text-sm font-medium text-gray-700"},_e={key:0,class:"p-6 border border-teal-200 rounded-xl shadow-lg bg-teal-50/50"},be={class:"text-2xl font-semibold text-teal-700 mb-6 border-b pb-2 flex items-center"},ve={class:"space-y-4"},fe={class:"text-sm text-gray-600"},xe={class:"border border-teal-300 rounded-lg overflow-hidden shadow-md"},ye={class:"grid grid-cols-2 gap-4"},Se={class:"p-6 border border-orange-200 rounded-xl shadow-lg bg-orange-50/50"},we={class:"text-2xl font-semibold text-orange-700 mb-6 border-b pb-2 flex items-center"},Ve={class:"space-y-4"},Fe={key:0,class:"space-y-3 max-h-80 overflow-y-auto pr-2"},ke={class:"flex-1"},ze={class:"font-semibold text-lg text-gray-800"},Ue={class:"text-sm text-gray-500 block"},Le={class:"flex items-center gap-3"},qe={class:"text-sm font-medium text-gray-700 whitespace-nowrap"},De={key:1,class:"p-4 bg-white rounded-lg border border-dashed text-center text-gray-500 italic"},Ce={key:1,class:"p-6 border border-red-300 rounded-xl shadow-lg bg-red-50/50"},je={class:"text-2xl font-semibold text-red-700 mb-6 border-b pb-2 flex items-center"},Te={class:"space-y-6"},$e={class:"text-lg font-medium text-gray-600 mb-4"},Ze={class:"grid grid-cols-2 md:grid-cols-4 gap-4"},Ee={class:""},Oe={class:"text-sm font-medium text-gray-700"},Ae={class:"space-y-1"},Ge={class:"text-sm font-medium text-gray-700"},Me={class:"space-y-1"},Be={class:"text-sm font-medium text-gray-700"},Ne={class:"space-y-1"},Ie={class:"text-sm font-medium text-gray-700"},Re={class:"space-y-1"},He={class:"text-sm font-medium text-gray-700"},Je={class:"pt-8 flex justify-center space-x-6 border-t border-gray-200"},Ke={key:0},We={key:1,class:"pi pi-spinner pi-spin"},Ye={__name:"shipping-setting",setup(Pe){const V=B(),x=N(),v=I(),{t:o}=R(),h=L(!1),F=[{arabic:"عمان",english:"Amman"},{arabic:"البلقاء",english:"Balqa"},{arabic:"الزرقاء",english:"Zarqa"},{arabic:"مادبا",english:"Madaba"},{arabic:"إربد",english:"Irbid"},{arabic:"جرش",english:"Jerash"},{arabic:"عجلون",english:"Ajloun"},{arabic:"المفرق",english:"Mafraq"},{arabic:"الكرك",english:"Karak"},{arabic:"الطفيلة",english:"Tafila"},{arabic:"معان",english:"Ma'an"},{arabic:"العقبة",english:"Aqaba"}],s=L({store_id:null,has_zones:!1,is_enabled:!1,is_free:!1,shipping_time:"",free_amount:0,lat:31.984983325941823,long:35.900908045672196,zones:[],governorates:[]}),Z=H(()=>F.map(n=>({label:`${n.arabic} (${n.english})`,value:n.english.toLowerCase().replace(/[^a-z]/g,"")}))),E=async()=>{h.value=!0;try{const a=(await $.get(`/api/store/shipping/setting/show/${x.params.id}`)).data.data.store_shipping_setting;a&&(s.value={store_id:x.params.id,has_zones:!!a.has_zones,is_enabled:!!a.is_enabled,is_free:!!a.is_free,shipping_time:a.shipping_time||"",free_amount:parseFloat(a.free_amount)||0,lat:parseFloat(a.lat)||31.984983325941823,long:parseFloat(a.long)||35.900908045672196,zones:a.zones?a.zones.map(d=>({from:parseFloat(d.from),to:parseFloat(d.to),fee:parseFloat(d.fee),express_time:parseInt(d.express_time),express_fee:parseFloat(d.express_fee)})):[],governorates:a.governorates?a.governorates.map(d=>({governorate:d.governorate,fee:parseFloat(d.fee)})):[]})}catch(n){console.error("Error fetching shipping setting:",n),v.add({severity:"error",summary:o("error"),detail:o("shippingSetting.loadError"),life:3e3}),V.push({name:"shipping-settings"})}finally{h.value=!1}};function O(n){const a=n.latLng;s.value.lat=a.lat(),s.value.long=a.lng()}const k=()=>{s.value.zones.push({from:0,to:0,fee:0,express_time:0,express_fee:0})},A=n=>{s.value.zones.length>1?s.value.zones.splice(n,1):v.add({severity:"warn",summary:o("warning"),detail:o("shippingSetting.atLeastOneZone"),life:3e3})},G=n=>{const a=s.value.governorates.map(c=>c.governorate),d=Array.isArray(n)?n:[n];d.forEach(c=>{a.includes(c)||s.value.governorates.push({governorate:c,fee:0})}),s.value.governorates=s.value.governorates.filter(c=>d.includes(c.governorate))};J(()=>s.value.has_zones,n=>{n?s.value.zones.length===0&&k():s.value.zones=[]});const M=async()=>{var a,d,c,l;h.value=!0;const n={store_id:x.params.id,has_zones:s.value.has_zones?1:0,is_enabled:s.value.is_enabled?1:0,is_free:s.value.is_free?1:0,shipping_time:s.value.shipping_time,free_amount:s.value.free_amount,lat:s.value.lat.toString(),long:s.value.long.toString()};if(s.value.has_zones){if(s.value.zones.length===0){v.add({severity:"error",summary:o("error"),detail:o("shippingSetting.atLeastOneZone"),life:5e3}),h.value=!1;return}n.zones=s.value.zones}n.governorates=s.value.governorates;try{await $.post("/api/store/shipping/setting/update",n),v.add({severity:"success",summary:o("success"),detail:o("shippingSetting.updatedSuccess"),life:3e3})}catch(m){console.error("Error:",m);const p=((d=(a=m.response)==null?void 0:a.data)==null?void 0:d.message)||o("shippingSetting.updateError"),z=((l=(c=m.response)==null?void 0:c.data)==null?void 0:l.errors)||{};let U=p;Object.keys(z).length>0&&(U=Object.values(z).flat().join(" ")),v.add({severity:"error",summary:o("error"),detail:U,life:5e3})}finally{h.value=!1}};return K(()=>{E()}),(n,a)=>{const d=q("tooltip"),c=q("can");return u(),g(y,null,[D((u(),g("div",ee,[t("div",te,[t("h1",se,[a[6]||(a[6]=t("i",{class:"pi pi-truck mr-3 text-indigo-500"},null,-1)),_(i(e(o)("shippingSetting.editTitle")),1)]),t("form",{onSubmit:W(M,["prevent"]),class:"space-y-10"},[t("div",ae,[t("h2",oe,[a[7]||(a[7]=t("i",{class:"pi pi-cog mr-2"},null,-1)),_(i(e(o)("shippingSetting.generalSettings")||"General Settings"),1)]),t("div",le,[t("div",ie,[t("label",ne,i(e(o)("shippingSetting.hasZones")),1),r(e(S),{modelValue:s.value.has_zones,"onUpdate:modelValue":a[0]||(a[0]=l=>s.value.has_zones=l)},null,8,["modelValue"])]),t("div",re,[t("label",de,i(e(o)("shippingSetting.isEnabled")),1),r(e(S),{modelValue:s.value.is_enabled,"onUpdate:modelValue":a[1]||(a[1]=l=>s.value.is_enabled=l)},null,8,["modelValue"])]),t("div",pe,[t("label",ue,i(e(o)("shippingSetting.isFree")),1),r(e(S),{modelValue:s.value.is_free,"onUpdate:modelValue":a[2]||(a[2]=l=>s.value.is_free=l)},null,8,["modelValue"])]),t("div",ge,[t("label",ce,[_(i(e(o)("shippingSetting.freeAmount"))+" ",1),a[8]||(a[8]=t("span",{class:"text-red-500"},"*",-1))]),r(e(b),{id:"free_amount",modelValue:s.value.free_amount,"onUpdate:modelValue":a[3]||(a[3]=l=>s.value.free_amount=l),mode:"decimal",minFractionDigits:2,maxFractionDigits:2,placeholder:e(o)("shippingSetting.enterFreeAmount"),class:"w-full p-inputtext-lg",required:""},null,8,["modelValue","placeholder"])]),t("div",me,[t("label",he,[_(i(e(o)("shippingSetting.shippingTime"))+" ",1),a[9]||(a[9]=t("span",{class:"text-red-500"},"*",-1))]),r(e(w),{id:"shipping_time",modelValue:s.value.shipping_time,"onUpdate:modelValue":a[4]||(a[4]=l=>s.value.shipping_time=l),placeholder:e(o)("shippingSetting.enterShippingTime"),class:"w-full p-inputtext-lg",required:""},null,8,["modelValue","placeholder"])])])]),s.value.has_zones?(u(),g("div",_e,[t("h2",be,[a[10]||(a[10]=t("i",{class:"pi pi-map-marker mr-2"},null,-1)),_(i(e(o)("shippingSetting.select_location")),1)]),t("div",ve,[t("p",fe,i(e(o)("shippingSetting.locationHint")||"Click on the map to set your store location (Latitude and Longitude)."),1),t("div",xe,[r(e(Y),{onClick:O,style:{width:"100%",height:"400px"},center:{lat:parseFloat(s.value.lat),lng:parseFloat(s.value.long)},zoom:12},{default:C(()=>[r(e(X),{options:{position:{lat:parseFloat(s.value.lat),lng:parseFloat(s.value.long)},label:"Store"}},null,8,["options"])]),_:1},8,["center"])]),t("div",ye,[r(e(w),{value:s.value.lat.toFixed(6),readonly:"",placeholder:"Latitude",class:"font-mono text-sm"},null,8,["value"]),r(e(w),{value:s.value.long.toFixed(6),readonly:"",placeholder:"Longitude",class:"font-mono text-sm"},null,8,["value"])])])])):j("",!0),t("div",Se,[t("h2",we,[a[11]||(a[11]=t("i",{class:"pi pi-globe mr-2"},null,-1)),_(i(e(o)("shippingSetting.governorates")),1)]),t("div",Ve,[r(e(P),{options:Z.value,optionLabel:"label",optionValue:"value",modelValue:s.value.governorates.map(l=>l.governorate),"onUpdate:modelValue":G,placeholder:e(o)("shippingSetting.selectGovernorates"),class:"w-full p-inputtext-lg",display:"chip"},null,8,["options","modelValue","placeholder"]),s.value.governorates.length>0?(u(),g("div",Fe,[(u(!0),g(y,null,T(s.value.governorates,l=>{var m;return u(),g("div",{key:l.governorate,class:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 p-4 bg-white rounded-lg border shadow-sm hover:border-orange-400 transition duration-200"},[t("div",ke,[t("span",ze,i(((m=F.find(p=>p.english.toLowerCase().replace(/[^a-z]/g,"")===l.governorate))==null?void 0:m.arabic)||l.governorate),1),t("span",Ue,"("+i(l.governorate)+")",1)]),t("div",Le,[t("label",qe,i(e(o)("shippingSetting.fee"))+":",1),r(e(b),{modelValue:l.fee,"onUpdate:modelValue":p=>l.fee=p,mode:"decimal",minFractionDigits:2,maxFractionDigits:2,placeholder:e(o)("shippingSetting.enterFee"),class:"p-inputtext-sm",required:""},null,8,["modelValue","onUpdate:modelValue","placeholder"])])])}),128))])):(u(),g("div",De,i(e(o)("shippingSetting.noGovernoratesSelected")),1))])]),s.value.has_zones?(u(),g("div",Ce,[t("h2",je,[a[12]||(a[12]=t("i",{class:"pi pi-sort-numeric-up mr-2"},null,-1)),_(i(e(o)("shippingSetting.zones")),1)]),t("div",Te,[(u(!0),g(y,null,T(s.value.zones,(l,m)=>(u(),g("div",{key:m,class:"border border-red-200 p-5 rounded-lg bg-white shadow-md relative"},[D(r(e(f),{icon:"pi pi-trash",class:"p-button-rounded p-button-danger p-button-text absolute top-2 right-2",onClick:p=>A(m),disabled:s.value.zones.length===1},null,8,["onClick","disabled"]),[[d,s.value.zones.length===1?e(o)("shippingSetting.atLeastOneZone"):e(o)("deleteZone"),void 0,{top:!0}]]),t("h3",$e,i(e(o)("shippingSetting.zone"))+" #"+i(m+1),1),t("div",Ze,[t("div",Ee,[t("label",Oe,i(e(o)("shippingSetting.zoneFrom")),1),r(e(b),{placeholder:e(o)("shippingSetting.zoneFrom"),modelValue:l.from,"onUpdate:modelValue":p=>l.from=p,mode:"decimal",minFractionDigits:2,required:"",class:"w-full"},null,8,["placeholder","modelValue","onUpdate:modelValue"])]),t("div",Ae,[t("label",Ge,i(e(o)("shippingSetting.zoneTo")),1),r(e(b),{placeholder:e(o)("shippingSetting.zoneTo"),modelValue:l.to,"onUpdate:modelValue":p=>l.to=p,mode:"decimal",minFractionDigits:2,required:"",class:"w-full"},null,8,["placeholder","modelValue","onUpdate:modelValue"])]),t("div",Me,[t("label",Be,i(e(o)("shippingSetting.fee")),1),r(e(b),{placeholder:e(o)("shippingSetting.fee"),modelValue:l.fee,"onUpdate:modelValue":p=>l.fee=p,mode:"decimal",minFractionDigits:2,required:"",class:"w-full"},null,8,["placeholder","modelValue","onUpdate:modelValue"])]),t("div",Ne,[t("label",Ie,i(e(o)("shippingSetting.expressTime")),1),r(e(b),{placeholder:e(o)("shippingSetting.expressTime"),modelValue:l.express_time,"onUpdate:modelValue":p=>l.express_time=p,required:"",class:"w-full"},null,8,["placeholder","modelValue","onUpdate:modelValue"])]),t("div",Re,[t("label",He,i(e(o)("shippingSetting.expressFee")),1),r(e(b),{placeholder:e(o)("shippingSetting.expressFee"),modelValue:l.express_fee,"onUpdate:modelValue":p=>l.express_fee=p,mode:"decimal",minFractionDigits:2,required:"",class:"w-full"},null,8,["placeholder","modelValue","onUpdate:modelValue"])])])]))),128)),r(e(f),{label:e(o)("shippingSetting.addZone"),icon:"pi pi-plus",class:"p-button-outlined p-button-secondary p-button-sm mt-4 hover:bg-red-100",onClick:k},null,8,["label"])])])):j("",!0),t("div",Je,[r(e(f),{type:"button",label:e(o)("cancel"),icon:"pi pi-times",onClick:a[5]||(a[5]=l=>e(V).go(-1)),class:"p-button-secondary p-button-lg px-6 mx-1 shadow-md hover:shadow-lg transition-all duration-300",disabled:h.value},null,8,["label","disabled"]),r(e(f),{type:"submit",label:e(o)("shippingSetting.updateShipping"),icon:"pi pi-check",loading:h.value,class:"p-button-success p-button-lg px-8 bg-gradient-to-r from-indigo-500 to-blue-500 border-none hover:from-indigo-600 hover:to-blue-600 shadow-xl transition-all duration-300 transform hover:scale-[1.02]"},{default:C(()=>[h.value?(u(),g("i",We)):(u(),g("span",Ke,i(e(o)("shippingSetting.updateShipping")),1))]),_:1},8,["label","loading"])])],32)])])),[[c,"edit shipping settings"]]),r(e(Q))],64)}}};export{Ye as default};
