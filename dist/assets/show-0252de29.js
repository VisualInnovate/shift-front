import{_ as xe,b as Le,a as De,c as Ce,at as Fe,u as Ie,r as c,d as $,z as Ee,o as Se,q as V,e as p,f as v,h as r,g as t,k as _,t as i,n as f,l as y,F as Ue,m as Re,w as oe,p as L}from"./index-7b82f61b.js";import{l as ne}from"./lodash-3e556b5d.js";const Me=["dir"],qe={key:0,class:"card-fancy mb-8"},Ne={class:"flex flex-col md:flex-row md:justify-between md:items-center"},Be={class:"text-3xl font-extrabold text-blue-800 flex items-center mb-4 md:mb-0"},Te={class:"text-blue-600"},je={class:"card-fancy mb-8"},ze={class:"text-2xl font-bold mb-6 text-gray-800 border-b pb-3 border-blue-100 flex items-center"},Oe={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},Pe={class:"field-group"},Ae={class:"input-label"},He={key:0,class:"p-error"},Qe={class:"field-group"},Ge={class:"input-label"},Je={key:0,class:"p-error"},Ke={class:"field-group"},We={class:"input-label"},Xe={key:0,class:"p-error"},Ye={key:0,class:"field-group"},Ze={class:"input-label"},ea={key:0,class:"p-error"},aa={class:"input-label"},ta={key:0,class:"p-error"},la={class:"field-group lg:col-span-3"},sa={class:"input-label"},oa={class:"flex items-center space-x-4"},na={key:0,class:"p-error"},ia={class:"card-fancy mb-8"},da={class:"text-2xl font-bold mb-6 text-gray-800 border-b pb-3 border-blue-100 flex items-center"},ua={key:0,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"},ra={key:0,class:"h-40 overflow-hidden"},ma=["src","alt"],ca={class:"p-5"},pa={class:"flex justify-between items-start mb-4"},va={class:"flex-1"},_a={class:"font-bold text-lg text-gray-900 truncate"},ba=["dir"],ga={class:"text-xs font-medium text-blue-600 bg-blue-50/50 inline-block px-2 py-1 rounded-full"},fa={class:"flex gap-3 justify-end pt-4 border-t border-gray-100"},ya={key:1,class:"text-center text-gray-500 py-12 text-lg italic border-2 border-dashed border-gray-300 rounded-xl m-4"},wa={key:0,class:"p-fluid"},ha={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},$a={class:"field-group"},Va={class:"input-label"},ka={class:"field-group"},xa={class:"input-label"},La={class:"field-group"},Da={class:"input-label"},Ca={key:0,class:"field-group"},Fa={class:"input-label"},Ia={class:"input-label"},Ea={class:"field-group lg:col-span-3"},Sa={class:"input-label"},Ua={class:"flex items-center space-x-4"},Ra={class:"text-xs text-gray-500 mt-1"},Ma={__name:"show",setup(qa){Le();const T=De(),g=Ce(),ie=Fe(),{t:o,locale:de}=Ie(),k=c(null),l=c({custom_tab_id:T.params.id,name_en:"",name_ar:"",type:null,model_id:null,ids:[],image:null}),D=c([]),E=c([]),j=c(!1),H=c(!1),z=c(!1),b=c(!1),C=c(!1),n=c(null),S=c([]),U=c([]),O=c(!1),Q=c(!1),P=c(!1),R=c(!1),F=c({new:"",edit:""}),ue=$(()=>de.value),M=$(()=>ue.value==="en"?"name_en":"name_ar"),G=$(()=>M.value),J=$(()=>e=>{const a=e[M.value]||e.name_en,d=e.type==="store"?o("custom_tabs.store"):o("custom_tabs.market");return`${a} (${d})`}),re=$(()=>{var a;return{store:o("custom_tabs.store"),category:o("custom_tabs.category"),market:o("custom_tabs.market")}[(a=k.value)==null?void 0:a.belongs_to]||o("custom_tabs.unknown")}),me=$(()=>{var a;const e=(a=k.value)==null?void 0:a.model;return e&&(e[M.value]||e.name)||""}),K=[{label:o("custom_tabs.categories"),value:1},{label:o("custom_tabs.products"),value:2},{label:o("brands"),value:3}],q=e=>e?{1:o("custom_tabs.select_categories"),2:o("custom_tabs.select_products"),3:o("custom_tabs.select_brands")}[e]:o("custom_tabs.select_items"),W=e=>q(e),ce=e=>({1:o("custom_tabs.category"),2:o("custom_tabs.product"),3:o("custom_tabs.brand")})[String(e)]||o("custom_tabs.unknown"),pe=$(()=>{const e=l.value.name_en.trim()&&l.value.name_ar.trim()&&l.value.type&&l.value.image&&l.value.ids.length>0;return l.value.type===1?e&&l.value.model_id:e}),ve=$(()=>{if(!n.value)return!1;const e=n.value.name_en.trim()&&n.value.name_ar.trim()&&n.value.ids.length>0;return n.value.type===1?e&&n.value.model_id:e}),X=async(e="new")=>{const a=e==="new"?H:Q,d=e==="new"?E:U;a.value=!0;try{const{data:u}=await L.get("/api/custom-tab-details/get/markets-stores");if(u.is_success)d.value=u.data.map(m=>({...m,name_en:m.name_en||"",name_ar:m.name_ar||""}));else throw new Error(u.message)}catch{g.add({severity:"error",summary:o("error"),detail:o("custom_tabs.models_load_failed"),life:3e3}),d.value=[]}finally{a.value=!1}},A=async e=>{const a=e==="new"?l.value:n.value,d=e==="new"?D:S,u=e==="new"?j:O;if(!a.model_id||a.type!==1){d.value=[];return}u.value=!0;try{const m=(e==="new"?E:U).value.find(h=>h.id===a.model_id);if(!m)throw new Error("Model not found");const w=m.type,{data:x}=await L.get(`/api/custom-tab-details/get/model-categories/${w}/${a.model_id}`);d.value=x.data||[]}catch{g.add({severity:"error",summary:o("error"),detail:o("custom_tabs.categories_load_failed"),life:3e3}),d.value=[]}finally{u.value=!1}},N=async(e,a,d)=>{var x;if(e===1)return;const u=d==="new"?D:S,m=d==="new"?j:O,w={2:"/api/product",3:"/api/brand"};m.value=!0;try{const{data:h}=await L.get(w[e],{params:{search:a||void 0,per_page:50}});u.value=((x=h.data)==null?void 0:x.data)||h.data||[]}catch{g.add({severity:"error",summary:o("error"),detail:o("custom_tabs.items_load_failed"),life:3e3})}finally{m.value=!1}},_e=ne.debounce(()=>N(l.value.type,F.value.new,"new"),400),be=ne.debounce(()=>{var e;return N((e=n.value)==null?void 0:e.type,F.value.edit,"edit")},400),Y=(e,a)=>{e==="new"?(F.value.new=a.value,_e()):e==="edit"&&(F.value.edit=a.value,be())};Ee(()=>l.value.type,e=>{l.value.ids=[],l.value.model_id=null,D.value=[],F.value.new="",e===1?X("new"):e&&N(e,"","new")});const B=async()=>{try{const{data:e}=await L.get(`/api/custom-tabs/${T.params.id}`);e.is_success&&e.data&&(e.data.details=e.data.details.map(a=>({...a,type:Number(a.type),ids:a.ids||[]})),k.value=e.data)}catch{g.add({severity:"error",summary:o("error"),detail:o("custom_tabs.details_load_failed"),life:3e3})}},Z=(e,a)=>{const d=a.files[0];d&&(e==="new"?l.value.image=d:n.value.newImage=d)},ge=async()=>{var a,d;if(b.value=!0,!pe.value){g.add({severity:"warn",summary:o("validation"),detail:o("custom_tabs.fill_all_fields"),life:4e3});return}z.value=!0;const e=new FormData;e.append("custom_tab_id",l.value.custom_tab_id),e.append("name_en",l.value.name_en),e.append("name_ar",l.value.name_ar),e.append("type",l.value.type),e.append("image",l.value.image),l.value.type===1&&e.append("model_id",l.value.model_id),l.value.ids.forEach((u,m)=>e.append(`ids[${m}]`,u));try{await L.post("/api/custom-tab-details",e,{headers:{"Content-Type":"multipart/form-data"}}),g.add({severity:"success",summary:o("success"),detail:o("custom_tabs.detail_added"),life:3e3}),$e(),await B()}catch(u){g.add({severity:"error",summary:o("error"),detail:((d=(a=u.response)==null?void 0:a.data)==null?void 0:d.message)||o("custom_tabs.add_failed"),life:5e3})}finally{z.value=!1}},fe=async e=>{n.value={...e,ids:e.ids||[],model_id:e.model_id||null,newImage:null},e.type===1?(await X("edit"),n.value.model_id&&await A("edit")):await N(e.type,"","edit"),C.value=!0},ye=async()=>{var a,d;if(R.value=!0,!ve.value){g.add({severity:"warn",summary:o("validation"),detail:o("custom_tabs.fill_all_fields"),life:4e3});return}P.value=!0;const e=new FormData;e.append("_method","PUT"),e.append("name_en",n.value.name_en),e.append("name_ar",n.value.name_ar),e.append("type",n.value.type),e.append("custom_tab_id",l.value.custom_tab_id),n.value.newImage&&e.append("image",n.value.newImage),n.value.type===1&&e.append("model_id",n.value.model_id),n.value.ids.forEach((u,m)=>e.append(`ids[${m}]`,u));try{await L.post(`/api/custom-tab-details/${n.value.id}`,e,{headers:{"Content-Type":"multipart/form-data"}}),g.add({severity:"success",summary:o("success"),detail:o("custom_tabs.detail_updated"),life:3e3}),C.value=!1,ee(),await B()}catch(u){g.add({severity:"error",summary:o("error"),detail:((d=(a=u.response)==null?void 0:a.data)==null?void 0:d.message)||o("custom_tabs.update_failed"),life:5e3})}finally{P.value=!1}},we=e=>{ie.require({message:o("custom_tabs.confirm_delete_message"),header:o("custom_tabs.confirm_delete"),icon:"pi pi-exclamation-triangle",acceptClass:"p-button-danger",accept:()=>he(e)})},he=async e=>{var a,d;try{await L.delete(`/api/custom-tab-details/${e}`),g.add({severity:"success",summary:o("success"),detail:o("custom_tabs.detail_deleted"),life:3e3}),await B()}catch(u){g.add({severity:"error",summary:o("error"),detail:((d=(a=u.response)==null?void 0:a.data)==null?void 0:d.message)||o("custom_tabs.delete_failed"),life:5e3})}},$e=()=>{l.value={custom_tab_id:T.params.id,name_en:"",name_ar:"",type:null,model_id:null,ids:[],image:null},D.value=[],E.value=[],b.value=!1},ee=()=>{n.value=null,S.value=[],U.value=[],R.value=!1};return Se(()=>{B()}),(e,a)=>{var ae,te;const d=V("Toast"),u=V("ConfirmDialog"),m=V("InputText"),w=V("Dropdown"),x=V("MultiSelect"),h=V("FileUpload"),I=V("Button"),Ve=V("Dialog");return p(),v("div",{class:"min-h-screen bg-gray-50 p-6 lg:p-10",dir:e.$t("dir")},[r(d,{position:"top-right"}),r(u),k.value?(p(),v("div",qe,[t("div",Ne,[t("h1",Be,[a[20]||(a[20]=t("i",{class:"pi pi-table mr-3 text-4xl"},null,-1)),_(" "+i(k.value[M.value]),1)]),t("div",{class:f(["text-lg text-gray-600 space-y-1",{"text-right":e.$t("dir")==="rtl"}])},[t("p",null,[t("strong",Te,i(re.value)+":",1),_(" "+i(me.value),1)])],2)])])):y("",!0),t("div",je,[t("h2",ze,[a[21]||(a[21]=t("i",{class:"pi pi-plus-circle mr-3 text-blue-500"},null,-1)),_(" "+i(e.$t("custom_tabs.add_new_detail")),1)]),t("div",Oe,[t("div",Pe,[t("label",Ae,[_(i(e.$t("custom_tabs.name_en"))+" ",1),a[22]||(a[22]=t("span",{class:"text-red-500"},"*",-1))]),r(m,{modelValue:l.value.name_en,"onUpdate:modelValue":a[0]||(a[0]=s=>l.value.name_en=s),placeholder:e.$t("custom_tabs.enter_name_en"),class:f(["w-full",{"p-invalid":b.value&&!l.value.name_en}])},null,8,["modelValue","placeholder","class"]),b.value&&!l.value.name_en?(p(),v("small",He,i(e.$t("custom_tabs.name_en_required")),1)):y("",!0)]),t("div",Qe,[t("label",Ge,[_(i(e.$t("custom_tabs.name_ar"))+" ",1),a[23]||(a[23]=t("span",{class:"text-red-500"},"*",-1))]),r(m,{modelValue:l.value.name_ar,"onUpdate:modelValue":a[1]||(a[1]=s=>l.value.name_ar=s),placeholder:e.$t("custom_tabs.enter_name_ar"),class:f(["w-full",{"p-invalid":b.value&&!l.value.name_ar}])},null,8,["modelValue","placeholder","class"]),b.value&&!l.value.name_ar?(p(),v("small",Je,i(e.$t("custom_tabs.name_ar_required")),1)):y("",!0)]),t("div",Ke,[t("label",We,[_(i(e.$t("custom_tabs.type"))+" ",1),a[24]||(a[24]=t("span",{class:"text-red-500"},"*",-1))]),r(w,{modelValue:l.value.type,"onUpdate:modelValue":a[2]||(a[2]=s=>l.value.type=s),options:K,optionLabel:"label",optionValue:"value",placeholder:e.$t("custom_tabs.select_type"),class:f(["w-full",{"p-invalid":b.value&&!l.value.type}])},null,8,["modelValue","placeholder","class"]),b.value&&!l.value.type?(p(),v("small",Xe,i(e.$t("custom_tabs.type_required")),1)):y("",!0)]),l.value.type===1?(p(),v("div",Ye,[t("label",Ze,[_(i(e.$t("custom_tabs.select_store_market"))+" ",1),a[25]||(a[25]=t("span",{class:"text-red-500"},"*",-1))]),r(w,{modelValue:l.value.model_id,"onUpdate:modelValue":a[3]||(a[3]=s=>l.value.model_id=s),options:E.value,optionLabel:J.value,optionValue:"id",placeholder:e.$t("custom_tabs.select_store_or_market"),loading:H.value,class:f(["w-full",{"p-invalid":b.value&&!l.value.model_id}]),onChange:a[4]||(a[4]=s=>A("new"))},null,8,["modelValue","options","optionLabel","placeholder","loading","class"]),b.value&&!l.value.model_id?(p(),v("small",ea,i(e.$t("custom_tabs.store_market_required")),1)):y("",!0)])):y("",!0),t("div",{class:f(["field-group",{"lg:col-span-2":l.value.type!==1}])},[t("label",aa,[_(i(q(l.value.type))+" ",1),a[26]||(a[26]=t("span",{class:"text-red-500"},"*",-1))]),r(x,{modelValue:l.value.ids,"onUpdate:modelValue":a[5]||(a[5]=s=>l.value.ids=s),options:D.value,optionLabel:G.value,optionValue:"id",placeholder:W(l.value.type),filterPlaceholder:e.$t("custom_tabs.search")+" "+q(l.value.type).toLowerCase(),loading:j.value,filter:"",onFilter:a[6]||(a[6]=s=>Y("new",s)),class:f(["w-full",{"p-invalid":b.value&&(!l.value.ids||l.value.ids.length===0)}]),disabled:!l.value.type||l.value.type===1&&!l.value.model_id},null,8,["modelValue","options","optionLabel","placeholder","filterPlaceholder","loading","disabled","class"]),b.value&&(!l.value.ids||l.value.ids.length===0)?(p(),v("small",ta,i(e.$t("custom_tabs.items_required")),1)):y("",!0)],2),t("div",la,[t("label",sa,[_(i(e.$t("custom_tabs.image"))+" ",1),a[27]||(a[27]=t("span",{class:"text-red-500"},"*",-1))]),t("div",oa,[r(h,{mode:"basic",accept:"image/*",maxFileSize:2e6,onSelect:a[7]||(a[7]=s=>Z("new",s)),onRemove:a[8]||(a[8]=s=>l.value.image=null),chooseLabel:e.$t("custom_tabs.select_image"),class:"p-button-sm p-button-rounded"},null,8,["chooseLabel"])]),b.value&&!l.value.image?(p(),v("small",na,i(e.$t("custom_tabs.image_required")),1)):y("",!0)])]),r(I,{label:e.$t("custom_tabs.add_detail"),icon:"pi pi-plus",class:"mt-8 px-6 py-3 button-primary",onClick:ge,loading:z.value},null,8,["label","loading"])]),t("div",ia,[t("h2",da,[a[28]||(a[28]=t("i",{class:"pi pi-list mr-3 text-blue-500"},null,-1)),_(" "+i(e.$t("custom_tabs.details")),1)]),(te=(ae=k.value)==null?void 0:ae.details)!=null&&te.length?(p(),v("div",ua,[(p(!0),v(Ue,null,Re(k.value.details,s=>{var le,se;return p(),v("div",{key:s.id,class:"detail-card"},[(le=s.media)!=null&&le.length?(p(),v("div",ra,[t("img",{src:s.media[0].url,alt:s.name_en,class:"w-full h-full object-cover transition-transform duration-500 hover:scale-110"},null,8,ma)])):y("",!0),t("div",ca,[t("div",pa,[t("div",va,[t("p",_a,i(s.name_en),1),t("p",{class:"text-sm text-gray-600 mb-2",dir:e.$t("dir")==="rtl"?"rtl":"ltr"},i(s.name_ar),9,ba),t("p",ga,i(ce(s.type))+" â€¢ "+i(((se=s.ids)==null?void 0:se.length)||0)+" items ",1)])]),t("div",fa,[r(I,{icon:"pi pi-pencil",class:"p-button-rounded p-button-sm p-button-info",onClick:ke=>fe(s)},null,8,["onClick"]),r(I,{icon:"pi pi-trash",severity:"danger",class:"p-button-rounded p-button-sm p-button-danger",onClick:ke=>we(s.id)},null,8,["onClick"])])])])}),128))])):(p(),v("p",ya,[a[29]||(a[29]=t("i",{class:"pi pi-info-circle text-2xl mb-2 block"},null,-1)),_(" "+i(e.$t("custom_tabs.no_details")),1)]))]),r(Ve,{visible:C.value,"onUpdate:visible":a[19]||(a[19]=s=>C.value=s),header:e.$t("custom_tabs.edit_detail"),modal:!0,class:f(["w-full max-w-5xl",{rtl:e.$t("dir")==="rtl"}]),onHide:ee},{footer:oe(()=>[r(I,{label:e.$t("custom_tabs.cancel"),icon:"pi pi-times",class:"p-button-text",onClick:a[18]||(a[18]=s=>C.value=!1)},null,8,["label"]),r(I,{label:e.$t("custom_tabs.save"),icon:"pi pi-check",class:"button-primary",onClick:ye,loading:P.value},null,8,["label","loading"])]),default:oe(()=>[n.value?(p(),v("div",wa,[t("div",ha,[t("div",$a,[t("label",Va,[_(i(e.$t("custom_tabs.name_en"))+" ",1),a[30]||(a[30]=t("span",{class:"text-red-500"},"*",-1))]),r(m,{modelValue:n.value.name_en,"onUpdate:modelValue":a[9]||(a[9]=s=>n.value.name_en=s),class:f(["w-full",{"p-invalid":R.value&&!n.value.name_en}])},null,8,["modelValue","class"])]),t("div",ka,[t("label",xa,[_(i(e.$t("custom_tabs.name_ar"))+" ",1),a[31]||(a[31]=t("span",{class:"text-red-500"},"*",-1))]),r(m,{modelValue:n.value.name_ar,"onUpdate:modelValue":a[10]||(a[10]=s=>n.value.name_ar=s),class:f(["w-full",{"p-invalid":R.value&&!n.value.name_ar}])},null,8,["modelValue","class"])]),t("div",La,[t("label",Da,i(e.$t("custom_tabs.type")),1),r(w,{modelValue:n.value.type,"onUpdate:modelValue":a[11]||(a[11]=s=>n.value.type=s),options:K,optionLabel:"label",optionValue:"value",class:"w-full bg-gray-100 cursor-not-allowed",disabled:""},null,8,["modelValue"])]),n.value.type===1?(p(),v("div",Ca,[t("label",Fa,[_(i(e.$t("custom_tabs.select_store_market"))+" ",1),a[32]||(a[32]=t("span",{class:"text-red-500"},"*",-1))]),r(w,{modelValue:n.value.model_id,"onUpdate:modelValue":a[12]||(a[12]=s=>n.value.model_id=s),options:U.value,optionLabel:J.value,optionValue:"id",placeholder:e.$t("custom_tabs.select_store_or_market"),loading:Q.value,class:"w-full",onChange:a[13]||(a[13]=s=>A("edit"))},null,8,["modelValue","options","optionLabel","placeholder","loading"])])):y("",!0),t("div",{class:f(["field-group",{"lg:col-span-2":n.value.type!==1}])},[t("label",Ia,[_(i(q(n.value.type))+" ",1),a[33]||(a[33]=t("span",{class:"text-red-500"},"*",-1))]),r(x,{modelValue:n.value.ids,"onUpdate:modelValue":a[14]||(a[14]=s=>n.value.ids=s),options:S.value,optionLabel:G.value,optionValue:"id",placeholder:W(n.value.type),loading:O.value,filter:"",onFilter:a[15]||(a[15]=s=>Y("edit",s)),class:"w-full",disabled:n.value.type===1&&!n.value.model_id},null,8,["modelValue","options","optionLabel","placeholder","loading","disabled"])],2),t("div",Ea,[t("label",Sa,i(e.$t("custom_tabs.image"))+" ("+i(e.$t("custom_tabs.optional_reupload"))+")",1),t("div",Ua,[r(h,{mode:"basic",accept:"image/*",maxFileSize:2e6,onSelect:a[16]||(a[16]=s=>Z("edit",s)),onRemove:a[17]||(a[17]=s=>n.value.newImage=null),chooseLabel:n.value.newImage?e.$t("custom_tabs.change_image"):e.$t("custom_tabs.select_new_image"),class:"p-button-sm p-button-rounded p-button-secondary"},null,8,["chooseLabel"])]),t("small",Ra,i(e.$t("custom_tabs.leave_empty_to_keep")),1)])])])):y("",!0)]),_:1},8,["visible","header","class"])],8,Me)}}},Ta=xe(Ma,[["__scopeId","data-v-6b9aa015"]]);export{Ta as default};
