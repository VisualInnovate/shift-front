import{_ as D,a as M,p as T,u as L,q as R,r as f,o as W,c as _,d as m,f as t,e as i,h as e,w as d,t as a,l as z,m as g,j as F,z as A,y as O,Z as b,g as p,aq as C,ah as U,ap as N,af as Z,ae as v,W as H}from"./index-eef7b1a0.js";const J={class:"grid"},K={class:"col-12"},Q={class:"card p-4 shadow-2 border-round"},X={key:0,class:"flex justify-content-center align-items-center py-8"},Y={key:1},ee={class:"flex justify-content-between align-items-center mb-5"},te={class:"grid"},se={class:"col-12 lg:col-6"},oe={class:"space-y-3 mb-5"},ae={key:0},re={class:"text-600"},le={class:"text-lg font-semibold mb-3 text-primary"},ne={class:"space-y-3"},ie={key:0},de={class:"text-red-600"},ce={class:"text-xl font-bold text-primary"},ue={class:"text-2xl"},_e={class:"col-12 lg:col-6"},pe={class:"space-y-3"},me={class:"flex align-items-center gap-2"},ve={class:"mb-2"},he={class:"text-xl font-bold"},ye={class:"font-medium"},fe={key:0,class:"text-sm text-600 mt-1"},ge={class:"font-semibold"},be={class:"font-semibold"},xe=["src"],we={class:"text-center py-6 text-600"},ke={class:"text-lg font-medium"},$e={key:2,class:"text-center py-8"},Ce={class:"text-xl font-medium text-700"},Ie={class:"p-fluid"},Fe={class:"mb-4 text-lg"},Ne={class:"p-3 bg-gray-100 border-round"},Pe={class:"text-base font-semibold mb-3"},je={class:"flex justify-content-between mb-2"},qe={class:"font-medium"},Be={class:"flex justify-content-between text-xl font-bold text-primary"},Ee={class:"mt-4 text-sm text-red-500"},Ge={__name:"show",setup(Se){const{t:s}=M(),P=T(),j=L(),x=R(),r=f(null),w=f(!0),k=f(!1),y=f(!1),$=localStorage.getItem("appLang")||"en",I=async()=>{var n,l,o;w.value=!0;try{const c=await F.get(`/api/order/${P.params.id}`);if((n=c.data)!=null&&n.is_success&&((l=c.data)!=null&&l.data))r.value=c.data.data;else throw new Error(((o=c.data)==null?void 0:o.message)||"No data received")}catch(c){x.add({severity:"error",summary:s("error"),detail:s("order.loadError"),life:5e3}),console.error("Error fetching order:",c),r.value=null}finally{w.value=!1}},q=()=>{r.value&&(y.value=!0)},B=async()=>{var n,l,o,c;if((n=r.value)!=null&&n.id){y.value=!1,k.value=!0;try{const h=await F.post("/api/invoice",{order_id:r.value.id});I(),x.add({severity:"success",summary:s("success"),detail:s("order.invoiceSuccess"),life:5e3}),(l=h.data)!=null&&l.invoice_url&&window.open(h.data.invoice_url,"_blank")}catch(h){x.add({severity:"error",summary:s("error"),detail:((c=(o=h.response)==null?void 0:o.data)==null?void 0:c.message)||s("order.invoiceError"),life:5e3}),console.error("Invoice generation failed:",h)}finally{k.value=!1}}},E=()=>{j.push({name:"orders"})};W(()=>{I()});const G=n=>$==="ar"?n.name_ar:n.name_en,S=n=>{var l;return n.media&&n.media.length>0&&((l=n.media[0])!=null&&l.url)?n.media[0].url:n.key_default_image||"/images/no-image.png"},V=n=>{var l;return!n||!((l=n.attribute_values)!=null&&l.length)?null:n.attribute_values.map(o=>{const c=$==="ar"?o.value_ar:o.value_en;return`${$==="ar"?o.attribute.name_ar:o.attribute.name_en}: ${c}`}).join(" â€¢ ")},u=n=>`${parseFloat(n).toFixed(2)} ${s("currencyLabel")}`;return(n,l)=>(_(),m("div",J,[t("div",K,[t("div",Q,[i(e(A)),w.value?(_(),m("div",X,[i(e(O),{style:{width:"60px",height:"60px"},strokeWidth:"5"})])):r.value?(_(),m("div",Y,[t("div",ee,[i(e(b),{label:e(s)("order.generateInvoice"),icon:"pi pi-file-pdf",onClick:q,loading:k.value,disabled:r.value.has_invoice,class:"p-button-success"},null,8,["label","loading","disabled"])]),i(e(N),{class:"mb-5"},{content:d(()=>{var o;return[t("div",te,[t("div",se,[t("div",oe,[t("p",null,[t("strong",null,a(e(s)("order.name"))+":",1),p(" "+a((o=r.value.user)==null?void 0:o.name),1)]),r.value.notes?(_(),m("p",ae,[t("strong",null,a(e(s)("order.notes"))+":",1),t("span",re,a(r.value.notes),1)])):g("",!0)]),i(e(C),{class:"my-4"}),t("h4",le,a(e(s)("order.financialSummary")),1),t("div",ne,[t("p",null,[t("strong",null,a(e(s)("order.subTotalPrice"))+":",1),p(" "+a(u(r.value.sub_total_price)),1)]),t("p",null,[t("strong",null,a(e(s)("order.taxFee"))+":",1),p(" "+a(u(r.value.tax_fee)),1)]),t("p",null,[t("strong",null,a(e(s)("order.serviceFee"))+":",1),p(" "+a(u(r.value.service_fee)),1)]),t("p",null,[t("strong",null,a(e(s)("order.deliveryFee"))+":",1),p(" "+a(u(r.value.delivery_fee)),1)]),parseFloat(r.value.coupon)>0?(_(),m("p",ie,[t("strong",null,a(e(s)("order.coupon"))+":",1),t("span",de,"-"+a(u(r.value.coupon)),1)])):g("",!0),i(e(C),{class:"my-4"}),t("p",ce,[p(a(e(s)("order.totalPrice"))+": ",1),t("span",ue,a(u(r.value.total_price)),1)])])]),t("div",_e,[t("div",pe,[t("p",me,[t("strong",ve,a(e(s)("order.status"))+":",1),i(e(U),{value:r.value.status===0?e(s)("order.pending"):e(s)("order.completed"),severity:r.value.status===0?"warning":"success",rounded:""},null,8,["value","severity"])])])])])]}),_:1}),i(e(N),null,{title:d(()=>{var o;return[t("h3",he,a(e(s)("order.items"))+" ("+a(((o=r.value.order_items)==null?void 0:o.length)||0)+") ",1)]}),content:d(()=>[i(e(Z),{value:r.value.order_items,responsiveLayout:"scroll",stripedRows:"",showGridlines:"",class:"p-datatable-sm"},{empty:d(()=>[t("div",we,[l[3]||(l[3]=t("i",{class:"pi pi-shopping-cart text-4xl mb-3 opacity-30"},null,-1)),t("p",ke,a(e(s)("order.noItems")),1)])]),default:d(()=>[i(e(v),{header:e(s)("order.itemId"),style:{width:"6%"}},{body:d(({data:o})=>[p(a(o.id),1)]),_:1},8,["header"]),i(e(v),{header:e(s)("order.productName"),style:{width:"40%"}},{body:d(({data:o})=>[t("div",ye,a(G(o.product)),1),o.variant?(_(),m("div",fe,a(V(o.variant)),1)):g("",!0)]),_:1},8,["header"]),i(e(v),{field:"quantity",header:e(s)("order.quantity"),style:{width:"8%"}},{body:d(({data:o})=>[t("span",ge,a(o.quantity),1)]),_:1},8,["header"]),i(e(v),{field:"product.code",header:e(s)("product.code"),style:{width:"8%"}},{body:d(({data:o})=>[t("span",be,a(o.product.code),1)]),_:1},8,["header"]),i(e(v),{header:e(s)("order.unitPrice"),style:{width:"12%"}},{body:d(({data:o})=>[p(a(u((parseFloat(o.price)/o.quantity).toFixed(2))),1)]),_:1},8,["header"]),i(e(v),{header:e(s)("order.total"),style:{width:"12%"}},{body:d(({data:o})=>[t("strong",null,a(u(parseFloat(o.price))),1)]),_:1},8,["header"]),i(e(v),{header:e(s)("order.image"),style:{width:"22%"}},{body:d(({data:o})=>[t("img",{src:S(o.product),alt:"Product",class:"product-image shadow-2 border-round",onError:l[0]||(l[0]=c=>c.target.src="/images/no-image.png")},null,40,xe)]),_:1},8,["header"])]),_:1},8,["value"])]),_:1})])):(_(),m("div",$e,[l[4]||(l[4]=t("i",{class:"pi pi-exclamation-triangle text-6xl text-red-500 mb-4 opacity-70"},null,-1)),t("p",Ce,a(e(s)("order.notFound")),1),i(e(b),{label:e(s)("common.back"),icon:"pi pi-arrow-left",onClick:E,class:"mt-4 p-button-outlined"},null,8,["label"])])),r.value?(_(),z(e(H),{key:3,visible:y.value,"onUpdate:visible":l[2]||(l[2]=o=>y.value=o),header:e(s)("order.invoiceConfirmationTitle"),modal:!0,style:{width:"50vw"}},{footer:d(()=>[i(e(b),{label:e(s)("common.cancel"),icon:"pi pi-times",onClick:l[1]||(l[1]=o=>y.value=!1),class:"p-button-text p-button-secondary"},null,8,["label"]),i(e(b),{label:e(s)("order.confirmGenerate"),icon:"pi pi-check",onClick:B,class:"p-button-success"},null,8,["label"])]),default:d(()=>{var o;return[t("div",Ie,[t("p",Fe,a(e(s)("order.invoiceConfirmationMessage")),1),t("div",Ne,[t("h4",Pe,a(e(s)("order.orderSummaryBrief")),1),t("div",je,[t("span",qe,a(e(s)("order.itemsCount"))+":",1),t("span",null,a(((o=r.value.order_items)==null?void 0:o.length)||0),1)]),i(e(C),{class:"my-2"}),t("div",Be,[t("span",null,a(e(s)("order.totalPrice"))+":",1),t("span",null,a(u(r.value.total_price)),1)])]),t("p",Ee,a(e(s)("order.invoiceGenerationWarning")),1)])]}),_:1},8,["visible","header"])):g("",!0)])])]))}},De=D(Ge,[["__scopeId","data-v-18dda372"]]);export{De as default};
