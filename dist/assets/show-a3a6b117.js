import{_ as Z,u as ee,k as ae,G as te,j as se,r as w,l as $,q as re,o as le,a as m,c as _,h as b,e as p,f as t,t as o,x as i,p as g,g as f,F as oe,d as de,w as B,i as q,Q as ne,T as L,aj as Q,ae as R,V as D,S as ie}from"./index-22d4798b.js";import{l as ue}from"./lodash-bb87847d.js";const ce=["dir"],me={key:0,class:"card mb-6 transform hover:scale-[1.01] transition-transform duration-300"},_e={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},be={class:"text-lg"},pe={class:"text-lg"},ve={class:"text-lg"},ge={class:"card mb-6 transform hover:scale-[1.01] transition-transform duration-300"},fe={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},he={class:"space-y-2"},ye={key:0,id:"name_en_error",class:"text-red-500"},$e={class:"space-y-2"},we={key:0,id:"name_ar_error",class:"text-red-500"},xe={class:"space-y-2"},ke={key:0,id:"ids_error",class:"text-red-500"},Ve={class:"space-y-2"},qe={key:0,class:"text-red-500"},De={class:"card mb-6"},Fe={key:0,class:"grid grid-cols-1 lg:grid-cols-3 gap-4"},Le={class:"flex justify-between items-start"},Ee={class:"text-lg"},Ce={class:"text-lg"},Se={key:0},Ie=["src","alt"],Te={class:"flex space-x-2"},Ue={key:1,class:"text-gray-500 text-lg"},Pe={class:"grid grid-cols-1 lg:grid-cols-2 gap-6 p-6"},je={class:"space-y-2"},Ne={key:0,id:"edit_name_en_error",class:"text-red-500"},ze={class:"space-y-2"},Ae={key:0,id:"edit_name_ar_error",class:"text-red-500"},Be={class:"space-y-2"},Qe={key:0,id:"edit_ids_error",class:"text-red-500"},Re={class:"space-y-2"},Ge=["src","alt"],Ke={__name:"show",setup(Me){ee();const k=ae(),h=te(),{t:s}=se(),c=w(null),V=w(!1),y=w(!1),I=w(""),n=w({custom_tab_id:k.params.id,name_en:"",name_ar:"",ids:[],image:null}),d=w({id:null,custom_tab_id:k.params.id,name_en:"",name_ar:"",ids:[],image:null,media:[]}),E=w([]),T=w(localStorage.getItem("appLang")||"en"),C=$(()=>T.value==="en"?"name_en":"name_ar"),U=$(()=>C.value),G=$(()=>{var e;switch((e=c.value)==null?void 0:e.belongs_to){case"store":return s("custom_tabs.store");case"category":return s("custom_tabs.category");case"market":return s("custom_tabs.market");default:return s("custom_tabs.unknown")}}),K=$(()=>{var a;const e=(a=c.value)==null?void 0:a[c.value.belongs_to];return e?e[C.value]:""}),P=$(()=>{var a;const e=(a=c.value)==null?void 0:a.type;return s(e===1?"custom_tabs.select_categories":e===2?"custom_tabs.select_products":e===3?"custom_tabs.select_brands":"custom_tabs.select_items")}),j=$(()=>{var a;const e=(a=c.value)==null?void 0:a.type;return s(e===1?"custom_tabs.select_categories":e===2?"custom_tabs.select_products":e===3?"custom_tabs.select_brands":"custom_tabs.select_items")}),N=$(()=>{var a;const e=(a=c.value)==null?void 0:a.type;return s(e===1?"custom_tabs.search_categories":e===2?"custom_tabs.search_products":e===3?"custom_tabs.search_brands":"custom_tabs.search_items")}),M=$(()=>n.value.name_en&&n.value.name_ar&&n.value.ids.length>0&&n.value.image),x=$(()=>d.value.name_en&&d.value.name_ar&&d.value.ids.length>0),H=()=>(y.value=!0,M.value?!0:(h.add({severity:"error",summary:s("error"),detail:s("custom_tabs.validation_required"),life:3e3}),!1)),F=async()=>{try{const e=await q.get(`/api/custom-tabs/${k.params.id}`);if(e.data.is_success)c.value=e.data.data,await S();else throw new Error(e.data.message)}catch{h.add({severity:"error",summary:s("error"),detail:s("custom_tabs.fetch_failed"),life:3e3})}},S=async()=>{var e,a;try{let l;const u=(e=c.value)==null?void 0:e.type;if(u===1)l="/api/category";else if(u===2)l="/api/product";else if(u===3)l="/api/brand";else return;const r=await q.get(l,{params:{search:I.value||void 0}});E.value=r.data.data.data}catch{let u="items.loadError";const r=(a=c.value)==null?void 0:a.type;r===1?u="category.loadError":r===2?u="product.loadError":r===3&&(u="brand.loadError"),h.add({severity:"error",summary:s("error"),detail:s(u),life:3e3})}},J=ue.debounce(S,300),z=e=>{I.value=e.value,J()};re(T,()=>{S()});const O=async()=>{var e,a;if(H())try{const l=new FormData;l.append("custom_tab_id",n.value.custom_tab_id),l.append("name_en",n.value.name_en),l.append("name_ar",n.value.name_ar),l.append("image",n.value.image),n.value.ids.forEach((r,v)=>{l.append(`ids[${v}]`,r)}),(await q.post("/api/custom-tab-details",l,{headers:{"Content-Type":"multipart/form-data"}})).data.is_success&&(h.add({severity:"success",summary:s("success"),detail:s("custom_tabs.detail_added"),life:3e3}),n.value={custom_tab_id:k.params.id,name_en:"",name_ar:"",ids:[],image:null},y.value=!1,await F())}catch(l){h.add({severity:"error",summary:s("error"),detail:((a=(e=l.response)==null?void 0:e.data)==null?void 0:a.message)||s("custom_tabs.add_failed"),life:3e3})}},W=async e=>{var a,l;try{(await q.delete(`/api/custom-tab-details/${e}`)).data.is_success&&(h.add({severity:"success",summary:s("success"),detail:s("custom_tabs.detail_deleted"),life:3e3}),await F())}catch(u){h.add({severity:"error",summary:s("error"),detail:((l=(a=u.response)==null?void 0:a.data)==null?void 0:l.message)||s("custom_tabs.delete_failed"),life:3e3})}},X=e=>{d.value={id:e.id,custom_tab_id:k.params.id,name_en:e.name_en,name_ar:e.name_ar,ids:e.ids,image:null,media:e.media},V.value=!0},Y=async()=>{var e,a;try{const l=new FormData;l.append("custom_tab_id",d.value.custom_tab_id),l.append("name_en",d.value.name_en),l.append("name_ar",d.value.name_ar),d.value.image&&l.append("image",d.value.image),d.value.ids.forEach((r,v)=>{l.append(`ids[${v}]`,r)}),l.append("_method","PUT"),(await q.post(`/api/custom-tab-details/${d.value.id}`,l,{headers:{"Content-Type":"multipart/form-data"}})).data.is_success&&(h.add({severity:"success",summary:s("success"),detail:s("custom_tabs.detail_updated"),life:3e3}),V.value=!1,await F())}catch(l){h.add({severity:"error",summary:s("error"),detail:((a=(e=l.response)==null?void 0:e.data)==null?void 0:a.message)||s("custom_tabs.update_failed"),life:3e3})}},A=(e,a)=>{e==="new"?n.value.image=a.files[0]:d.value.image=a.files[0]};return le(()=>{F()}),(e,a)=>{var l,u;return m(),_("div",{class:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 p-6",dir:e.$t("dir")},[b(p(ne),{position:"top-right"}),c.value?(m(),_("div",me,[t("h1",{class:i(["text-3xl font-bold mb-6 text-gray-800",{"text-right":e.$t("dir")==="rtl"}])},o(c.value[C.value]),3),t("div",_e,[t("div",null,[t("p",be,[t("strong",null,o(G.value)+":",1),g(" "+o(K.value),1)]),t("p",pe,[t("strong",null,o(e.$t("custom_tabs.name_en"))+":",1),g(" "+o(c.value.name_en),1)])]),t("div",null,[t("p",ve,[t("strong",null,o(e.$t("custom_tabs.name_ar"))+":",1),g(" "+o(c.value.name_ar),1)])])])])):f("",!0),t("div",ge,[t("h2",{class:i(["text-2xl font-semibold mb-6 text-gray-800",{"text-right":e.$t("dir")==="rtl"}])},o(e.$t("custom_tabs.add_new_detail")),3),t("div",fe,[t("div",he,[t("label",{class:i(["block text-sm font-medium text-gray-700",{"text-right":e.$t("dir")==="rtl"}])},[g(o(e.$t("custom_tabs.name_en"))+" ",1),a[10]||(a[10]=t("span",{class:"text-red-500"},"*",-1))],2),b(p(L),{modelValue:n.value.name_en,"onUpdate:modelValue":a[0]||(a[0]=r=>n.value.name_en=r),placeholder:e.$t("custom_tabs.enter_name_en"),class:i(["w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",{"border-red-500":y.value&&!n.value.name_en}]),"aria-describedby":"name_en_error",required:""},null,8,["modelValue","placeholder","class"]),y.value&&!n.value.name_en?(m(),_("small",ye,o(e.$t("custom_tabs.name_en_required")),1)):f("",!0)]),t("div",$e,[t("label",{class:i(["block text-sm font-medium text-gray-700",{"text-right":e.$t("dir")==="rtl"}])},[g(o(e.$t("custom_tabs.name_ar"))+" ",1),a[11]||(a[11]=t("span",{class:"text-red-500"},"*",-1))],2),b(p(L),{modelValue:n.value.name_ar,"onUpdate:modelValue":a[1]||(a[1]=r=>n.value.name_ar=r),placeholder:e.$t("custom_tabs.enter_name_ar"),class:i(["w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",{"border-red-500":y.value&&!n.value.name_ar}]),"aria-describedby":"name_ar_error",required:""},null,8,["modelValue","placeholder","class"]),y.value&&!n.value.name_ar?(m(),_("small",we,o(e.$t("custom_tabs.name_ar_required")),1)):f("",!0)]),t("div",xe,[t("label",{class:i(["block text-sm font-medium text-gray-700",{"text-right":e.$t("dir")==="rtl"}])},[g(o(P.value)+" ",1),a[12]||(a[12]=t("span",{class:"text-red-500"},"*",-1))],2),b(p(Q),{modelValue:n.value.ids,"onUpdate:modelValue":a[2]||(a[2]=r=>n.value.ids=r),options:E.value,optionLabel:U.value,optionValue:"id",placeholder:j.value,class:i(["w-full border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",{"border-red-500":y.value&&!n.value.ids.length}]),"aria-describedby":"ids_error",filter:"",filterPlaceholder:N.value,onFilter:z,required:""},null,8,["modelValue","options","optionLabel","placeholder","class","filterPlaceholder"]),y.value&&!n.value.ids.length?(m(),_("small",ke,o(e.$t("custom_tabs.ids_required")),1)):f("",!0)]),t("div",Ve,[t("label",{class:i(["block text-sm font-medium text-gray-700",{"text-right":e.$t("dir")==="rtl"}])},[g(o(e.$t("custom_tabs.image"))+" ",1),a[13]||(a[13]=t("span",{class:"text-red-500"},"*",-1))],2),b(p(R),{mode:"basic",accept:"image/*",maxFileSize:1e6,onSelect:a[3]||(a[3]=r=>A("new",r)),chooseLabel:e.$t("custom_tabs.select_image"),class:"p-button-rounded"},null,8,["chooseLabel"]),y.value&&!n.value.image?(m(),_("small",qe,o(e.$t("custom_tabs.image_required")),1)):f("",!0)])]),b(p(D),{label:e.$t("custom_tabs.add_detail"),icon:"pi pi-plus",class:"mt-6 px-6 py-3 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-lg shadow-md hover:shadow-lg transition-all duration-300",onClick:O},null,8,["label"])]),t("div",De,[t("h2",{class:i(["text-2xl font-semibold mb-6 text-gray-800",{"text-right":e.$t("dir")==="rtl"}])},o(e.$t("custom_tabs.details")),3),(u=(l=c.value)==null?void 0:l.details)!=null&&u.length?(m(),_("div",Fe,[(m(!0),_(oe,null,de(c.value.details,r=>(m(),_("div",{key:r.id,class:"border p-4 rounded-lg bg-white shadow-sm hover:shadow-md transition-shadow duration-300"},[t("div",Le,[t("div",null,[t("p",Ee,[t("strong",null,o(e.$t("custom_tabs.name_en"))+":",1),g(" "+o(r.name_en),1)]),t("p",Ce,[t("strong",null,o(e.$t("custom_tabs.name_ar"))+":",1),g(" "+o(r.name_ar),1)]),r.media.length?(m(),_("div",Se,[t("strong",null,o(e.$t("custom_tabs.media"))+":",1),t("img",{src:r.media[0].url,alt:e.$t("custom_tabs.detail_image"),class:"w-32 h-32 object-cover mt-2 rounded-lg"},null,8,Ie)])):f("",!0)]),t("div",Te,[b(p(D),{icon:"pi pi-pencil",class:"p-detail p-button-rounded",onClick:v=>X(r)},null,8,["onClick"]),b(p(D),{severity:"danger",icon:"pi pi-trash",class:"p-delete p-button-rounded",onClick:v=>W(r.id)},null,8,["onClick"])])])]))),128))])):(m(),_("p",Ue,o(e.$t("custom_tabs.no_details")),1))]),b(p(ie),{visible:V.value,"onUpdate:visible":a[9]||(a[9]=r=>V.value=r),header:e.$t("custom_tabs.edit_detail"),modal:!0,class:i(["w-full max-w-3xl bg-white rounded-xl shadow-2xl",{rtl:e.$t("dir")==="rtl"}])},{footer:B(()=>[b(p(D),{label:e.$t("custom_tabs.cancel"),severity:"secondary",class:"p-button-rounded",onClick:a[8]||(a[8]=r=>V.value=!1)},null,8,["label"]),b(p(D),{label:e.$t("custom_tabs.save"),icon:"pi pi-check",class:"px-6 py-3 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-lg shadow-md hover:shadow-lg transition-all duration-300",onClick:Y,disabled:!x.value},null,8,["label","disabled"])]),default:B(()=>{var r;return[t("div",Pe,[t("div",je,[t("label",{class:i(["block text-sm font-medium text-gray-700",{"text-right":e.$t("dir")==="rtl"}])},[g(o(e.$t("custom_tabs.name_en"))+" ",1),a[14]||(a[14]=t("span",{class:"text-red-500"},"*",-1))],2),b(p(L),{modelValue:d.value.name_en,"onUpdate:modelValue":a[4]||(a[4]=v=>d.value.name_en=v),placeholder:e.$t("custom_tabs.enter_name_en"),class:i(["w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",{"border-red-500":!x.value&&!d.value.name_en}]),"aria-describedby":"edit_name_en_error",required:""},null,8,["modelValue","placeholder","class"]),!x.value&&!d.value.name_en?(m(),_("small",Ne,o(e.$t("custom_tabs.name_en_required")),1)):f("",!0)]),t("div",ze,[t("label",{class:i(["block text-sm font-medium text-gray-700",{"text-right":e.$t("dir")==="rtl"}])},[g(o(e.$t("custom_tabs.name_ar"))+" ",1),a[15]||(a[15]=t("span",{class:"text-red-500"},"*",-1))],2),b(p(L),{modelValue:d.value.name_ar,"onUpdate:modelValue":a[5]||(a[5]=v=>d.value.name_ar=v),placeholder:e.$t("custom_tabs.enter_name_ar"),class:i(["w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",{"border-red-500":!x.value&&!d.value.name_ar}]),"aria-describedby":"edit_name_ar_error",required:""},null,8,["modelValue","placeholder","class"]),!x.value&&!d.value.name_ar?(m(),_("small",Ae,o(e.$t("custom_tabs.name_ar_required")),1)):f("",!0)]),t("div",Be,[t("label",{class:i(["block text-sm font-medium text-gray-700",{"text-right":e.$t("dir")==="rtl"}])},[g(o(P.value)+" ",1),a[16]||(a[16]=t("span",{class:"text-red-500"},"*",-1))],2),b(p(Q),{modelValue:d.value.ids,"onUpdate:modelValue":a[6]||(a[6]=v=>d.value.ids=v),options:E.value,optionLabel:U.value,optionValue:"id",placeholder:j.value,class:i(["w-full border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",{"border-red-500":!x.value&&!d.value.ids.length}]),"aria-describedby":"edit_ids_error",filter:"",filterPlaceholder:N.value,onFilter:z,required:""},null,8,["modelValue","options","optionLabel","placeholder","class","filterPlaceholder"]),!x.value&&!d.value.ids.length?(m(),_("small",Qe,o(e.$t("custom_tabs.ids_required")),1)):f("",!0)]),t("div",Re,[t("label",{class:i(["block text-sm font-medium text-gray-700",{"text-right":e.$t("dir")==="rtl"}])},o(e.$t("custom_tabs.image")),3),b(p(R),{mode:"basic",accept:"image/*",maxFileSize:1e6,onSelect:a[7]||(a[7]=v=>A("edit",v)),chooseLabel:e.$t("custom_tabs.select_image"),class:"p-button-outlined p-button-rounded"},null,8,["chooseLabel"]),(r=d.value.media)!=null&&r.length?(m(),_("img",{key:0,src:d.value.media[0].url,alt:e.$t("custom_tabs.current_image"),class:"w-32 h-32 object-cover mt-2 rounded-lg"},null,8,Ge)):f("",!0)])])]}),_:1},8,["visible","header","class"])],8,ce)}}},Oe=Z(Ke,[["__scopeId","data-v-0be1e56c"]]);export{Oe as default};
