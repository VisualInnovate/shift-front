import{_ as q,u as D,p as M,l as L,a as R,r as f,o as W,e as _,h as m,g as t,i,j as e,w as c,t as a,f as A,n as g,b as F,k as O,s as U,W as b,v as p,an as C,ae as z,am as N,a5 as H,a4 as h,T as J}from"./index-11dbf6d3.js";const K={class:"grid"},Q={class:"col-12"},X={class:"card p-4 shadow-2 border-round"},Y={key:0,class:"flex justify-content-center align-items-center py-8"},Z={key:1},ee={class:"flex justify-content-between align-items-center mb-5"},te={class:"grid"},se={class:"col-12 lg:col-6"},oe={class:"space-y-3 mb-5"},ae={key:0},re={class:"text-600"},le={class:"text-lg font-semibold mb-3 text-primary"},ne={class:"space-y-3"},ie={key:0},de={class:"text-red-600"},ce={class:"text-xl font-bold text-primary"},ue={class:"text-2xl"},_e={class:"col-12 lg:col-6"},pe={class:"space-y-3"},me={class:"flex align-items-center gap-2"},ve={class:"mb-2"},he={class:"text-xl font-bold"},ye={class:"font-medium"},fe={key:0,class:"text-sm text-600 mt-1"},ge={class:"font-semibold"},be=["src"],xe={class:"text-center py-6 text-600"},we={class:"text-lg font-medium"},ke={key:2,class:"text-center py-8"},$e={class:"text-xl font-medium text-700"},Ce={class:"p-fluid"},Ie={class:"mb-4 text-lg"},Fe={class:"p-3 bg-gray-100 border-round"},Ne={class:"text-base font-semibold mb-3"},Pe={class:"flex justify-content-between mb-2"},je={class:"font-medium"},Be={class:"flex justify-content-between text-xl font-bold text-primary"},Ee={class:"mt-4 text-sm text-red-500"},Ge={__name:"show",setup(Se){const{t:s}=D(),P=M(),j=L(),x=R(),r=f(null),w=f(!0),k=f(!1),y=f(!1),$=localStorage.getItem("appLang")||"en",I=async()=>{var n,l,o;w.value=!0;try{const d=await F.get(`/api/order/${P.params.id}`);if((n=d.data)!=null&&n.is_success&&((l=d.data)!=null&&l.data))r.value=d.data.data;else throw new Error(((o=d.data)==null?void 0:o.message)||"No data received")}catch(d){x.add({severity:"error",summary:s("error"),detail:s("order.loadError"),life:5e3}),console.error("Error fetching order:",d),r.value=null}finally{w.value=!1}},B=()=>{r.value&&(y.value=!0)},E=async()=>{var n,l,o,d;if((n=r.value)!=null&&n.id){y.value=!1,k.value=!0;try{const v=await F.post("/api/invoice",{order_id:r.value.id});I(),x.add({severity:"success",summary:s("success"),detail:s("order.invoiceSuccess"),life:5e3}),(l=v.data)!=null&&l.invoice_url&&window.open(v.data.invoice_url,"_blank")}catch(v){x.add({severity:"error",summary:s("error"),detail:((d=(o=v.response)==null?void 0:o.data)==null?void 0:d.message)||s("order.invoiceError"),life:5e3}),console.error("Invoice generation failed:",v)}finally{k.value=!1}}},G=()=>{j.push({name:"orders"})};W(()=>{I()});const S=n=>$==="ar"?n.name_ar:n.name_en,T=n=>{var l;return n.media&&n.media.length>0&&((l=n.media[0])!=null&&l.url)?n.media[0].url:n.key_default_image||"/images/no-image.png"},V=n=>{var l;return!n||!((l=n.attribute_values)!=null&&l.length)?null:n.attribute_values.map(o=>{const d=$==="ar"?o.value_ar:o.value_en;return`${$==="ar"?o.attribute.name_ar:o.attribute.name_en}: ${d}`}).join(" â€¢ ")},u=n=>`${parseFloat(n).toFixed(2)} ${s("currencyLabel")}`;return(n,l)=>(_(),m("div",K,[t("div",Q,[t("div",X,[i(e(O)),w.value?(_(),m("div",Y,[i(e(U),{style:{width:"60px",height:"60px"},strokeWidth:"5"})])):r.value?(_(),m("div",Z,[t("div",ee,[i(e(b),{label:e(s)("order.generateInvoice"),icon:"pi pi-file-pdf",onClick:B,loading:k.value,disabled:r.value.has_invoice,class:"p-button-success"},null,8,["label","loading","disabled"])]),i(e(N),{class:"mb-5"},{content:c(()=>{var o;return[t("div",te,[t("div",se,[t("div",oe,[t("p",null,[t("strong",null,a(e(s)("order.name"))+":",1),p(" "+a((o=r.value.user)==null?void 0:o.name),1)]),r.value.notes?(_(),m("p",ae,[t("strong",null,a(e(s)("order.notes"))+":",1),t("span",re,a(r.value.notes),1)])):g("",!0)]),i(e(C),{class:"my-4"}),t("h4",le,a(e(s)("order.financialSummary")),1),t("div",ne,[t("p",null,[t("strong",null,a(e(s)("order.subTotalPrice"))+":",1),p(" "+a(u(r.value.sub_total_price)),1)]),t("p",null,[t("strong",null,a(e(s)("order.taxFee"))+":",1),p(" "+a(u(r.value.tax_fee)),1)]),t("p",null,[t("strong",null,a(e(s)("order.serviceFee"))+":",1),p(" "+a(u(r.value.service_fee)),1)]),t("p",null,[t("strong",null,a(e(s)("order.deliveryFee"))+":",1),p(" "+a(u(r.value.delivery_fee)),1)]),parseFloat(r.value.coupon)>0?(_(),m("p",ie,[t("strong",null,a(e(s)("order.coupon"))+":",1),t("span",de,"-"+a(u(r.value.coupon)),1)])):g("",!0),i(e(C),{class:"my-4"}),t("p",ce,[p(a(e(s)("order.totalPrice"))+": ",1),t("span",ue,a(u(r.value.total_price)),1)])])]),t("div",_e,[t("div",pe,[t("p",me,[t("strong",ve,a(e(s)("order.status"))+":",1),i(e(z),{value:r.value.status===0?e(s)("order.pending"):e(s)("order.completed"),severity:r.value.status===0?"warning":"success",rounded:""},null,8,["value","severity"])])])])])]}),_:1}),i(e(N),null,{title:c(()=>{var o;return[t("h3",he,a(e(s)("order.items"))+" ("+a(((o=r.value.order_items)==null?void 0:o.length)||0)+") ",1)]}),content:c(()=>[i(e(H),{value:r.value.order_items,responsiveLayout:"scroll",stripedRows:"",showGridlines:"",class:"p-datatable-sm"},{empty:c(()=>[t("div",xe,[l[3]||(l[3]=t("i",{class:"pi pi-shopping-cart text-4xl mb-3 opacity-30"},null,-1)),t("p",we,a(e(s)("order.noItems")),1)])]),default:c(()=>[i(e(h),{header:e(s)("order.itemId"),style:{width:"6%"}},{body:c(({data:o})=>[p(a(o.id),1)]),_:1},8,["header"]),i(e(h),{header:e(s)("order.productName"),style:{width:"40%"}},{body:c(({data:o})=>[t("div",ye,a(S(o.product)),1),o.variant?(_(),m("div",fe,a(V(o.variant)),1)):g("",!0)]),_:1},8,["header"]),i(e(h),{field:"quantity",header:e(s)("order.quantity"),style:{width:"8%"}},{body:c(({data:o})=>[t("span",ge,a(o.quantity),1)]),_:1},8,["header"]),i(e(h),{header:e(s)("order.unitPrice"),style:{width:"12%"}},{body:c(({data:o})=>[p(a(u((parseFloat(o.price)/o.quantity).toFixed(2))),1)]),_:1},8,["header"]),i(e(h),{header:e(s)("order.total"),style:{width:"12%"}},{body:c(({data:o})=>[t("strong",null,a(u(parseFloat(o.price))),1)]),_:1},8,["header"]),i(e(h),{header:e(s)("order.image"),style:{width:"22%"}},{body:c(({data:o})=>[t("img",{src:T(o.product),alt:"Product",class:"product-image shadow-2 border-round",onError:l[0]||(l[0]=d=>d.target.src="/images/no-image.png")},null,40,be)]),_:1},8,["header"])]),_:1},8,["value"])]),_:1})])):(_(),m("div",ke,[l[4]||(l[4]=t("i",{class:"pi pi-exclamation-triangle text-6xl text-red-500 mb-4 opacity-70"},null,-1)),t("p",$e,a(e(s)("order.notFound")),1),i(e(b),{label:e(s)("common.back"),icon:"pi pi-arrow-left",onClick:G,class:"mt-4 p-button-outlined"},null,8,["label"])])),r.value?(_(),A(e(J),{key:3,visible:y.value,"onUpdate:visible":l[2]||(l[2]=o=>y.value=o),header:e(s)("order.invoiceConfirmationTitle"),modal:!0,style:{width:"50vw"}},{footer:c(()=>[i(e(b),{label:e(s)("common.cancel"),icon:"pi pi-times",onClick:l[1]||(l[1]=o=>y.value=!1),class:"p-button-text p-button-secondary"},null,8,["label"]),i(e(b),{label:e(s)("order.confirmGenerate"),icon:"pi pi-check",onClick:E,class:"p-button-success"},null,8,["label"])]),default:c(()=>{var o;return[t("div",Ce,[t("p",Ie,a(e(s)("order.invoiceConfirmationMessage")),1),t("div",Fe,[t("h4",Ne,a(e(s)("order.orderSummaryBrief")),1),t("div",Pe,[t("span",je,a(e(s)("order.itemsCount"))+":",1),t("span",null,a(((o=r.value.order_items)==null?void 0:o.length)||0),1)]),i(e(C),{class:"my-2"}),t("div",Be,[t("span",null,a(e(s)("order.totalPrice"))+":",1),t("span",null,a(u(r.value.total_price)),1)])]),t("p",Ee,a(e(s)("order.invoiceGenerationWarning")),1)])]}),_:1},8,["visible","header"])):g("",!0)])])]))}},Ve=q(Ge,[["__scopeId","data-v-e11ff9af"]]);export{Ve as default};
