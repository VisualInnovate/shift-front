import{_ as q,u as M,p as V,l as D,a as L,r as f,o as R,e as p,h as m,g as t,i as n,j as e,w as d,t as o,f as W,n as k,b as C,k as A,s as O,W as g,v as _,an as $,ad as U,am as I,a5 as z,a4 as v,T as H}from"./index-df093464.js";const J={class:"grid"},K={class:"col-12"},Q={class:"card p-4 shadow-2 border-round"},X={key:0,class:"flex justify-content-center align-items-center py-8"},Y={key:1},Z={class:"flex justify-content-between align-items-center mb-5"},ee={class:"grid"},te={class:"col-12 lg:col-6"},se={class:"space-y-3 mb-5"},oe={key:0},ae={class:"text-600"},re={class:"text-lg font-semibold mb-3 text-primary"},le={class:"space-y-3"},ne={key:0},ie={class:"text-red-600"},de={class:"text-xl font-bold text-primary"},ce={class:"text-2xl"},ue={class:"col-12 lg:col-6"},_e={class:"space-y-3"},pe={class:"flex align-items-center gap-2"},me={class:"mb-2"},ve={class:"text-xl font-bold"},he={class:"font-medium"},ye={class:"font-semibold"},fe=["src"],ge={class:"text-center py-6 text-600"},be={class:"text-lg font-medium"},xe={key:2,class:"text-center py-8"},we={class:"text-xl font-medium text-700"},ke={class:"p-fluid"},$e={class:"mb-4 text-lg"},Ce={class:"p-3 bg-gray-100 border-round"},Ie={class:"text-base font-semibold mb-3"},Fe={class:"flex justify-content-between mb-2"},Ne={class:"font-medium"},Be={class:"flex justify-content-between text-xl font-bold text-primary"},Ee={class:"mt-4 text-sm text-red-500"},Ge={__name:"show",setup(Pe){const{t:s}=M(),F=V(),N=D(),b=L(),r=f(null),x=f(!0),w=f(!1),h=f(!1),B=localStorage.getItem("appLang")||"en",E=async()=>{var i,l,a;x.value=!0;try{const c=await C.get(`/api/order/${F.params.id}`);if((i=c.data)!=null&&i.is_success&&((l=c.data)!=null&&l.data))r.value=c.data.data;else throw new Error(((a=c.data)==null?void 0:a.message)||"No data received")}catch(c){b.add({severity:"error",summary:s("error"),detail:s("order.loadError"),life:5e3}),console.error("Error fetching order:",c),r.value=null}finally{x.value=!1}},G=()=>{r.value&&(h.value=!0)},P=async()=>{var i,l,a,c;if((i=r.value)!=null&&i.id){h.value=!1,w.value=!0;try{const y=await C.post("/api/invoice",{order_id:r.value.id});b.add({severity:"success",summary:s("success"),detail:s("order.invoiceSuccess"),life:5e3}),(l=y.data)!=null&&l.invoice_url&&window.open(y.data.invoice_url,"_blank")}catch(y){b.add({severity:"error",summary:s("error"),detail:((c=(a=y.response)==null?void 0:a.data)==null?void 0:c.message)||s("order.invoiceError"),life:5e3}),console.error("Invoice generation failed:",y)}finally{w.value=!1}}},j=()=>{N.push({name:"orders"})};R(()=>{E()});const S=i=>B==="ar"?i.name_ar:i.name_en,T=i=>{var l;return i.media&&i.media.length>0&&((l=i.media[0])!=null&&l.url)?i.media[0].url:i.key_default_image||"/images/no-image.png"},u=i=>`${parseFloat(i).toFixed(2)} ${s("currencyLabel")}`;return(i,l)=>(p(),m("div",J,[t("div",K,[t("div",Q,[n(e(A)),x.value?(p(),m("div",X,[n(e(O),{style:{width:"60px",height:"60px"},strokeWidth:"5"})])):r.value?(p(),m("div",Y,[t("div",Z,[n(e(g),{label:e(s)("order.generateInvoice"),icon:"pi pi-file-pdf",onClick:G,loading:w.value,class:"p-button-success"},null,8,["label","loading"])]),n(e(I),{class:"mb-5"},{content:d(()=>{var a;return[t("div",ee,[t("div",te,[t("div",se,[t("p",null,[t("strong",null,o(e(s)("order.name"))+":",1),_(" "+o((a=r.value.user)==null?void 0:a.name),1)]),r.value.notes?(p(),m("p",oe,[t("strong",null,o(e(s)("order.notes"))+":",1),t("span",ae,o(r.value.notes),1)])):k("",!0)]),n(e($),{class:"my-4"}),t("h4",re,o(e(s)("order.financialSummary")),1),t("div",le,[t("p",null,[t("strong",null,o(e(s)("order.subTotalPrice"))+":",1),_(" "+o(u(r.value.sub_total_price)),1)]),t("p",null,[t("strong",null,o(e(s)("order.taxFee"))+":",1),_(" "+o(u(r.value.tax_fee)),1)]),t("p",null,[t("strong",null,o(e(s)("order.serviceFee"))+":",1),_(" "+o(u(r.value.service_fee)),1)]),t("p",null,[t("strong",null,o(e(s)("order.deliveryFee"))+":",1),_(" "+o(u(r.value.delivery_fee)),1)]),parseFloat(r.value.coupon)>0?(p(),m("p",ne,[t("strong",null,o(e(s)("order.coupon"))+":",1),t("span",ie,"-"+o(u(r.value.coupon)),1)])):k("",!0),n(e($),{class:"my-4"}),t("p",de,[_(o(e(s)("order.totalPrice"))+": ",1),t("span",ce,o(u(r.value.total_price)),1)])])]),t("div",ue,[t("div",_e,[t("p",pe,[t("strong",me,o(e(s)("order.status"))+":",1),n(e(U),{value:r.value.status===0?e(s)("order.pending"):e(s)("order.completed"),severity:r.value.status===0?"warning":"success",rounded:""},null,8,["value","severity"])])])])])]}),_:1}),n(e(I),null,{title:d(()=>{var a;return[t("h3",ve,o(e(s)("order.items"))+" ("+o(((a=r.value.order_items)==null?void 0:a.length)||0)+")",1)]}),content:d(()=>[n(e(z),{value:r.value.order_items,responsiveLayout:"scroll",stripedRows:"",showGridlines:"",class:"p-datatable-sm"},{empty:d(()=>[t("div",ge,[l[3]||(l[3]=t("i",{class:"pi pi-shopping-cart text-4xl mb-3 opacity-30"},null,-1)),t("p",be,o(e(s)("order.noItems")),1)])]),default:d(()=>[n(e(v),{header:e(s)("order.itemId"),style:{width:"8%"}},{body:d(({data:a})=>[_(o(a.id),1)]),_:1},8,["header"]),n(e(v),{header:e(s)("order.productName"),style:{width:"38%"}},{body:d(({data:a})=>[t("div",he,o(S(a.product)),1)]),_:1},8,["header"]),n(e(v),{field:"quantity",header:e(s)("order.quantity"),style:{width:"10%"}},{body:d(({data:a})=>[t("span",ye,o(a.quantity),1)]),_:1},8,["header"]),n(e(v),{header:e(s)("order.price"),style:{width:"12%"}},{body:d(({data:a})=>[_(o(u((parseFloat(a.price)/a.quantity).toFixed(2))),1)]),_:1},8,["header"]),n(e(v),{header:e(s)("order.total"),style:{width:"12%"}},{body:d(({data:a})=>[t("strong",null,o(u(parseFloat(a.price))),1)]),_:1},8,["header"]),n(e(v),{header:e(s)("order.image"),style:{width:"20%"}},{body:d(({data:a})=>[t("img",{src:T(a.product),alt:"Product",class:"product-image shadow-2 border-round",onError:l[0]||(l[0]=c=>c.target.src="/images/no-image.png")},null,40,fe)]),_:1},8,["header"])]),_:1},8,["value"])]),_:1})])):(p(),m("div",xe,[l[4]||(l[4]=t("i",{class:"pi pi-exclamation-triangle text-6xl text-red-500 mb-4 opacity-70"},null,-1)),t("p",we,o(e(s)("order.notFound")),1),n(e(g),{label:e(s)("common.back"),icon:"pi pi-arrow-left",onClick:j,class:"mt-4 p-button-outlined"},null,8,["label"])]))])]),r.value?(p(),W(e(H),{key:0,visible:h.value,"onUpdate:visible":l[2]||(l[2]=a=>h.value=a),header:e(s)("order.invoiceConfirmationTitle"),modal:!0,style:{width:"50vw"}},{footer:d(()=>[n(e(g),{label:e(s)("common.cancel"),icon:"pi pi-times",onClick:l[1]||(l[1]=a=>h.value=!1),class:"p-button-text p-button-secondary"},null,8,["label"]),n(e(g),{label:e(s)("order.confirmGenerate"),icon:"pi pi-check",onClick:P,class:"p-button-success"},null,8,["label"])]),default:d(()=>{var a;return[t("div",ke,[t("p",$e,o(e(s)("order.invoiceConfirmationMessage")),1),t("div",Ce,[t("h4",Ie,o(e(s)("order.orderSummaryBrief")),1),t("div",Fe,[t("span",Ne,o(e(s)("order.itemsCount"))+":",1),t("span",null,o(((a=r.value.order_items)==null?void 0:a.length)||0),1)]),n(e($),{class:"my-2"}),t("div",Be,[t("span",null,o(e(s)("order.totalPrice"))+":",1),t("span",null,o(u(r.value.total_price)),1)])]),t("p",Ee,o(e(s)("order.invoiceGenerationWarning")),1)])]}),_:1},8,["visible","header"])):k("",!0)]))}},Se=q(Ge,[["__scopeId","data-v-1662cb52"]]);export{Se as default};
