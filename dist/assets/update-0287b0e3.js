import{_ as A,l as F,p as R,r as u,c as T,o as q,a1 as W,B as y,e as a,h as i,g as e,t as r,v as L,D as O,F as _,m as g,G as j,n as S,b as w,E as G}from"./index-7be5bfc6.js";const z={class:"permission-manager"},H={class:"controls"},J={class:"name-input"},K={for:"roleName"},Q=["placeholder"],X={key:0,class:"loading"},Y={key:0,class:"table-view"},Z=["rowspan"],N=["id","checked",".indeterminate","onChange"],ee=["for"],te=["onClick","disabled"],se=["id","value"],le={key:1,class:"card-view"},oe={class:"permission-groups"},ne={class:"group-header"},ae=["id","checked",".indeterminate","onChange"],ie=["for"],de={class:"permission-items"},re={class:"permission-info"},ue=["id","value"],ce=["for"],ve=["onClick","disabled"],pe=["disabled"],he={class:"modal-content"},_e={__name:"update",setup(me){const M=F(),$=R(),v=u({}),C=u(null),m=u(!0),d=u([]),p=u(""),b=u(!1),D=u(""),f=u(!1),k=T(()=>$.params.id),U=()=>{w.get("api/role/get/permissions").then(l=>{v.value=l.data.data,k.value?B():m.value=!1})},B=()=>{w.get(`api/role/${$.params.id}`).then(l=>{C.value=l.data.data,p.value=C.value.name,d.value=C.value.permissions.map(t=>t.id),m.value=!1}).catch(()=>{m.value=!1})},V=(l,t)=>{const n=(v.value[l]||[]).map(s=>s.id);t.target.checked?d.value=[...new Set([...d.value,...n])]:d.value=d.value.filter(s=>!n.includes(s))},x=l=>{const t=v.value[l]||[];return t.length===0?!1:t.every(h=>d.value.includes(h.id))},I=l=>{const t=v.value[l]||[];if(t.length===0)return!1;const h=t.some(s=>d.value.includes(s.id)),n=t.every(s=>d.value.includes(s.id));return h&&!n},P=l=>{D.value=l||"No description available",b.value=!0},E=()=>{if(!p.value){alert("Please enter a role name");return}const l={name:p.value,permissions:d.value};w.put(`/api/role/${$.params.id}`,l).then(t=>{M.push({name:"roles"})}).catch(t=>{console.error("Error:",t)})};return q(()=>{U()}),(l,t)=>{const h=W("can");return y((a(),i("div",z,[e("h1",null,r(k.value?l.$t("permissions.edit"):l.$t("permissions.create")),1),e("div",H,[e("div",J,[e("label",K,[L(r(l.$t("role.role_Name"))+" ",1),t[6]||(t[6]=e("span",{class:"required"},"*",-1))]),y(e("input",{type:"text",id:"roleName","onUpdate:modelValue":t[0]||(t[0]=n=>p.value=n),placeholder:l.$t("role.enter_role_name"),required:""},null,8,Q),[[O,p.value]])]),e("button",{onClick:t[1]||(t[1]=n=>f.value=!f.value),class:"view-toggle"},r(f.value?"Switch to Card View":"Switch to Table View"),1)]),m.value?(a(),i("div",X,r(k.value?l.$t("loading.roleData"):l.$t("loading.permissions")),1)):(a(),i(_,{key:1},[f.value?(a(),i("div",Y,[e("table",null,[t[7]||(t[7]=e("thead",null,[e("tr",null,[e("th",null,"Group"),e("th",null,"Permission"),e("th",null,"Description"),e("th",null,"Select")])],-1)),e("tbody",null,[(a(!0),i(_,null,g(v.value,(n,s)=>(a(),i(_,{key:s},[(a(!0),i(_,null,g(n,o=>(a(),i("tr",{key:o.id},[n.indexOf(o)===0?(a(),i("td",{key:0,rowspan:n.length},[e("input",{type:"checkbox",id:`group-${s}-table`,checked:x(s),".indeterminate":I(s),onChange:c=>V(s,c)},null,40,N),e("label",{for:`group-${s}-table`},r(s.charAt(0).toUpperCase()+s.slice(1)),9,ee)],8,Z)):S("",!0),e("td",null,r(o.name),1),e("td",null,[e("button",{onClick:c=>P(o.description),class:"description-btn",disabled:!o.description},r(o.description?"View":"None"),9,te)]),e("td",null,[y(e("input",{type:"checkbox",id:`permission-${o.id}-table`,value:o.id,"onUpdate:modelValue":t[2]||(t[2]=c=>d.value=c)},null,8,se),[[G,d.value]])])]))),128))],64))),128))])])])):(a(),i("div",le,[e("div",oe,[(a(!0),i(_,null,g(v.value,(n,s)=>(a(),i("div",{key:s,class:"permission-group"},[e("div",ne,[e("input",{class:"mx-2 my-auto",type:"checkbox",id:`group-${s}`,checked:x(s),".indeterminate":I(s),onChange:o=>V(s,o)},null,40,ae),e("label",{for:`group-${s}`},r(s.charAt(0).toUpperCase()+s.slice(1)),9,ie)]),e("div",de,[(a(!0),i(_,null,g(n,o=>(a(),i("div",{key:o.id,class:"permission-item"},[e("div",re,[y(e("input",{type:"checkbox",id:`permission-${o.id}`,value:o.id,"onUpdate:modelValue":t[3]||(t[3]=c=>d.value=c)},null,8,ue),[[G,d.value]]),e("label",{for:`permission-${o.id}`},r(o.name),9,ce)]),e("button",{onClick:c=>P(o.description),class:"description-btn",disabled:!o.description},r(o.description?"View Description":"No Description"),9,ve)]))),128))])]))),128))])]))],64)),e("button",{onClick:E,class:"submit-btn",disabled:d.value.length===0||!p.value},r(k.value?l.$t("role.updateWithPermissions"):l.$t("role.createWithPermissions")),9,pe),b.value?(a(),i("div",{key:2,class:"modal-overlay",onClick:t[5]||(t[5]=j(n=>b.value=!1,["self"]))},[e("div",he,[t[8]||(t[8]=e("h3",null,"Permission Description",-1)),e("p",null,r(D.value),1),e("button",{onClick:t[4]||(t[4]=n=>b.value=!1),class:"close-modal"},"Close")])])):S("",!0)])),[[h,"edit roles"]])}}},fe=A(_e,[["__scopeId","data-v-370d5b0f"]]);export{fe as default};
