import{_ as O,u as R,k as q,G as M,j as N,r as m,l as z,o as G,a0 as Q,a as u,c as d,y as H,f as t,t as i,e as s,p as v,h as f,C as c,x as T,w as J,F as K,i as B,T as I,U as W,V as U,Q as X}from"./index-c2555620.js";const Y={class:"max-w-5xl mx-auto p-6 bg-white rounded-xl shadow-lg"},Z={class:"text-3xl font-bold text-center mb-8 text-gray-800"},ee={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},te={class:"space-y-2"},ae={for:"name_en",class:"block text-sm font-medium text-gray-700"},se={class:"space-y-2"},re={for:"name_ar",class:"block text-sm font-medium text-gray-700"},le={class:"space-y-2 lg:col-span-2"},oe={for:"store_id",class:"block text-sm font-medium text-gray-700"},ne={class:"space-y-2"},ie={class:"block text-sm font-medium text-gray-700"},ue={class:"flex justify-center"},de={key:0,class:"p-4 w-full h-full"},ce={class:"relative group w-full h-full"},me=["src","alt"],pe={class:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 flex items-center justify-center transition-all duration-300 rounded-lg"},ge={key:1,class:"p-4 flex flex-col items-center justify-center"},be={class:"text-sm text-center text-gray-600"},ve={class:"text-blue-500 font-medium"},fe={class:"space-y-2"},_e={class:"block text-sm font-medium text-gray-700"},xe={class:"flex justify-center"},ye={key:0,class:"p-4 w-full h-full"},ke={class:"relative group w-full h-full"},he=["src","alt"],we={class:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 flex items-center justify-center transition-all duration-300 rounded-lg"},De={key:1,class:"p-4 flex flex-col items-center justify-center"},je={class:"text-sm text-center text-gray-600"},$e={class:"text-blue-500 font-medium"},Ve={class:"space-y-2 md:col-span-2"},Te={class:"block text-sm font-medium text-gray-700"},Be={class:"flex justify-center"},Ce={key:0,class:"p-4 w-full h-full"},Ee={class:"relative group w-full h-full"},Ie=["src","alt"],Ue={class:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 flex items-center justify-center transition-all duration-300 rounded-lg"},Pe={key:1,class:"p-4 flex flex-col items-center justify-center"},Se={class:"text-sm text-center text-gray-600"},Ae={class:"text-blue-500 font-medium"},Fe={class:"pt-4 flex justify-center space-x-4"},Le={key:0},Oe={key:1,class:"pi pi-spinner pi-spin"},Re={__name:"update",setup(qe){const C=R(),p=q(),$=M(),{t:r}=N(),g=m(!1),P=z(()=>localStorage.getItem("appLang")=="ar"?"name_ar":"name_en"),o=m({name_en:"",name_ar:"",store_id:null,image:null,banner_one_image:null,banner_two_image:null}),_=m(null),x=m(null),y=m(null),E=m([]),k=m(!1),h=m(!1),w=m(!1),S=async()=>{try{const l=await B.get("/api/store");E.value=l.data.data.data}catch(l){console.error("Error fetching stores:",l)}},A=async l=>{try{const n=(await B.get(`/api/market/${l}`)).data.data;o.value={name_en:n.name_en||"",name_ar:n.name_ar||"",store_id:n.store_id||null,image:null,banner_one_image:null,banner_two_image:null},n.media.forEach(a=>{a.name==="market_image"?_.value=a.url:a.name==="banner_one_image"?x.value=a.url:a.name==="banner_two_image"&&(y.value=a.url)})}catch(e){console.error("Error fetching market data:",e),$.add({severity:"error",summary:r("error"),detail:r("market.fetchError"),life:3e3})}},F=(l,e)=>{const n=new FileReader;n.onload=a=>{switch(e){case"image":o.value.image=l,_.value=a.target.result,k.value=!1;break;case"banner_one":o.value.banner_one_image=l,x.value=a.target.result,h.value=!1;break;case"banner_two":o.value.banner_two_image=l,y.value=a.target.result,w.value=!1;break}},n.readAsDataURL(l)},b=(l,e)=>{var a,D,j;const n=((a=l.target.files)==null?void 0:a[0])||((j=(D=l.dataTransfer)==null?void 0:D.files)==null?void 0:j[0]);n&&n.type.match("image.*")&&F(n,e)},V=l=>{switch(l){case"image":o.value.image=null,_.value=null;break;case"banner_one":o.value.banner_one_image=null,x.value=null;break;case"banner_two":o.value.banner_two_image=null,y.value=null;break}},L=async()=>{var e,n;g.value=!0;const l=new FormData;l.append("name_en",o.value.name_en),l.append("name_ar",o.value.name_ar),l.append("store_id",o.value.store_id||""),o.value.image&&l.append("image",o.value.image),o.value.banner_one_image&&l.append("banner_one_image",o.value.banner_one_image),o.value.banner_two_image&&l.append("banner_two_image",o.value.banner_two_image);try{const a=p.params.id,D="post",j=a?`/api/market/${a}`:"/api/market",Me=await B[D](j,l);C.push({name:"markets"}),$.add({severity:"success",summary:r("success"),detail:r(a?"market.updateSuccess":"market.createSuccess"),life:3e3})}catch(a){console.error("Error:",a),$.add({severity:"error",summary:r("error"),detail:((n=(e=a.response)==null?void 0:e.data)==null?void 0:n.message)||(p.params.id?r("market.updateError"):r("market.createError")),life:3e3})}finally{g.value=!1}};return G(async()=>{await S();const l=p.params.id;l&&await A(l)}),(l,e)=>{const n=Q("can");return u(),d(K,null,[H((u(),d("div",Y,[t("h1",Z,i(s(p).params.id?s(r)("market.updateTitle"):s(r)("market.createTitle")),1),t("form",{onSubmit:c(L,["prevent"]),class:"space-y-6"},[t("div",ee,[t("div",te,[t("label",ae,[v(i(s(r)("market.nameEn"))+" ",1),e[19]||(e[19]=t("span",{class:"text-red-500"},"*",-1))]),f(s(I),{id:"name_en",modelValue:o.value.name_en,"onUpdate:modelValue":e[0]||(e[0]=a=>o.value.name_en=a),placeholder:s(r)("market.nameEnPlaceholder"),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",required:""},null,8,["modelValue","placeholder"])]),t("div",se,[t("label",re,[v(i(s(r)("market.nameAr"))+" ",1),e[20]||(e[20]=t("span",{class:"text-red-500"},"*",-1))]),f(s(I),{id:"name_ar",modelValue:o.value.name_ar,"onUpdate:modelValue":e[1]||(e[1]=a=>o.value.name_ar=a),placeholder:s(r)("market.nameArPlaceholder"),dir:"rtl",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",required:""},null,8,["modelValue","placeholder"])]),t("div",le,[t("label",oe,[v(i(s(r)("market.store"))+" ",1),e[21]||(e[21]=t("span",{class:"text-red-500"},"*",-1))]),f(s(W),{filter:"",modelValue:o.value.store_id,"onUpdate:modelValue":e[2]||(e[2]=a=>o.value.store_id=a),options:E.value,optionLabel:P.value,optionValue:"id",placeholder:s(r)("market.selectStore"),class:"w-full",required:""},null,8,["modelValue","options","optionLabel","placeholder"])]),t("div",ne,[t("label",ie,i(s(r)("market.image")),1),t("div",ue,[t("label",{onDragover:e[5]||(e[5]=c(a=>k.value=!0,["prevent"])),onDragleave:e[6]||(e[6]=a=>k.value=!1),onDrop:e[7]||(e[7]=c(a=>b(a,"image"),["prevent"])),class:T([{"border-blue-500 bg-blue-50":k.value,"border-gray-300":!k.value},"cursor-pointer w-full h-48 rounded-xl border-2 border-dashed transition-colors duration-300 flex items-center justify-center"])},[t("input",{type:"file",onChange:e[3]||(e[3]=a=>b(a,"image")),accept:"image/*",class:"hidden"},null,32),_.value?(u(),d("div",de,[t("div",ce,[t("img",{src:_.value,alt:s(r)("market.imagePreview"),class:"w-full h-full object-contain rounded-lg shadow-md transition-transform duration-300 group-hover:scale-105"},null,8,me),t("div",pe,[t("button",{type:"button",onClick:e[4]||(e[4]=c(a=>V("image"),["stop"])),class:"opacity-0 group-hover:opacity-100 bg-red-500 text-white p-2 rounded-full hover:bg-red-600 transition"},e[22]||(e[22]=[t("i",{class:"pi pi-trash text-sm"},null,-1)]))])])])):(u(),d("div",ge,[e[23]||(e[23]=t("div",{class:"bg-blue-100 p-3 rounded-full mb-2"},[t("i",{class:"pi pi-image text-blue-500 text-xl"})],-1)),t("p",be,[t("span",ve,i(s(r)("market.clickToUpload")),1),v(" "+i(s(r)("market.orDragAndDrop")),1)])]))],34)])]),t("div",fe,[t("label",_e,i(s(r)("market.bannerOne")),1),t("div",xe,[t("label",{onDragover:e[10]||(e[10]=c(a=>h.value=!0,["prevent"])),onDragleave:e[11]||(e[11]=a=>h.value=!1),onDrop:e[12]||(e[12]=c(a=>b(a,"banner_one"),["prevent"])),class:T([{"border-blue-500 bg-blue-50":h.value,"border-gray-300":!h.value},"cursor-pointer w-full h-48 rounded-xl border-2 border-dashed transition-colors duration-300 flex items-center justify-center"])},[t("input",{type:"file",onChange:e[8]||(e[8]=a=>b(a,"banner_one")),accept:"image/*",class:"hidden"},null,32),x.value?(u(),d("div",ye,[t("div",ke,[t("img",{src:x.value,alt:s(r)("market.bannerOnePreview"),class:"w-full h-full object-contain rounded-lg shadow-md transition-transform duration-300 group-hover:scale-105"},null,8,he),t("div",we,[t("button",{type:"button",onClick:e[9]||(e[9]=c(a=>V("banner_one"),["stop"])),class:"opacity-0 group-hover:opacity-100 bg-red-500 text-white p-2 rounded-full hover:bg-red-600 transition"},e[24]||(e[24]=[t("i",{class:"pi pi-trash text-sm"},null,-1)]))])])])):(u(),d("div",De,[e[25]||(e[25]=t("div",{class:"bg-blue-100 p-3 rounded-full mb-2"},[t("i",{class:"pi pi-image text-blue-500 text-xl"})],-1)),t("p",je,[t("span",$e,i(s(r)("market.clickToUpload")),1),v(" "+i(s(r)("market.orDragAndDrop")),1)])]))],34)])]),t("div",Ve,[t("label",Te,i(s(r)("market.bannerTwo")),1),t("div",Be,[t("label",{onDragover:e[15]||(e[15]=c(a=>w.value=!0,["prevent"])),onDragleave:e[16]||(e[16]=a=>w.value=!1),onDrop:e[17]||(e[17]=c(a=>b(a,"banner_two"),["prevent"])),class:T([{"border-blue-500 bg-blue-50":w.value,"border-gray-300":!w.value},"cursor-pointer w-full max-w-2xl h-48 rounded-xl border-2 border-dashed transition-colors duration-300 flex items-center justify-center"])},[t("input",{type:"file",onChange:e[13]||(e[13]=a=>b(a,"banner_two")),accept:"image/*",class:"hidden"},null,32),y.value?(u(),d("div",Ce,[t("div",Ee,[t("img",{src:y.value,alt:s(r)("market.bannerTwoPreview"),class:"w-full h-full object-contain rounded-lg shadow-md transition-transform duration-300 group-hover:scale-105"},null,8,Ie),t("div",Ue,[t("button",{type:"button",onClick:e[14]||(e[14]=c(a=>V("banner_two"),["stop"])),class:"opacity-0 group-hover:opacity-100 bg-red-500 text-white p-2 rounded-full hover:bg-red-600 transition"},e[26]||(e[26]=[t("i",{class:"pi pi-trash text-sm"},null,-1)]))])])])):(u(),d("div",Pe,[e[27]||(e[27]=t("div",{class:"bg-blue-100 p-3 rounded-full mb-2"},[t("i",{class:"pi pi-image text-blue-500 text-xl"})],-1)),t("p",Se,[t("span",Ae,i(s(r)("market.clickToUpload")),1),v(" "+i(s(r)("market.orDragAndDrop")),1)])]))],34)])])]),t("div",Fe,[f(s(U),{type:"button",label:s(r)("cancel"),icon:"pi pi-times",onClick:e[18]||(e[18]=a=>s(C).go(-1)),class:"px-6 py-3 mx-2 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-lg shadow-md hover:shadow-lg transition-all duration-300 flex items-center justify-center space-x-2",disabled:g.value},null,8,["label","disabled"]),f(s(U),{type:"submit",label:s(p).params.id?s(r)("market.updateButton"):s(r)("market.createButton"),icon:"pi pi-plus",loading:g.value,class:"px-8 mx-2 py-3 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-lg shadow-md hover:shadow-lg transition-all duration-300 flex items-center justify-center space-x-2",disabled:g.value},{default:J(()=>[g.value?(u(),d("i",Oe)):(u(),d("span",Le,i(s(p).params.id?s(r)("market.updateButton"):s(r)("market.createButton")),1))]),_:1},8,["label","loading","disabled"])])],32)])),[[n,"create markets"]]),f(s(X))],64)}}},ze=O(Re,[["__scopeId","data-v-38eec836"]]);export{ze as default};
