import{_ as M,p as j,l as A,a as B,u as I,r as v,c as L,o as O,a1 as T,e as _,h as f,B as V,g as l,t as i,v as c,i as o,j as r,E,w as $,G as J,F as R,b,V as k,U as y,aj as h,W as w,k as S}from"./index-a771a5d1.js";import{x as W,A as G,O as K}from"./index.es-3ddc3854.js";const Z={class:"max-w-3xl mx-auto p-6 bg-white rounded-xl shadow-lg"},H={class:"text-3xl font-bold text-center mb-8 text-gray-800"},P={class:"grid grid-cols-1 gap-6 lg:grid-cols-2"},Q={class:"space-y-2"},X={for:"user_id",class:"block text-sm font-medium text-gray-700"},Y={class:"space-y-2"},ee={for:"address_line_1",class:"block text-sm font-medium text-gray-700"},ae={class:"space-y-2"},se={for:"address_line_2",class:"block text-sm font-medium text-gray-700"},le={class:"space-y-2"},te={for:"governorate",class:"block text-sm font-medium text-gray-700"},de={class:"space-y-2"},re={for:"city",class:"block text-sm font-medium text-gray-700"},oe={class:"space-y-2"},ie={for:"zip_code",class:"block text-sm font-medium text-gray-700"},ne={class:"space-y-2"},ue={for:"lat",class:"block text-sm font-medium text-gray-700"},ce={class:"space-y-2"},me={for:"long",class:"block text-sm font-medium text-gray-700"},pe={class:"space-y-2"},ve={for:"distance",class:"block text-sm font-medium text-gray-700"},_e={class:"flex items-center space-y-2 col-span-1 lg:col-span-2"},fe={class:"ml-2 text-sm font-medium text-gray-700"},ye={class:"mt-8"},ge={class:"text-xl font-semibold text-gray-800 mb-4"},be={class:"pt-6 flex justify-between"},he={key:0},xe={key:1,class:"pi pi-spinner pi-spin"},Ve={__name:"update",setup($e){const q=j(),p=A(),n=B(),{t}=I(),u=v(!1),g=v(q.params.id),x=v([]),F=[{label:"عمان (Amman)",value:"amman"},{label:"البلقاء (Balqa)",value:"balqa"},{label:"الزرقاء (Zarqa)",value:"zarqa"},{label:"مادبا (Madaba)",value:"madaba"},{label:"إربد (Irbid)",value:"irbid"},{label:"جرش (Jerash)",value:"jerash"},{label:"عجلون (Ajloun)",value:"ajloun"},{label:"المفرق (Mafraq)",value:"mafraq"},{label:"الكرك (Karak)",value:"karak"},{label:"الطفيلة (Tafila)",value:"tafila"},{label:"معان (Ma'an)",value:"maan"},{label:"العقبة (Aqaba)",value:"aqaba"}],a=v({user_id:null,address_line_1:"",address_line_2:"",governorate:"",city:"",zip_code:"",is_default:!1,lat:31.984983325941823,long:35.900908045672196,distance:1e3}),U=L(()=>{const s=Number(a.value.distance)||1e3;return{center:{lat:Number(a.value.lat),lng:Number(a.value.long)},radius:s,strokeColor:"#FF0000",strokeOpacity:.8,strokeWeight:2,fillColor:"#FF0000",fillOpacity:.35}}),z=async()=>{try{const s=await b.get("api/user");x.value=s.data.data.data}catch{n.add({severity:"error",summary:t("error"),detail:t("address.failed_to_load_users"),life:3e3}),p.push({name:"address"})}},N=async()=>{u.value=!0;try{const e=(await b.get(`/api/address/${g.value}`)).data.data;a.value={user_id:e.user_id,address_line_1:e.address_line_1||"",address_line_2:e.address_line_2||"",governorate:e.governorate||"",city:e.city||"",country:e.country||"Jordan",zip_code:e.zip_code||"",is_default:e.is_default==="1",lat:parseFloat(e.lat)||31.984983325941823,long:parseFloat(e.long)||35.900908045672196,distance:parseInt(e.distance)||1e3}}catch{n.add({severity:"error",summary:t("error"),detail:t("address.load_error"),life:3e3}),p.push({name:"address"})}finally{u.value=!1}};function D(s){const e=s.latLng;a.value.lat=e.lat(),a.value.long=e.lng()}const C=async()=>{var s,e;u.value=!0;try{if(!a.value.user_id){n.add({severity:"error",summary:t("validation_error"),detail:t("address.user_required"),life:3e3});return}if(!a.value.address_line_1){n.add({severity:"error",summary:t("validation_error"),detail:t("address.line1_required"),life:3e3});return}if(!a.value.governorate){n.add({severity:"error",summary:t("validation_error"),detail:t("address.governorate_required"),life:3e3});return}if(!a.value.city){n.add({severity:"error",summary:t("validation_error"),detail:t("address.city_required"),life:3e3});return}if(!a.value.country){n.add({severity:"error",summary:t("validation_error"),detail:t("address.country_required"),life:3e3});return}if(a.value.lat<-90||a.value.lat>90){n.add({severity:"error",summary:t("validation_error"),detail:t("address.invalid_lat"),life:3e3});return}if(a.value.long<-180||a.value.long>180){n.add({severity:"error",summary:t("validation_error"),detail:t("address.invalid_long"),life:3e3});return}if(a.value.distance<=0){n.add({severity:"error",summary:t("validation_error"),detail:t("address.invalid_distance"),life:3e3});return}const m={...a.value,is_default:a.value.is_default?"1":"0"};await b.put(`/api/address/${g.value}`,m),p.push({name:"address"}),n.add({severity:"success",summary:t("success"),detail:t("address.updated_successfully"),life:3e3})}catch(m){n.add({severity:"error",summary:t("error"),detail:((e=(s=m.response)==null?void 0:s.data)==null?void 0:e.message)||t("address.update_error"),life:3e3})}finally{u.value=!1}};return O(()=>{z().then(()=>{g.value&&N()})}),(s,e)=>{const m=T("can");return _(),f(R,null,[V((_(),f("div",Z,[l("h1",H,i(s.$t("address.update_address")),1),l("form",{onSubmit:J(C,["prevent"]),class:"space-y-6"},[l("div",P,[l("div",Q,[l("label",X,[c(i(s.$t("user.name"))+" ",1),e[11]||(e[11]=l("span",{class:"text-red-500"},"*",-1))]),o(r(k),{filter:"",modelValue:a.value.user_id,"onUpdate:modelValue":e[0]||(e[0]=d=>a.value.user_id=d),options:x.value,optionLabel:"name",optionValue:"id",placeholder:s.$t("user.select_user"),class:"w-full",required:"",loading:u.value},null,8,["modelValue","options","placeholder","loading"])]),l("div",Y,[l("label",ee,[c(i(s.$t("address.line1"))+" ",1),e[12]||(e[12]=l("span",{class:"text-red-500"},"*",-1))]),o(r(y),{id:"address_line_1",modelValue:a.value.address_line_1,"onUpdate:modelValue":e[1]||(e[1]=d=>a.value.address_line_1=d),placeholder:s.$t("address.enter_line1"),class:"w-full",required:""},null,8,["modelValue","placeholder"])]),l("div",ae,[l("label",se,i(s.$t("address.line2")),1),o(r(y),{id:"address_line_2",modelValue:a.value.address_line_2,"onUpdate:modelValue":e[2]||(e[2]=d=>a.value.address_line_2=d),placeholder:s.$t("address.enter_line2"),class:"w-full"},null,8,["modelValue","placeholder"])]),l("div",le,[l("label",te,[c(i(s.$t("address.governorate"))+" ",1),e[13]||(e[13]=l("span",{class:"text-red-500"},"*",-1))]),o(r(k),{modelValue:a.value.governorate,"onUpdate:modelValue":e[3]||(e[3]=d=>a.value.governorate=d),options:F,optionLabel:"label",optionValue:"value",placeholder:s.$t("address.select_governorate"),class:"w-full",required:""},null,8,["modelValue","placeholder"])]),l("div",de,[l("label",re,[c(i(s.$t("address.city"))+" ",1),e[14]||(e[14]=l("span",{class:"text-red-500"},"*",-1))]),o(r(y),{id:"city",modelValue:a.value.city,"onUpdate:modelValue":e[4]||(e[4]=d=>a.value.city=d),placeholder:s.$t("address.enter_city"),class:"w-full",required:""},null,8,["modelValue","placeholder"])]),l("div",oe,[l("label",ie,i(s.$t("address.zip_code")),1),o(r(y),{id:"zip_code",modelValue:a.value.zip_code,"onUpdate:modelValue":e[5]||(e[5]=d=>a.value.zip_code=d),placeholder:s.$t("address.enter_zip_code"),class:"w-full"},null,8,["modelValue","placeholder"])]),l("div",ne,[l("label",ue,[c(i(s.$t("address.lat"))+" ",1),e[15]||(e[15]=l("span",{class:"text-red-500"},"*",-1))]),o(r(h),{id:"lat",modelValue:a.value.lat,"onUpdate:modelValue":e[6]||(e[6]=d=>a.value.lat=d),min:-90,max:90,step:1e-6,mode:"decimal",minFractionDigits:6,maxFractionDigits:6,class:"w-full",required:""},null,8,["modelValue"])]),l("div",ce,[l("label",me,[c(i(s.$t("address.long"))+" ",1),e[16]||(e[16]=l("span",{class:"text-red-500"},"*",-1))]),o(r(h),{id:"long",modelValue:a.value.long,"onUpdate:modelValue":e[7]||(e[7]=d=>a.value.long=d),min:-180,max:180,step:1e-6,mode:"decimal",minFractionDigits:6,maxFractionDigits:6,class:"w-full",required:""},null,8,["modelValue"])]),l("div",pe,[l("label",ve,[c(i(s.$t("address.distance"))+" ("+i(s.$t("address.meters"))+") ",1),e[17]||(e[17]=l("span",{class:"text-red-500"},"*",-1))]),o(r(h),{id:"distance",modelValue:a.value.distance,"onUpdate:modelValue":e[8]||(e[8]=d=>a.value.distance=d),min:1,placeholder:s.$t("address.enter_distance"),class:"w-full",required:""},null,8,["modelValue","placeholder"])]),l("div",_e,[V(l("input",{type:"checkbox","onUpdate:modelValue":e[9]||(e[9]=d=>a.value.is_default=d),class:"w-5 h-5 text-blue-600 rounded"},null,512),[[E,a.value.is_default]]),l("label",fe,i(s.$t("address.set_as_default")),1)])]),l("div",ye,[l("h2",ge,i(s.$t("address.select_location")),1),o(r(K),{onClick:D,style:{width:"100%",height:"500px"},center:{lat:Number(a.value.lat),lng:Number(a.value.long)},zoom:14},{default:$(()=>[o(r(W),{options:{position:{lat:Number(a.value.lat),lng:Number(a.value.long)}}},null,8,["options"]),o(r(G),{options:U.value},null,8,["options"])]),_:1},8,["center"])]),l("div",be,[o(r(w),{type:"button",label:s.$t("cancel"),icon:"pi pi-times",onClick:e[10]||(e[10]=d=>r(p).push({name:"address"})),class:"px-6 py-2 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-lg shadow transition-all duration-300",disabled:u.value},null,8,["label","disabled"]),o(r(w),{type:"submit",label:s.$t("update"),icon:"pi pi-check",loading:u.value,class:"px-6 py-2 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-lg shadow-md hover:shadow-lg transition-all duration-300"},{default:$(()=>[u.value?(_(),f("i",xe)):(_(),f("span",he,i(s.$t("update")),1))]),_:1},8,["label","loading"])])],32)])),[[m,"edit address"]]),o(r(S))],64)}}},qe=M(Ve,[["__scopeId","data-v-1e67ed35"]]);export{qe as default};
