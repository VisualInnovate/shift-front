import{_ as L,r as d,l as P,p as S,a as j,u as D,x,o as N,a1 as F,e as v,h as p,g as l,i as r,w as g,j as t,b as k,t as _,k as R,s as T,B as y,V as w,n as W,ai as M,W as B,al as Q}from"./index-7be5bfc6.js";const z={class:"grid"},A={class:"col-12 md:col-6 md:col-offset-3"},G={class:"text-2xl font-bold"},H={key:0,class:"flex justify-content-center align-items-center py-4"},J={key:1,class:"p-fluid"},K={class:"field"},O={for:"product_id"},X={key:0,class:"field"},Y={for:"variant_id"},Z={class:"field"},ee={for:"quantity"},te={class:"flex gap-2 justify-content-end"},ae={__name:"update",setup(oe){const q=d(""),C=P(),E=S(),c=j(),{t:e}=D(),u=d(!1),m=d([]),f=d([]),V=d(localStorage.getItem("appLang")||"en"),a=d({product_id:null,variant_id:null,inventory_id:E.params.id,quantity:null}),h=async()=>{try{const s=await k.get("/api/product",{params:{search:q.value||void 0}}),o=V.value;m.value=s.data.data.data.map(n=>{var i;return{label:o==="en"?n.name_en:n.name_ar,value:n.id,variants:((i=n.variants)==null?void 0:i.map(b=>({label:o==="en"?b.name_en:b.name_ar,value:b.id})))||[]}})}catch(s){c.add({severity:"error",summary:e("error"),detail:e("product.loadError"),life:3e3}),console.error("Error fetching products:",s)}finally{u.value=!1}};x(()=>a.value.product_id,s=>{const o=m.value.find(n=>n.value===s);f.value=o?o.variants:[],a.value.variant_id=null}),x(V,()=>{h()});const U=s=>{q.value=s.value,h()},$=()=>{if(!a.value.product_id||!a.value.quantity){c.add({severity:"warn",summary:e("warning"),detail:e("inventory.quantityFormIncomplete"),life:3e3});return}u.value=!0;const s={product_id:a.value.product_id,inventory_id:a.value.inventory_id,quantity:a.value.quantity,variant_id:a.value.variant_id||void 0};k.put("/api/inventory/update/product",s).then(()=>{c.add({severity:"success",summary:e("success"),detail:e("inventory.quantityUpdatedSuccess"),life:3e3})}).catch(o=>{c.add({severity:"error",summary:e("error"),detail:e("inventory.quantityUpdateError"),life:3e3}),console.error("Error updating quantity:",o)}).finally(()=>{u.value=!1})},I=()=>{C.push({name:"inventory-list"})};return N(()=>{h()}),(s,o)=>{const n=F("can");return v(),p("div",z,[l("div",A,[r(t(Q),{class:"p-4 shadow-2 border-round"},{title:g(()=>[l("h2",G,_(t(e)("inventory.quantityTitle")),1)]),content:g(()=>[r(t(R)),u.value?(v(),p("div",H,[r(t(T),{style:{width:"50px",height:"50px"},strokeWidth:"4"})])):(v(),p("div",J,[l("div",K,[l("label",O,_(t(e)("inventory.product")),1),y(r(t(w),{id:"product_id",modelValue:a.value.product_id,"onUpdate:modelValue":o[0]||(o[0]=i=>a.value.product_id=i),options:m.value,filter:"",optionLabel:"label",optionValue:"value",placeholder:t(e)("inventory.selectProduct"),required:"",onFilter:U},null,8,["modelValue","options","placeholder"]),[[n,"edit inventory"]])]),f.value.length>0?(v(),p("div",X,[l("label",Y,_(t(e)("inventory.variant")),1),y(r(t(w),{id:"variant_id",modelValue:a.value.variant_id,"onUpdate:modelValue":o[1]||(o[1]=i=>a.value.variant_id=i),options:f.value,optionLabel:"label",optionValue:"value",placeholder:t(e)("inventory.selectVariant"),showClear:!0},null,8,["modelValue","options","placeholder"]),[[n,"edit inventory"]])])):W("",!0),l("div",Z,[l("label",ee,_(t(e)("inventory.quantity")),1),y(r(t(M),{id:"quantity",modelValue:a.value.quantity,"onUpdate:modelValue":o[2]||(o[2]=i=>a.value.quantity=i),min:1,showButtons:"",required:""},null,8,["modelValue"]),[[n,"edit inventory"]])])]))]),footer:g(()=>[l("div",te,[r(t(B),{label:t(e)("cancel"),icon:"pi pi-times",class:"p-button-text",onClick:I},null,8,["label"]),y(r(t(B),{label:t(e)("save"),icon:"pi pi-check",class:"p-button-success",onClick:$,disabled:u.value},null,8,["label","disabled"]),[[n,"edit inventory"]])])]),_:1})])])}}},se=L(ae,[["__scopeId","data-v-f62ec9f4"]]);export{se as default};
