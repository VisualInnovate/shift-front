import{_ as L,l as q,p as M,a as R,u as N,r as c,c as z,o as G,a1 as W,e as u,h as d,B as H,g as t,t as i,j as r,v as p,i as g,G as m,A as T,w as J,F as K,b as B,U,V as Q,W as A,k as X}from"./index-31324687.js";const Y={class:"max-w-5xl mx-auto p-6 bg-white rounded-xl shadow-lg"},Z={class:"text-3xl font-bold text-center mb-8 text-gray-800"},ee={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},te={class:"space-y-2"},ae={for:"name_en",class:"block text-sm font-medium text-gray-700"},re={class:"space-y-2"},se={for:"name_ar",class:"block text-sm font-medium text-gray-700"},oe={class:"space-y-2"},le={for:"store_id",class:"block text-sm font-medium text-gray-700"},ne={class:"space-y-2"},ie={for:"min_amount_order",class:"block text-sm font-medium text-gray-700"},ue={class:"space-y-2"},de={class:"block text-sm font-medium text-gray-700"},me={class:"flex justify-center"},ce={key:0,class:"p-4 w-full h-full"},pe={class:"relative group w-full h-full"},ge=["src","alt"],be={class:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 flex items-center justify-center transition-all duration-300 rounded-lg"},ve={key:1,class:"p-4 flex flex-col items-center justify-center"},_e={class:"text-sm text-center text-gray-600"},fe={class:"text-blue-500 font-medium"},ye={class:"space-y-2"},xe={class:"block text-sm font-medium text-gray-700"},ke={class:"flex justify-center"},he={key:0,class:"p-4 w-full h-full"},we={class:"relative group w-full h-full"},De=["src","alt"],je={class:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 flex items-center justify-center transition-all duration-300 rounded-lg"},Ve={key:1,class:"p-4 flex flex-col items-center justify-center"},$e={class:"text-sm text-center text-gray-600"},Te={class:"text-blue-500 font-medium"},Be={class:"space-y-2 md:col-span-2"},Ue={class:"block text-sm font-medium text-gray-700"},Ee={class:"flex justify-center"},Ie={key:0,class:"p-4 w-full h-full"},Ae={class:"relative group w-full h-full"},Ce=["src","alt"],Pe={class:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 flex items-center justify-center transition-all duration-300 rounded-lg"},Se={key:1,class:"p-4 flex flex-col items-center justify-center"},Fe={class:"text-sm text-center text-gray-600"},Oe={class:"text-blue-500 font-medium"},Le={class:"pt-4 flex justify-center space-x-4"},qe={key:0},Me={key:1,class:"pi pi-spinner pi-spin"},Re={__name:"update",setup(Ne){const E=q(),b=M(),V=R(),{t:s}=N(),v=c(!1),C=z(()=>localStorage.getItem("appLang")=="ar"?"name_ar":"name_en"),l=c({name_en:"",name_ar:"",store_id:null,min_amount_order:"",image:null,banner_one_image:null,banner_two_image:null}),f=c(null),y=c(null),x=c(null),I=c([]),k=c(!1),h=c(!1),w=c(!1),P=async()=>{try{const o=await B.get("/api/store");I.value=o.data.data.data}catch(o){console.error("Error fetching stores:",o)}},S=async o=>{try{const n=(await B.get(`/api/market/${o}`)).data.data;l.value={name_en:n.name_en||"",name_ar:n.name_ar||"",store_id:n.store_id||null,min_amount_order:n.min_amount_order||"",image:null,banner_one_image:null,banner_two_image:null},n.media.forEach(a=>{a.name==="market_image"?f.value=a.url:a.name==="banner_one_image"?y.value=a.url:a.name==="banner_two_image"&&(x.value=a.url)})}catch(e){console.error("Error fetching market data:",e),V.add({severity:"error",summary:s("error"),detail:s("market.fetchError"),life:3e3})}},F=(o,e)=>{const n=new FileReader;n.onload=a=>{switch(e){case"image":l.value.image=o,f.value=a.target.result,k.value=!1;break;case"banner_one":l.value.banner_one_image=o,y.value=a.target.result,h.value=!1;break;case"banner_two":l.value.banner_two_image=o,x.value=a.target.result,w.value=!1;break}},n.readAsDataURL(o)},_=(o,e)=>{var a,D,j;const n=((a=o.target.files)==null?void 0:a[0])||((j=(D=o.dataTransfer)==null?void 0:D.files)==null?void 0:j[0]);n&&n.type.match("image.*")&&F(n,e)},$=o=>{switch(o){case"image":l.value.image=null,f.value=null;break;case"banner_one":l.value.banner_one_image=null,y.value=null;break;case"banner_two":l.value.banner_two_image=null,x.value=null;break}},O=async()=>{var e,n;v.value=!0;const o=new FormData;o.append("name_en",l.value.name_en),o.append("name_ar",l.value.name_ar),o.append("store_id",l.value.store_id||""),o.append("min_amount_order",l.value.min_amount_order||""),l.value.image&&o.append("image",l.value.image),l.value.banner_one_image&&o.append("banner_one_image",l.value.banner_one_image),l.value.banner_two_image&&o.append("banner_two_image",l.value.banner_two_image);try{const a=b.params.id,D="post",j=a?`/api/market/${a}`:"/api/market",ze=await B[D](j,o);E.push({name:"markets"}),V.add({severity:"success",summary:s("success"),detail:s(a?"market.updateSuccess":"market.createSuccess"),life:3e3})}catch(a){console.error("Error:",a),V.add({severity:"error",summary:s("error"),detail:((n=(e=a.response)==null?void 0:e.data)==null?void 0:n.message)||(b.params.id?s("market.updateError"):s("market.createError")),life:3e3})}finally{v.value=!1}};return G(async()=>{await P();const o=b.params.id;o&&await S(o)}),(o,e)=>{const n=W("can");return u(),d(K,null,[H((u(),d("div",Y,[t("h1",Z,i(r(b).params.id?r(s)("market.updateTitle"):r(s)("market.createTitle")),1),t("form",{onSubmit:m(O,["prevent"]),class:"space-y-6"},[t("div",ee,[t("div",te,[t("label",ae,[p(i(r(s)("market.nameEn"))+" ",1),e[20]||(e[20]=t("span",{class:"text-red-500"},"*",-1))]),g(r(U),{id:"name_en",modelValue:l.value.name_en,"onUpdate:modelValue":e[0]||(e[0]=a=>l.value.name_en=a),placeholder:r(s)("market.nameEnPlaceholder"),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",required:""},null,8,["modelValue","placeholder"])]),t("div",re,[t("label",se,[p(i(r(s)("market.nameAr"))+" ",1),e[21]||(e[21]=t("span",{class:"text-red-500"},"*",-1))]),g(r(U),{id:"name_ar",modelValue:l.value.name_ar,"onUpdate:modelValue":e[1]||(e[1]=a=>l.value.name_ar=a),placeholder:r(s)("market.nameArPlaceholder"),dir:"rtl",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",required:""},null,8,["modelValue","placeholder"])]),t("div",oe,[t("label",le,[p(i(r(s)("market.store"))+" ",1),e[22]||(e[22]=t("span",{class:"text-red-500"},"*",-1))]),g(r(Q),{filter:"",modelValue:l.value.store_id,"onUpdate:modelValue":e[2]||(e[2]=a=>l.value.store_id=a),options:I.value,optionLabel:C.value,optionValue:"id",placeholder:r(s)("market.selectStore"),class:"w-full",required:""},null,8,["modelValue","options","optionLabel","placeholder"])]),t("div",ne,[t("label",ie,[p(i(r(s)("market.minAmountOrder"))+" ",1),e[23]||(e[23]=t("span",{class:"text-red-500"},"*",-1))]),g(r(U),{id:"min_amount_order",modelValue:l.value.min_amount_order,"onUpdate:modelValue":e[3]||(e[3]=a=>l.value.min_amount_order=a),placeholder:r(s)("market.enterMinAmountOrder"),type:"number",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",required:""},null,8,["modelValue","placeholder"])]),t("div",ue,[t("label",de,i(r(s)("market.image")),1),t("div",me,[t("label",{onDragover:e[6]||(e[6]=m(a=>k.value=!0,["prevent"])),onDragleave:e[7]||(e[7]=a=>k.value=!1),onDrop:e[8]||(e[8]=m(a=>_(a,"image"),["prevent"])),class:T([{"border-blue-500 bg-blue-50":k.value,"border-gray-300":!k.value},"cursor-pointer w-full h-48 rounded-xl border-2 border-dashed transition-colors duration-300 flex items-center justify-center"])},[t("input",{type:"file",onChange:e[4]||(e[4]=a=>_(a,"image")),accept:"image/*",class:"hidden"},null,32),f.value?(u(),d("div",ce,[t("div",pe,[t("img",{src:f.value,alt:r(s)("market.imagePreview"),class:"w-full h-full object-contain rounded-lg shadow-md transition-transform duration-300 group-hover:scale-105"},null,8,ge),t("div",be,[t("button",{type:"button",onClick:e[5]||(e[5]=m(a=>$("image"),["stop"])),class:"opacity-0 group-hover:opacity-100 bg-red-500 text-white p-2 rounded-full hover:bg-red-600 transition"},e[24]||(e[24]=[t("i",{class:"pi pi-trash text-sm"},null,-1)]))])])])):(u(),d("div",ve,[e[25]||(e[25]=t("div",{class:"bg-blue-100 p-3 rounded-full mb-2"},[t("i",{class:"pi pi-image text-blue-500 text-xl"})],-1)),t("p",_e,[t("span",fe,i(r(s)("market.clickToUpload")),1),p(" "+i(r(s)("market.orDragAndDrop")),1)])]))],34)])]),t("div",ye,[t("label",xe,i(r(s)("market.bannerOne")),1),t("div",ke,[t("label",{onDragover:e[11]||(e[11]=m(a=>h.value=!0,["prevent"])),onDragleave:e[12]||(e[12]=a=>h.value=!1),onDrop:e[13]||(e[13]=m(a=>_(a,"banner_one"),["prevent"])),class:T([{"border-blue-500 bg-blue-50":h.value,"border-gray-300":!h.value},"cursor-pointer w-full h-48 rounded-xl border-2 border-dashed transition-colors duration-300 flex items-center justify-center"])},[t("input",{type:"file",onChange:e[9]||(e[9]=a=>_(a,"banner_one")),accept:"image/*",class:"hidden"},null,32),y.value?(u(),d("div",he,[t("div",we,[t("img",{src:y.value,alt:r(s)("market.bannerOnePreview"),class:"w-full h-full object-contain rounded-lg shadow-md transition-transform duration-300 group-hover:scale-105"},null,8,De),t("div",je,[t("button",{type:"button",onClick:e[10]||(e[10]=m(a=>$("banner_one"),["stop"])),class:"opacity-0 group-hover:opacity-100 bg-red-500 text-white p-2 rounded-full hover:bg-red-600 transition"},e[26]||(e[26]=[t("i",{class:"pi pi-trash text-sm"},null,-1)]))])])])):(u(),d("div",Ve,[e[27]||(e[27]=t("div",{class:"bg-blue-100 p-3 rounded-full mb-2"},[t("i",{class:"pi pi-image text-blue-500 text-xl"})],-1)),t("p",$e,[t("span",Te,i(r(s)("market.clickToUpload")),1),p(" "+i(r(s)("market.orDragAndDrop")),1)])]))],34)])]),t("div",Be,[t("label",Ue,i(r(s)("market.bannerTwo")),1),t("div",Ee,[t("label",{onDragover:e[16]||(e[16]=m(a=>w.value=!0,["prevent"])),onDragleave:e[17]||(e[17]=a=>w.value=!1),onDrop:e[18]||(e[18]=m(a=>_(a,"banner_two"),["prevent"])),class:T([{"border-blue-500 bg-blue-50":w.value,"border-gray-300":!w.value},"cursor-pointer w-full max-w-2xl h-48 rounded-xl border-2 border-dashed transition-colors duration-300 flex items-center justify-center"])},[t("input",{type:"file",onChange:e[14]||(e[14]=a=>_(a,"banner_two")),accept:"image/*",class:"hidden"},null,32),x.value?(u(),d("div",Ie,[t("div",Ae,[t("img",{src:x.value,alt:r(s)("market.bannerTwoPreview"),class:"w-full h-full object-contain rounded-lg shadow-md transition-transform duration-300 group-hover:scale-105"},null,8,Ce),t("div",Pe,[t("button",{type:"button",onClick:e[15]||(e[15]=m(a=>$("banner_two"),["stop"])),class:"opacity-0 group-hover:opacity-100 bg-red-500 text-white p-2 rounded-full hover:bg-red-600 transition"},e[28]||(e[28]=[t("i",{class:"pi pi-trash text-sm"},null,-1)]))])])])):(u(),d("div",Se,[e[29]||(e[29]=t("div",{class:"bg-blue-100 p-3 rounded-full mb-2"},[t("i",{class:"pi pi-image text-blue-500 text-xl"})],-1)),t("p",Fe,[t("span",Oe,i(r(s)("market.clickToUpload")),1),p(" "+i(r(s)("market.orDragAndDrop")),1)])]))],34)])])]),t("div",Le,[g(r(A),{type:"button",label:r(s)("cancel"),icon:"pi pi-times",onClick:e[19]||(e[19]=a=>r(E).go(-1)),class:"px-6 py-3 mx-2 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-lg shadow-md hover:shadow-lg transition-all duration-300 flex items-center justify-center space-x-2",disabled:v.value},null,8,["label","disabled"]),g(r(A),{type:"submit",label:r(b).params.id?r(s)("market.updateButton"):r(s)("market.createButton"),icon:"pi pi-plus",loading:v.value,class:"px-8 mx-2 py-3 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-lg shadow-md hover:shadow-lg transition-all duration-300 flex items-center justify-center space-x-2",disabled:v.value},{default:J(()=>[v.value?(u(),d("i",Me)):(u(),d("span",qe,i(r(b).params.id?r(s)("market.updateButton"):r(s)("market.createButton")),1))]),_:1},8,["label","loading","disabled"])])],32)])),[[n,"create markets"]]),g(r(X))],64)}}},We=L(Re,[["__scopeId","data-v-bcadca11"]]);export{We as default};
