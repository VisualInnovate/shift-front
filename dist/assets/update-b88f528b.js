import{_ as L,r as d,u as P,k as S,G as j,j as D,q as x,o as N,a0 as F,a as v,c as p,f as l,h as r,w as b,e as t,i as k,t as _,Q,H as R,y,U as w,g as T,ag as G,V as U,ak as H}from"./index-f721525b.js";const M={class:"grid"},W={class:"col-12 md:col-6 md:col-offset-3"},z={class:"text-2xl font-bold"},A={key:0,class:"flex justify-content-center align-items-center py-4"},J={key:1,class:"p-fluid"},K={class:"field"},O={for:"product_id"},X={key:0,class:"field"},Y={for:"variant_id"},Z={class:"field"},ee={for:"quantity"},te={class:"flex gap-2 justify-content-end"},ae={__name:"update",setup(oe){const q=d(""),B=P(),C=S(),c=j(),{t:e}=D(),u=d(!1),f=d([]),m=d([]),V=d(localStorage.getItem("appLang")||"en"),a=d({product_id:null,variant_id:null,inventory_id:C.params.id,quantity:null}),h=async()=>{try{const s=await k.get("/api/product",{params:{search:q.value||void 0}}),o=V.value;f.value=s.data.data.data.map(n=>{var i;return{label:o==="en"?n.name_en:n.name_ar,value:n.id,variants:((i=n.variants)==null?void 0:i.map(g=>({label:o==="en"?g.name_en:g.name_ar,value:g.id})))||[]}})}catch(s){c.add({severity:"error",summary:e("error"),detail:e("product.loadError"),life:3e3}),console.error("Error fetching products:",s)}finally{u.value=!1}};x(()=>a.value.product_id,s=>{const o=f.value.find(n=>n.value===s);m.value=o?o.variants:[],a.value.variant_id=null}),x(V,()=>{h()});const E=s=>{q.value=s.value,h()},$=()=>{if(!a.value.product_id||!a.value.quantity){c.add({severity:"warn",summary:e("warning"),detail:e("inventory.quantityFormIncomplete"),life:3e3});return}u.value=!0;const s={product_id:a.value.product_id,inventory_id:a.value.inventory_id,quantity:a.value.quantity,variant_id:a.value.variant_id||void 0};k.put("/api/inventory/update/product",s).then(()=>{c.add({severity:"success",summary:e("success"),detail:e("inventory.quantityUpdatedSuccess"),life:3e3})}).catch(o=>{c.add({severity:"error",summary:e("error"),detail:e("inventory.quantityUpdateError"),life:3e3}),console.error("Error updating quantity:",o)}).finally(()=>{u.value=!1})},I=()=>{B.push({name:"inventory-list"})};return N(()=>{h()}),(s,o)=>{const n=F("can");return v(),p("div",M,[l("div",W,[r(t(H),{class:"p-4 shadow-2 border-round"},{title:b(()=>[l("h2",z,_(t(e)("inventory.quantityTitle")),1)]),content:b(()=>[r(t(Q)),u.value?(v(),p("div",A,[r(t(R),{style:{width:"50px",height:"50px"},strokeWidth:"4"})])):(v(),p("div",J,[l("div",K,[l("label",O,_(t(e)("inventory.product")),1),y(r(t(w),{id:"product_id",modelValue:a.value.product_id,"onUpdate:modelValue":o[0]||(o[0]=i=>a.value.product_id=i),options:f.value,filter:"",optionLabel:"label",optionValue:"value",placeholder:t(e)("inventory.selectProduct"),required:"",onFilter:E},null,8,["modelValue","options","placeholder"]),[[n,"edit inventory"]])]),m.value.length>0?(v(),p("div",X,[l("label",Y,_(t(e)("inventory.variant")),1),y(r(t(w),{id:"variant_id",modelValue:a.value.variant_id,"onUpdate:modelValue":o[1]||(o[1]=i=>a.value.variant_id=i),options:m.value,optionLabel:"label",optionValue:"value",placeholder:t(e)("inventory.selectVariant"),showClear:!0},null,8,["modelValue","options","placeholder"]),[[n,"edit inventory"]])])):T("",!0),l("div",Z,[l("label",ee,_(t(e)("inventory.quantity")),1),y(r(t(G),{id:"quantity",modelValue:a.value.quantity,"onUpdate:modelValue":o[2]||(o[2]=i=>a.value.quantity=i),min:1,showButtons:"",required:""},null,8,["modelValue"]),[[n,"edit inventory"]])])]))]),footer:b(()=>[l("div",te,[r(t(U),{label:t(e)("cancel"),icon:"pi pi-times",class:"p-button-text",onClick:I},null,8,["label"]),y(r(t(U),{label:t(e)("save"),icon:"pi pi-check",class:"p-button-success",onClick:$,disabled:u.value},null,8,["label","disabled"]),[[n,"edit inventory"]])])]),_:1})])])}}},se=L(ae,[["__scopeId","data-v-f62ec9f4"]]);export{se as default};
